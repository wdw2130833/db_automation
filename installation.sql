use master
go
if not exists(select 1 from sys.databases where name='$(my_database)')
	create database [$(my_database)]
go

use [$(my_database)]

go

if not exists(select 1 FROM sys.configurations WHERE name = 'clr enabled' and value=1)
   begin
		EXECUTE sp_configure 'clr enabled', 1;
		RECONFIGURE;
   end
go

declare @hash binary (64), @clrname nvarchar(4000)=N'up_exec_remote_sql, version=0.0.0.0, culture=neutral, publickeytoken=41f433bef3edd586, processorarchitecture=msil',
@asmbin varbinary(max)=0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103009A54C7680000000000000000E00022200B01300000980000000600000000000056B600000020000000C00000000000100020000000020000040000000000000006000000000000000000010000020000F19D010003006085000010000010000000001000001000000000000010000000000000000000000004B600004F00000000C00000A80300000000000000000000000000000000000000E000000C000000CCB400001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000005C960000002000000098000000020000000000000000000000000000200000602E72737263000000A803000000C0000000040000009A0000000000000000000000000000400000402E72656C6F6300000C00000000E0000000020000009E0000000000000000000000000000400000420000000000000000000000000000000038B60000000000004800000002000500906A0000BC490000090000000000000000000000000000004CB400008000000000000000000000000000000000000000000000000000000000000000000000001B300600B90E00000100001100037201000070280E00000A810F00000172110000700A72110000700B730F00000A0C731000000A0D281100000A1304731200000A1305731300000A13067213000070731400000A130511056F1500000A0072490000700A110611056F1600000A001106066F1700000A0005130711072C0C00110411066F1800000A0000000011066F1900000A13093804030000007355000006130A110A1109110972A00100706F1A00000A6F1B00000A6F3800000600110A1109110972AE0100706F1A00000A6F1C00000A6F3400000600110A1109110972BE0100706F1A00000A6F1C00000A6F3600000600110A1109110972CE0100706F1A00000A6F1D00000A6F4600000600110A1109110972E40100706F1A00000A6F1D00000A6F4000000600110A1109110972F80100706F1A00000A6F1D00000A6F4800000600110A1109110972060200706F1A00000A6F1D00000A6F4200000600110A1109110972140200706F1A00000A6F1D00000A6F4E00000600110A11091109721E0200706F1A00000A6F1D00000A6F4A00000600110A1109110972360200706F1A00000A6F1D00000A6F4400000600110A11091109724A0200706F1A00000A6F1D00000A6F4C00000600110A11091109725C0200706F1A00000A6F1D00000A6F5200000600110A1109110972640200706F1A00000A6F1D00000A6F2C00000600110A1109110972800200706F1A00000A6F1D00000A6F3000000600110A1109110972920200706F1A00000A6F1D00000A6F2E00000600110A1109110972A60200706F1A00000A6F1D00000A6F5000000600110A1109110972CC0200706F1A00000A6F1D00000A6F3E00000600110A1109110972EE0200706F1A00000A6F1E00000A6F5400000600110A72FA0200706F3A00000600110A72110000706F3C0000060009110A6F1F00000A00110A6F2F0000067211000070282000000A130B110B2C6300732A00000625732100000A6F270000060025732200000A6F1D0000060013081108720A0300706F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00002B7807110A6F3D000006282000000A130C110C2C6500732A00000625732100000A6F270000060025732200000A6F1D000006001308110A6F3D0000060B1108076F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00000011096F2400000A130D110D3AECFCFFFF11096F2500000A0000DDC3000000130E00110E6F2600000A130F110E6F2700000A13101613112B1D1110110F11116F2800000A6F2900000A282A00000A13101111175813111111110F6F2B00000A1759FE0216FE01131211122DCD0372120300701110282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A002038FFFFFF1313DD820A000013140003722803007011146F2700000A282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A0020D4FEFFFF1313DD430A00000000161315096F2D00000A1316282E00000A131700086F2F00000A131A2B7D121A283000000A131B0000096F3100000A131C2B4D121C283200000A131D00111D6F3D000006111B6F28000006283300000A2D13111B6F28000006720A030070283300000A2B0117131E111E2C1300111B111B6F1E00000617586F1F000006000000121C283400000A2DAADE0F121CFE160600001B6F3500000A00DC00121A283600000A3A77FFFFFFDE0F121AFE160500001B6F3500000A00DC384A0400000016131500086F2F00000A131F380F040000121F283000000A13200011206F1E00000616FE021321112139F10300000000096F3100000A132238BC0300001222283200000A13230011206F28000006720A030070283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132411243998010000000F00FE160F0000016F2900000A1123731400000613251125FE0615000006733700000A733800000A1326112611236F3700000613271227FE161C0000016F2900000A6F3900000A0011266F3A00000A0011206F1C00000611266F3B00000A0011236F53000006132811282C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151F325D16FE01132911292C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01132A112A3992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A132B1104112B6F2C00000A0020B80B0000283D00000A00000038D701000011236F3D00000611206F28000006283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132E112E399301000000112311206F260000067319000006132F112FFE061A000006733700000A733800000A1330113011236F3700000613271227FE161C0000016F2900000A6F3900000A0011306F3A00000A0011206F1C00000611306F3B00000A0011236F53000006133111312C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151758131511151F325D16FE01133211322C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01133311333992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A1334110411346F2C00000A0020B80B0000283D00000A000000001222283400000A3A38FCFFFFDE0F1222FE160600001B6F3500000A00DC11202812000006000000121F283600000A3AE5FBFFFFDE0F121FFE160500001B6F3500000A00DC2010270000283D00000A0000111616FE02133511353AA8FBFFFF096F2D00000A17FE02133611362C4A00282E00000A132C122C727E030070283E00000A7210040070096F2D00000A132D122D283F00000A722A040070283C00000A1337110411376F2C00000A0020B80B0000283D00000A0000282E00000A131708281100000613182B74000828110000061318282E00000A1117284100000A13391239284200000A230000000000003440FE02133811382C3900282E00000A1317282E00000A132C122C727E030070283E00000A72620400701218283F00000A284300000A133A1104113A6F2C00000A000020E8030000283D00000A0000111816FE02133B113B2D811104282E00000A132C122C727E030070283E00000A728C040070282A00000A6F2C00000A001104284400000A6F2C00000A00734500000A131900086F2F00000A133C38E3010000123C283000000A133D0038BB01000000113D6F26000006123E6F4600000A133F113F394D01000000113E6F4700000A6F4800000A16FE0213401140393101000000113D6F2800000672C40400706F4900000A1341114139910000000003113D6F28000006113E1105280A000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134211422C0A001FF61313DD5C03000003113D6F28000006113E1105280B000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134311432C0A001FF61313DD1703000000388400000000001119113E176F4C00000A0000DE73134400031B8D470000012516282E00000A132C122C727E030070283E00000AA2251772C8040070A22518113D6F28000006A2251972D0040070A2251A11446F2700000AA2284000000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DD8E0200000000002B550003282E00000A132C122C727E030070283E00000A72C8040070113D6F2800000672FA040070283C00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FFB1313DD3402000000113D6F260000066F4D00000A16FE02134511453A2DFEFFFF00123C283600000A3A11FEFFFFDE0F123CFE160500001B6F3500000A00DC11196F4700000A6F4800000A16FE02134611462C14000311192807000006280E00000A810F00000100030911052809000006280E00000A810F0000011104282E00000A132C122C727E030070283E00000A724C050070282A00000A6F2C00000A001104282E00000A132C122C727E030070283E00000A727C05007003FE160F0000016F2900000A284300000A6F2C00000A0011066F4E00000A0011056F4F00000A0011056F4E00000A0003FE160F0000016F2900000A7201000070282000000A134711472C0900151313DD2E010000037201000070280E00000A810F000001161313DD1601000013480003728405007011486F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FEC1313DDD70000001349000372A405007011496F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE71313DD98000000134A000372D6050070114A6F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DE5C134B00114B6F2700000A134C114C72F40500706F5000000A16FE01134D114D2C3500037246060070114C282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FCE1313DE061FC91313DE0011132A00000041240100000000007F00000031030000B00300008400000015000001000000007F00000031030000340400003F0000001700000102000000A50400005A000000FF0400000F0000000000000002000000900400008D0000001D0500000F00000000000000020000006A050000CF030000390900000F00000000000000020000003E05000022040000600900000F0000000000000000000000A60B00000F000000B50B0000730000001700000102000000B40A0000F6010000AA0C00000F0000000000000000000000740400002C090000A00D00003F0000001500000100000000740400002C090000DF0D00003F0000001E00000100000000740400002C0900001E0E00003C0000001F00000100000000740400002C0900005A0E00005C00000017000001133006002800000002000011000F00285100000A0F01285100000A1716161F1E735200000A285300000A285400000A0A2B00062A1B30020009010000030000110072110000700A0002285500000A0B072C2400725E0600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDD100000002285600000A16FE010D092C240072B20600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDA000000002285700000A0A06280E00000A0CDD8D00000013040072E206007011046F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE5E130500723407007011056F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE2F130600727607007011066F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE00082A0000000128000000000700737A002F230000010000070073A9002F240000010000070073D8002F170000011B300500E302000004000011000E087211000070280E00000A810F0000010F01FE160F0000016F2900000A0A007357000006285800000A0020000C0000285900000A0017285A00000A0002285B00000A74250000010B07056F5C00000A000E04285500000A16FE01130411042C0B00070E046F5D00000A00000E07285500000A16FE01130511052C0B00070E076F5E00000A00000E06285500000A16FE01130611062C0B00070E066F5F00000A00000720307500006F6000000A0004285500000A16FE01130711072C5B0004178D5400000125161F3B9D6F6100000A13081613092B3300110811099A178D5400000125161F3D9D6F6100000A130A076F6200000A110A169A110A179A6F6300000A0000110917581309110911088E69FE04130B110B2DBF000572A8070070283300000A130C110C2C4300286400000A066F6500000A130D07110D8E696A6F6600000A00076F6700000A130E00110E110D16110D8E696F6800000A0000DE0D110E2C08110E6F3500000A00DC00076F6900000A74260000010C0E05285500000A16FE01130F110F2C1700086F6A00000A0E05286B00000A736C00000A0D002B0E00086F6A00000A736D00000A0D00086F6E00000A20C80000002E12086F6E00000A20C9000000FE0116FE012B0116131011102C31000E0872B2070070086F6E00000A8C59000001096F6F00000A287000000A280E00000A810F0000011FCE1311DDDB0000000E080E08710F000001096F6F00000A280E00000A287100000A810F000001161311DDB500000013120011126F7200000A75260000011313111314FE03131411142C5F0011136F6A00000A13151115736D00000A1316000E0872B207007011136F6E00000A8C5900000111166F6F00000A287000000A280E00000A810F00000100DE0D11162C0811166F3500000A00DCDE0D11152C0811156F3500000A00DC002B15000E0811126F2700000A280E00000A810F000001001F9C1311DE1F1317000E0811176F2700000A280E00000A810F0000012038FFFFFF1311DE0011112A00417C0000020000004C010000130000005F0100000D00000000000000020000005A0200002D000000870200000D00000000000000020000005102000045000000960200000D0000000000000000000000200000000B0200002B020000960000002900000100000000200000000B020000C10200001F000000170000011B3003000901000005000011000002285500000A0A062C30000372EE070070280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9C0BDDCB0000000302285700000A280E00000A810F000001160BDDB30000000C00037240080070086F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9B0BDE7A0D00037286080070096F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002037FFFFFF0BDE3E1304000372BC08007011046F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002036FFFFFF0BDE00072A0000000128000000000100535400392300000100000100538D003C240000010000010053C9003E170000011B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011B300300410100000700001100140A02120028080000060B07737500000A0C281100000A0D09086F7600000A00166A13040000026F4700000A6F7700000A13052B7711056F7800000A742D000001130600161307086F7900000A175913082B3A00110611076F7A00000A130911092D06061107912B0116130A110A2C0B0011096F2900000A13090008110711096F7B00000A000011071758130711071108FE0216FE01130B110B2DB71104176A58130409086F7C00000A000011056F7D00000A2D80DE161105752E000001130C110C2C08110C6F3500000A00DC096F7E00000A000972260900701204287F00000A282A00000A6F2C00000A007201000070130DDE48130E00096F7E00000A00282E00000A13101210727E030070283E00000A7240090070110E6F2700000A284300000A130F281100000A110F6F2900000A6F2C00000A00110F130DDE00110D2A000000011C00000200340084B800160000000000002500D1F6004817000001133005006F0000000800001100026F8000000A6F4800000A8D2A0000010A03026F8000000A6F4800000A8D5D00000151160B026F8000000A6F4800000A17590C2B2400026F8000000A076F8100000A0D0607090350078F5D000001280F000006A2000717580B0708FE0216FE01130411042DCF0613052B0011052A001B3005001B020000090000110072010000700A036F8200000A0B000072780900700C00026F3100000A0D380F0100001203283200000A13040011046F390000067201000070282000000A130511052C5C00281100000A1B8D47000001251611046F45000006A2251772910A0070A2251811046F47000006A2251972950A0070A2251A11046F3B000006A2284000000A6F2C00000A00281100000A284400000A6F2C00000A0072AF0A00700A00080307738300000A13060011066F8400000A72BD0A007011046F2B0000066F8500000A2611066F8400000A72DB0A007011046F3B0000066F8500000A2611066F8400000A72F70A007011046F310000068C4A0000016F8500000A2611066F8400000A72150B007011046F370000068C1C0000016F8500000A2611066F8600000A2600DE0D11062C0811066F3500000A00DC001203283400000A3AE5FEFFFFDE0F1203FE160600001B6F3500000A00DC076F8700000A0000DDA900000013070011076F2600000A130811076F2700000A130916130A2B1D11091108110A6F2800000A6F2900000A282A00000A1309110A1758130A110A11086F2B00000A1759FE0216FE01130B110B2DCD72120300701109282A00000A0A281100000A066F2C00000A0006130CDE51130D00076F8800000A00282E00000A130E120E727E030070283E00000A72250B0070110D6F2700000A284300000A0A281100000A066F2C00000A0000DE0000DE0B072C07076F3500000A00DC06130C2B00110C2A00417C000002000000AA0000007A000000240100000D00000000000000020000001E00000022010000400100000F00000000000000000000000F0000004D0100005C0100006B00000015000001000000000F0000004D010000C70100003E00000017000001020000000E000000FA010000080200000B000000000000001B300400340300000A0000110072110000700A72110000700B140C738900000A25724F0B00706F8A00000A002572570B00706F8A00000A002572650B00706F8A00000A0025726D0B00706F8A00000A0025727F0B00706F8A00000A0025728B0B00706F8A00000A0025729D0B00706F8A00000A002572AD0B00706F8A00000A002572CF0B00706F8A00000A002572DB0B00706F8A00000A002572E50B00706F8A00000A0025726D0B00706F8A00000A002572FD0B00706F8A00000A000D0003120228080000061304001104130516130638F6010000110511069A1307001E8D47000001251606A22517720D0C0070A2251802A22519723D0C0070A2251A11076F8B00000AA2251B72470C0070A2251C02A2251D727B0C0070A2284000000A0A0911076F8C00000A13091209FE16310000016F2900000A6F8D00000A1308110839960000000011076F8C00000A13091209FE16310000016F2900000A72FD0B0070283300000A130A110A2C1C000672890C007011076F8B00000A728D0C0070283C00000A0A002B4D001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B72B10C0070A2284000000A0A000038EA0000000072B50C007011076F8E00000A130B120B287F00000A72BB0C007072C10C00706F8F00000A72C90C0070284300000A0B11076F8C00000A13091209FE16310000016F2900000A72CF0C0070283300000A130C110C2C4C001B8D47000001251672B50C0070A2251711076F9000000A130D120D289100000AA2251872DF0C0070A2251911076F9200000A130D120D289100000AA2251A72C90C0070A2284000000A0B001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B07A2284000000A0A0000110617581306110611058E693FFFFDFFFF0604739300000A130E00110E6F8600000A2600DE0D110E2C08110E6F3500000A00DC7201000070130FDE3C131000282E00000A13121212727E030070283E00000A72E30C007011106F2700000A284300000A1311281100000A11116F2C00000A001111130FDE00110F2A4134000002000000D30200000C000000DF0200000D0000000000000000000000B100000044020000F50200003C000000170000011B3005002D0200000B00001100738900000A0A72190D00700272AA0D0070284300000A0B0704739300000A0C086F1900000A0D2B1A0006090972D60D00706F1A00000A6F1D00000A6F8A00000A0000096F2400000A130411042DDA096F2500000A00086F4E00000A00046F8200000A1305000072E00D00700272FC0D0070284300000A0B00066F9400000A13062B1E1206289500000A1307000772120E0070110772DF0C0070283C00000A0B001206289600000A2DD9DE0F1206FE160800001B6F3500000A00DC0716076F9700000A17596F9800000A72160E0070282A00000A0B00036F4700000A6F7700000A1308388F00000011086F7800000A742D00000113090007041105738300000A130A0000066F9400000A130B2B36120B289500000A130C00110A6F8400000A72120E0070110C282A00000A1109110C6F9900000A252D06267E9A00000A6F8500000A2600120B289600000A2DC1DE0F120BFE160800001B6F3500000A00DC110A6F8600000A2600DE0D110A2C08110A6F3500000A00DC0011086F7D00000A3A65FFFFFFDE161108752E000001130D110D2C08110D6F3500000A00DC11056F8700000A0000DE6B130E0011056F8800000A001B8D470000012516282E00000A13101210727E030070283E00000AA22517721A0E0070A2251802A2251972300E0070A2251A110E6F2700000AA2284000000A130F281100000A110F6F2C00000A00281100000A076F2C00000A00110F1311DE1900DE0D11052C0811056F3500000A00DC720100007013112B0011112A0000004194000002000000810000002B000000AC0000000F00000000000000020000000C010000430000004F0100000F00000000000000020000000201000067000000690100000D0000000000000002000000E3000000A2000000850100001600000000000000000000006600000040010000A60100006B000000170000010200000065000000AF010000140200000D0000000000000013300200220000000C0000110072400E00700F00FE16320000016F2900000A282A00000A739B00000A0A2B00062A0000133002001B0000000C00001100725E0E0070026F2900000A282A00000A739B00000A0A2B00062A001B300400F00000000D0000110000727C0E00700A0E040B072C6300056F9C00000A16FE010C082C07056F1500000A000305739300000A0D00096F8600000A2600DE0B092C07096F3500000A00DC05739D00000A1304001104046F9E00000A001104026F9F00000A0000DE0D11042C0811046F3500000A00DC061305DE7C00729A0E007073A000000A7A1306001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911066F2700000AA2251A72260F0070A2284000000A1305DE381307001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911076F2700000AA2251A72260F0070A2284000000A1305DE0011052A0134000002002B000B36000B0000000002004900165F000D00000000000001007C7D003815000001000001007CB5003817000001133003007B0100000E00001100031652140A026FA100000A0B026FA200000A0C0728A300000A130411040D09451300000066000000CF00000041000000050000002200000093000000130000006E000000B50000007D000000BD00000088000000C60000009B000000570000004900000033000000FA000000A700000038F500000000081873A400000A0A38EF00000000081F1473A400000A0A38E000000000081F0C176A73A500000A0A38CF00000000081A73A400000A0A38C10000000018280C0000067A00081B73A400000A0A38AB00000000081F0973A400000A0A389C0000000016280C0000067A00081F1073A400000A0A388500000000081E73A400000A0A2B7A00081673A400000A0A2B6F001B280C0000067A00081F0D73A400000A0A2B5B00081F0C156A73A500000A0A2B4D001E280C0000067A001F0A280C0000067A001F0C280C0000067A0008020728100000060A0614FE01130511052C1500081F0C026FA600000A6A73A500000A0A031752002B080007280D0000067A0613062B0011062A0013300400850200000F00001100140A04D00900001B28A700000A2E2904D06600000128A700000A2E1C04D00A00001B28A700000A2E0F04D06700000128A700000AFE012B01170B072C1700021F15036FA600000A6A73A500000A0A00382802000004D00F00000128A700000AFE010C082C1200021F0C156A73A500000A0A00380502000004D06800000128A700000AFE010D092C1200021F15156A73A500000A0A0038E201000004D01C00000128A700000AFE01130411042C1000021F0E73A400000A0A0038BF01000004D00D00000128A700000AFE01130511052C1000021F1773A400000A0A00389C01000004D02200000128A700000AFE01130611062C0F00021873A400000A0A00387A01000004D06900000128A700000AFE01130711072C1000021F1473A400000A0A00385701000004D06A00000128A700000AFE01130811082C0F00021A73A400000A0A00383501000004D06B00000128A700000AFE01130911092C0F00021C73A400000A0A00381301000004D06C00000128A700000AFE01130A110A2C1000021F0E73A400000A0A0038F000000004D06D00000128A700000AFE01130B110B2C1000021F1073A400000A0A0038CD00000004D06E00000128A700000AFE01130C110C2C0F00021E73A400000A0A0038AB00000004D06F00000128A700000AFE01130D110D2C0F00021673A400000A0A00388900000004D07000000128A700000AFE01130E110E2C0D00021F0973A400000A0A002B6904D07100000128A700000AFE01130F110F2C1200021B7EA800000A1673A900000A0A002B4404D07200000128A700000AFE01131011102C0D00021F0D73A400000A0A002B2404D07300000128A700000AFE01131111112C0D00021F1973A400000A0A002B0400140A000613122B0011122A0000001B300200A90000001000001100160A160B160C00026F2F00000A0D2B761203283000000A130400160A160B0011046F1C0000066FAA00000A13052B2A120528AB00000A13060011066FAC00000A130711072C0C000617580A0817580C002B06000717580B0000120528AD00000A2DCDDE0F1205FE160B00001B6F3500000A00DC1104066F23000006001104076F2100000600001203283600000A2D81DE0F1203FE160500001B6F3500000A00DC0813082B0011082A000000011C000002002E003765000F0000000002000F008392000F000000001B300200630000001100001100160A160B00026F1C0000066FAA00000A0C2B24120228AB00000A0D00096FAC00000A130411042C08000617580A002B06000717580B0000120228AD00000A2DD3DE0F1202FE160B00001B6F3500000A00DC02066F230000060002076F21000006002A0001100000020012003143000F00000000220228AE00000A002A8A0272110000707D0B0000040228AE00000A000002047D0C00000402037D0B0000042A1B300600670A0000120000110072110000700A72110000700B1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72580F0070A2284000000A0C1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72620F0070A2284000000A0D1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B726C0F0070A2284000000A130400027B0C00000472110000706F3C00000600027B0C00000472110000706F2C00000600027B0C0000046F2F00000672760F0070283300000A1308110839AC02000000027B0C0000046F4900000672860F0070283300000A1309110939FD0000000072920F00700A1C8D47000001251672A80F0070A22517027B0C0000046F3F000006A2251872DF0C0070A22519027B0C0000046F4D000006A2251A72C20F0070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A2251772CA0F0070A22518027B0C0000046F35000006130A120A283F00000AA2251972D20F0070A2251A08A2284000000A0B027B0C0000046F51000006285500000A130B110B2C10000772DA0F0070282A00000A0B002B46001C8D47000001251607A2251772E20F0070A22518027B0C0000046F4B000006A2251972EA0F0070A2251A027B0C0000046F51000006A2251B72F40F0070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A130C110C39920000000072041000700A1C8D4700000125167218100070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A22517723A100070A22518027B0C0000046F4B000006A225197244100070A2251A027B0C0000046F51000006A2284000000A0B00027B0C0000046F49000006724C100070283300000A130D110D2C720072621000700A1C8D4700000125167274100070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B000772A0100070027B0C0000046F2D000006284300000A0B08027B0C0000046F41000006280E00000A281700000616FE03130E110E2C1700027B0C00000472AF0A00706F3A00000600DD240600000038D3030000027B0C0000046F2F00000672A4100070283300000A130F110F399B03000000027B0C0000046F4900000672860F0070283300000A13101110396C0100000072B61000700A72A0100070027B0C0000046F410000062816000006282A00000A0B027B0C0000046F2D000006285500000A131111112C5400027B0C0000046F2B0000067211000070282000000A131211122C20000772C6100070027B0C0000046F2B00000672DC100070283C00000A0B002B15000772C6100070110472DC100070283C00000A0B00002B140007027B0C0000046F2D000006282A00000A0B001F098D47000001251607A2251772E6100070A22518027B0C0000046F3F000006A2251972DF0C0070A2251A027B0C0000046F4D000006A2251B728C100070A2251C027B0C0000046F47000006A2251D72F0100070A2251E09A2284000000A0B027B0C0000046F51000006285500000A131311132C10000772FA100070282A00000A0B002B46001C8D47000001251607A225177202110070A22518027B0C0000046F4B000006A22519720C110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A1314111439F600000000721A1100700A1C8D4700000125167236110070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1C8D47000001251607A22517723E110070A22518027B0C0000046F4B000006A225197246110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B027B0C0000046F2B0000067211000070282000000A131511152C1B00077250110070027B0C0000046F2B000006284300000A0B002B0F0007725011007008284300000A0B000772A0100070027B0C0000046F2D000006284300000A0B00027B0C0000046F49000006724C100070283300000A1316111639C40000000072721100700A1C8D470000012516728A110070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B07729411007008284300000A0B027B0C0000046F2B0000067211000070282000000A131711172C1B00077294110070027B0C0000046F2B000006284300000A0B002B0F0007729411007008284300000A0B00000772A0100070027B0C0000046F2D000006284300000A0B002B1A00027B0C0000046F410000060A027B0C0000046F2D0000060B0073AF00000A25066FB000000A0025076FB100000A0025176FB200000A0025176FB300000A0025176FB400000A0025166FB500000A0025176FB600000A00130773B700000A131800111811076FB800000A0011186FB900000A26027B0C0000046F4900000672860F0070282000000A2C17027B0C0000046F2F000006729E110070282000000A2B0116131B111B2C260008285700000A131C11186FBA00000A111C6FBB00000A0011186FBA00000A6FBC00000A000011186FBD00000A6F6F00000A131911186FBE00000A6F6F00000A131A11186FBF00000A0011186FC000000A16FE01131D111D2C6400027B0C00000472010000706F3A00000600027B0C0000046F2B000006285500000A131E111E2C36001104285600000A131F111F2C1700027B0C0000041104285700000A6F2C00000600002B1000027B0C00000411196F2C00000600000000388000000000111A285500000A132011202C3B0009285600000A132111212C2B00027B0C000004027B0C0000046F3B00000609285700000A282A00000A6F3C000006000928C100000A0000002B1000027B0C000004111A6F3C0000060000027B0C0000046F3B000006285500000A132211222C1000027B0C00000411196F3C00000600000008285600000A132311232C09000828C100000A000000DE0D11182C0811186F3500000A00DC00DE19132400027B0C00000411246F2700000A6F3C0000060000DE00027B0C0000046F3B000006285500000A132511252C1500027B0C00000472010000706F3A00000600002B1300027B0C00000472AF0A00706F3A00000600002A004134000002000000610800009E010000FF0900000D00000000000000000000005B010000B40800000F0A000019000000170000011330040043000000130000110072F40F00700272AC11007072110000706F8F00000A72B011007072110000706F8F00000A72F40F007072B41100706F8F00000A72F40F0070284300000A0A2B00062A001B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011330040037000000140000110002285500000A0A062C0872BA1100700B2B2272F40F00700272F40F007072B41100706F8F00000A72F40F0070284300000A0B2B00072A001330020047000000000000000228AE00000A000002037D1300000402036F470000067D1400000402036F490000067D1500000402036F410000067D1600000402047D1800000402036F350000067D170000042A001B3006006B0D0000150000110002027B130000046F410000067D16000004027B13000004166F3200000600027B1300000472110000706F3C0000060002027B130000046F490000067D15000004734500000A0A734500000A0B027B15000004724C100070283300000A0C0839BD030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A7216120070A2251F0B027B130000046F51000006A2251F0C72B10C0070A2251F0D027B130000046F4F000006A2284000000A0D0973C200000A1304000011046F1500000A00027B16000004110473C300000A1305001105027B170000046FC400000A0011056FC500000A1306381201000000734500000A1307110711066FC600000A00110714FE031308110839C50000000011076F8000000A72221200706FC700000A130911092C7A000011076F4700000A6F7700000A130A2B44110A6F7800000A742D000001130B00027B13000004027B130000046F3B000006110B72221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000110A6F7D00000A2DB3DE16110A752E000001130C110C2C08110C6F3500000A00DC002B3000071107176F4C00000A00027B13000004027B130000046F3100000611076F4700000A6F4800000A586F320000060000002B2C00723C120070130D027B13000004027B130000046F3B000006110D284400000A284300000A6F3C00000600000011066FC800000A16FE01130E110E3ADBFEFFFF00DE0D11052C0811056F3500000A00DC00DD46010000130F007260120070131016131138B9000000001F0C8D4700000125161110A22517727E120070A225181211283F00000AA22519728E120070A2251A110F6FC900000A11116FCA00000A6FCB00000AA2251B72A4120070A2251C110F6FC900000A11116FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E110F6FC900000A11116FCA00000A6FCD00000AA2251F0972D6120070A2251F0A110F6FC900000A11116FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A1310001111175813111111110F6FC900000A6FCF00000AFE04131311133A2EFFFFFF027B13000004027B130000046F3B0000061110284400000A284300000A6F3C0000060000DE3C13140072E412007011146F2700000A282A00000A1315027B13000004027B130000046F3B0000061115284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02131611162C17000207281B00000600027B18000004076FD000000A000011046F4F00000A0011046F4E00000A0000DC00DE0D11042C0811046F3500000A00DC00027B1500000472F80F0070283300000A1317111739CE030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A72FE120070A2251F0B027B130000046F51000006720C13007072101300706F8F00000AA2251F0C7216130070A2251F0D027B130000046F4F000006A2284000000A1318111873C200000A1319000011196F1500000A00027B16000004111973C300000A131A00111A027B170000046FC400000A00111A6FC500000A131B381201000000734500000A131C111C111B6FC600000A00111C14FE03131D111D39C500000000111C6F8000000A72221200706FC700000A131E111E2C7A0000111C6F4700000A6F7700000A131F2B44111F6F7800000A742D000001132000027B13000004027B130000046F3B000006112072221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000111F6F7D00000A2DB3DE16111F752E000001130C110C2C08110C6F3500000A00DC002B300007111C176F4C00000A00027B13000004027B130000046F31000006111C6F4700000A6F4800000A586F320000060000002B2C00723C1200701321027B13000004027B130000046F3B0000061121284400000A284300000A6F3C000006000000111B6FC800000A16FE01132211223ADBFEFFFF00DE0D111A2C08111A6F3500000A00DC00DD460100001323007260120070132416132538B9000000001F0C8D4700000125161124A22517727E120070A225181225283F00000AA22519728E120070A2251A11236FC900000A11256FCA00000A6FCB00000AA2251B72A4120070A2251C11236FC900000A11256FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E11236FC900000A11256FCA00000A6FCD00000AA2251F0972D6120070A2251F0A11236FC900000A11256FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A132400112517581325112511236FC900000A6FCF00000AFE04132611263A2EFFFFFF027B13000004027B130000046F3B0000061124284400000A284300000A6F3C0000060000DE3C13270072E412007011276F2700000A282A00000A1328027B13000004027B130000046F3B0000061128284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02132911292C17000207281B00000600027B18000004076FD000000A000011196F4F00000A0011196F4E00000A0000DC00DE0D11192C0811196F3500000A00DC00027B1500000472860F0070283300000A132A112A390B05000000001873D100000A132B00731200000A132C027B130000046F51000006285500000A132D112D2C71001E8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C725A130070A2251D027B130000046F4F000006A2284000000A731400000A132C00389C000000001F0C8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C72C2130070A2251D027B130000046F4B000006A2251E7208140070A2251F09027B130000046F51000006A2251F0A7220140070A2251F0B027B130000046F4F000006A2284000000A731400000A132C000000112C6F1500000A0016132E14132F112C6FD200000A13301130027B160000046F1700000A001130027B170000046FC400000A00027B1600000472261400706F4900000A133211322C280017132E11306F8400000A724E1400701F1620C80000006FD300000A132F112F186FD400000A000011306F1900000A1331380701000000734500000A1333113311316FC600000A00113314FE031334113439C50000000011336F8000000A726A1400706FC700000A133511352C7A000011336F4700000A6F7700000A13362B4411366F7800000A742D000001133700027B13000004027B130000046F3B0000061137726A1400706F9900000A252D0426142B056F2900000A282A00000A6F3C000006000011366F7D00000A2DB3DE161136752E000001130C110C2C08110C6F3500000A00DC002B3000071133176F4C00000A00027B13000004027B130000046F3100000611336F4700000A6F4800000A586F320000060000002B2100723C1200701338027B130000041138284400000A282A00000A6F3C00000600000011316FC800000A16FE01133911393AE6FEFFFF112E133A113A2C6A00112F6FD500000A756100000114FE0316FE01133B113B2C5000112F6FD500000A7447000001728E140070282000000A133C113C2C32007292140070112F6FD500000A7447000001282A00000A133D027B13000004113D284400000A282A00000A6F3C0000060000000000DDB8000000133E007211000070133F113E6FD600000A1FFEFE01134011402C0B0072B4140070133F002B150072EC140070113E6F2700000A282A00000A133F00027B13000004113F284400000A282A00000A6F3C0000060000DE62134100720815007011416F2700000A282A00000A1342027B130000041142284400000A282A00000A6F3C0000060000DE31134300723E15007011436F2700000A282A00000A1344027B130000041144284400000A282A00000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02134511452C17000207281B00000600027B18000004076FD000000A0000112C6F4F00000A00112C6F4E00000A0000DC00DE0D112B2C08112B6F3500000A00DC00DDB4000000134600725415007011466F2700000A282A00000A1347027B13000004027B130000046F3B0000061147284400000A284300000A6F3C0000060000DE78134800728E15007011486F2700000A282A00000A1349027B13000004027B130000046F3B0000061149284400000A284300000A6F3C0000060000DE3C134A0072BA150070114A6F2700000A282A00000A134B027B13000004027B130000046F3B000006114B284400000A284300000A6F3C0000060000DE0000027B130000046F3B000006285500000A134C114C2C1500027B1300000472010000706F3A00000600002B1300027B1300000472AF0A00706F3A00000600002A0041FC0100020000009701000051000000E80100001600000000000000020000003201000045010000770200000D00000000000000000000001A010000700100008A0200000A0100003F000001000000001A01000070010000940300003C00000017000001020000001A010000B8020000D20300003E000000000000000200000019010000FA020000130400000D00000000000000020000007E05000051000000CF05000016000000000000000200000019050000450100005E0600000D00000000000000000000000105000070010000710600000A0100003F0000010000000001050000700100007B0700003C000000170000010200000001050000B8020000B90700003E000000000000000200000000050000FA020000FA0700000D00000000000000020000001F0A000051000000700A00001600000000000000000000005709000012020000690B00005600000015000001000000005709000012020000BF0B00003100000042000001000000005709000012020000F00B000031000000170000010200000057090000CC020000230C00003E00000000000000020000002B08000039040000640C00000D00000000000000000000002208000055040000770C00003C0000001E000001000000002208000055040000B30C00003C0000001F000001000000002208000055040000EF0C00003C0000001700000113300200730000001600001100036F8000000A72A00100706FC700000A16FE010B072C5A0072A001007073D700000A0A0672D015007028D800000A6FD900000A0006176FDA00000A0006027B130000046F370000068C1C0000016FDB00000A0006166FDC00000A00036F8000000A066FDD00000A0006166FDE00000A00002A00133001000C0000001700001100027B1F0000040A2B00062A260002037D1F0000042A0000133001000C0000001800001100027B1C0000040A2B00062A260002037D1C0000042A0000133001000C0000001800001100027B1B0000040A2B00062A260002037D1B0000042A0000133001000C0000001800001100027B1A0000040A2B00062A260002037D1A0000042A0000133001000C0000001800001100027B190000040A2B00062A260002037D190000042A0000133001000C0000001900001100027B1E0000040A2B00062A260002037D1E0000042A0000133001000C0000001300001100027B1D0000040A2B00062A260002037D1D0000042A0000133001000C0000001300001100027B310000040A2B00062A260002037D310000042A0000133001000C0000001300001100027B2C0000040A2B00062A260002037D2C0000042A0000133001000C0000001300001100027B2B0000040A2B00062A260002037D2B0000042A0000133001000C0000001800001100027B230000040A2B00062A260002037D230000042A0000133001000C0000001800001100027B210000040A2B00062A260002037D210000042A0000133001000C0000001800001100027B220000040A2B00062A260002037D220000042A0000133001000C0000001A00001100027B200000040A2B00062A260002037D200000042A0000133001000C0000001300001100027B2A0000040A2B00062A260002037D2A0000042A0000133001000C0000001300001100027B300000040A2B00062A260002037D300000042A0000133001000C0000001300001100027B330000040A2B00062A260002037D330000042A0000133001000C0000001300001100027B2D0000040A2B00062A260002037D2D0000042A0000133001000C0000001300001100027B2F0000040A2B00062A260002037D2F0000042A0000133001000C0000001300001100027B280000040A2B00062A260002037D280000042A0000133001000C0000001300001100027B240000040A2B00062A260002037D240000042A0000133001000C0000001300001100027B260000040A2B00062A260002037D260000042A0000133001000C0000001300001100027B270000040A2B00062A260002037D270000042A0000133001000C0000001300001100027B250000040A2B00062A260002037D250000042A0000133001000C0000001300001100027B320000040A2B00062A260002037D320000042A0000133001000C0000001300001100027B2E0000040A2B00062A260002037D2E0000042A0000133001000C0000001300001100027B290000040A2B00062A260002037D290000042A0000133001000C0000001B00001100027B340000040A2B00062A260002037D340000042A3E02167D340000040228AE00000A002A000013300100070000001B00001100170A2B00062A0042534A4201000100000000000C00000076342E302E33303331390000000005006C00000064140000237E0000D01400002C16000023537472696E677300000000FC2A0000E815000023555300E4400000100000002347554944000000F4400000C808000023426C6F620000000000000002000001571FA2090902000000FA013300160000010000007B0000000700000034000000570000005600000001000000DE00000010000000110000001B000000020000001C000000380000000B00000001000000040000000100000000005A09010000000000060041079F0F0600AE079F0F06007706300F0F00BF0F000006008B06F20A06002407F20A0600F006F20A06009507F20A06006107F20A06007A07F20A0600B806F20A0600D306F20A06008512070A0A00A206680E0A007108DD0F06001100B1010A001705680E0A00BC0B09130A00610209130A00840D09130A006D0C09130A006C0B09130600CD0C070A0600F904070A0A008B03580143001F0F00000600D101540806001F02070A0600240A070A0E00350CBF1006007A0C070A1200CE0FE6040A000F07680E0A000E0ADD0F0600A90C070A06000E0CF6001200001494121200F60594120600A00DF6000600DB09F60012001A0C94120A006401680E0A008D02680E0600100FD3100A004015580106009503070A0A00320A58010A00D20A09130A00820558010600CA02070A0600BC05070A0A00BA15091312007015941212008A1394120600200603101200041494121200350D300F1200DA11300F1200010050130A00AD0BA0010A004702A0010A00750DA0010A00270CA0010E001F05BF100A00250E091306008F0C070A0A002D15680E0A00A00B090D0A003D02090D0A00680D090D06008D08070A0A00070F09130600CB13540806002400070A06001F13070A0A007F0B58010A00CE05580112003A13440912006A15A01012002811A0100600DE03F6001200050E941212008C05941206004C0D070A12002D0B94121200040BF50106006808F8141200FA0594121200E20294120600AD0DF60006002D00070A0A00180B580106001C0A070A0A00410B09130A00C40A090D0600E307070A06007509070A0600C50C070A0A005A0658010600510C070A0600AB03070A0A003110DD0F0A007A11DD0F0A00D815DD0F0A00E007DD0F0A00F604DD0F0A00A103DD0F0A001402DD0F0A003300DD0F0A001800DD0F0A002A00DD0F0A00B115DD0F0A002309DD0F0A00CF03DD0F0A008709DD0F0600320EF60006003F0EF6000A005C0D58010A00580BA0010A00C10EA0010E00F70BBF100A00190E090D0A00D80B5801000000004500000000000100010001001000F20F0000350001000100000010008200000035000600140000001000E000000035000D0019000000100027010000350019001C0000001000E90C0000350020002B0002001000991500003500350056005180A300F2065180F000F20651809D00F2065180D211F2065180E101F2065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100F80DF2060100D70CF5065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100C311F9060100D70CF50601004E00F2060100B80DF2060100A900F20601005714020701008F11F9060100790F020701005D10020701007311020701008110020701002104F20601004D01F90601005311050701007A000D070100790F020701002F1402070100691202070100DA04F2060100B204F20601009304F2060100EC0DF2060100600EF20601009B02F20601003612F20601004A05F2060100FE11F20601001C01F20601001411F2060100EB00F2060100B30EF2060100B214F2060100FA13F20601005503F2060100C10811075020000000009600A709140701003C30000000009600C808940105007030000000009600E603A7000700B0310000000096000C091F0708001C35000000009600E3032F0711005C36000000009600D90337071300B03700000000910087033E0715001C3900000000910070014407160098390000000091006E13500718003C3C00000000910068035C071A00B03F00000000910079035C071D008042000000009100B30265072000B0420000000091006E056D072100D842000000009100C6157507220008440000000091003D0A800727009045000000009100530A8B07290024480000000091005B0F98072C00F8480000000091006A0FA2072D0078490000000086182A0F06002E0081490000000086182A0FA8072E00A449000000008600DA11060030004C54000000009100E215E00130009C54000000009100D90337073100F0550000000091002B13E001330034560000000086182A0FAF0734008856000000008600DA1106003600FC650000000081005900060436007C660000000086083511BC07370094660000000086084411C5073700A066000000008608671020013800B866000000008608741001003800C4660000000086085F1120013900DC66000000008608691101003900E866000000008608431020013A000067000000008608501001003A000C67000000008608430F20013B0024670000000086084F0F01003B0030670000000086083101CF073C0048670000000086083F01D9073C00546700000000860801040F013D006C67000000008608110410003D0078490000000086182A0F06003E0078670000000086088E140F013E009067000000008608A01410003E009C67000000008608E2110F013F00B467000000008608F01110003F00C06700000000860830050F014000D8670000000086083D0510004000E467000000008608471220014100FC670000000086085812010041000868000000008608430F2001420020680000000086084F0F010042002C68000000008608171420014300446800000000860823140100430050680000000086086400E407440068680000000086086F00E9074400746800000000860820120F0145008C680000000086082B12100045009868000000008608910E0F014600B068000000008608A20E10004600BC6800000000860829030F014700D4680000000086083F0310004700E06800000000860800010F014800F8680000000086080E01100048000469000000008608BE000F0149001C69000000008608C6001000490028690000000086084A0E0F014A004069000000008608550E10004A004C69000000008608BC040F014B006469000000008608CB0410004B0070690000000086087D040F014C008869000000008608880410004C009469000000008608CE0D0F014D00AC69000000008608DD0D10004D00B86900000000860863040F014E00D069000000008608700410004E00DC69000000008608E8130F014F00F469000000008608F11310004F00006A000000008608E6100F015000186A000000008608FD1010005000246A0000000086088D000F0151003C6A000000008608950010005100486A000000008608AD0806015200606A000000008608B708D30452006A6A0000000086182A0F060053007C6A00000000E601DB12EF07530078490000000086182A0F0600570000000100F90D02000200A20800000300820F00000400C208000001002815000002009C0A00000100A90400000100B70900000200821300000300A11100000400860200000500C10500000600FE0200000700C41300000800FF12020009001C0D00000100A904020002008F0100000100A904000002008F01000001009112000001009112000002007B0800000100091200000200760A000001009B0400000200911200000300760A000001009B0400000200911200000300760A00000100000300000100A10500000100911200000200A309000003003D04000004007C0A10100500CE00000001006F0A000002007B0800000100E104000002006F0A00000300A10500000100C41200000100CF1200000100F90D00000200FA0C00000100B60000000100A904000002008F01000001009E0800000100FA0C000002009811000001008C12000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001009713000002003006000003000F1400000400E2090700D50009002A0F010011002A0F060019002A0F0A0029002A0F100031002A0F100039002A0F100041002A0F100049002A0F100051002A0F100059002A0F100061002A0F100071002A0F060009012A0F060079009F12A7000C002A0F060014002A0F060019020E05BB0091002A0F060099002A0F060091002A0F100021022D0A06009900910BC00029020415100089006C02C6009900920DCC0031022E09D10031021C02D60031022100DC0031028A08E1003102190AE6001400DD01EB0039020F16F1001C002A0F060024002A0F06000C00DD01EB003102CC010601310212060600A900B8110A01B90005030F01B100F5091301690081080F01390277121A01B100A01320018900760210001400A0132001C100381524010C001C0F29012C004413390114001C0F290134004413390139020316F1003400EF1406017101180606002C00EF14060149022A0F4501D9002A0F4B01D900F8031000D900E21306002400DD01EB00390277125201D900460D5A01C10081085F01510281080F01390277126401C100B50A6A01E9008E0F7301390277127701590202057E01C9002A0F06001C0017038201C9003E1289016902A0132001390201098F0179000F169401110140089E01C9001103A5011C00A013200171021806060021021206060039028B108F017900E8070F01E9002A0FB2017902CE08B90111019F12C40139021D16DB0189021912DB0189021415E00191028315140291028E091B0291021F082202C1013C062702C1017B021000C101B10510002901F11210002901B9131000C101381401003902AB122E02C10183113502B102FE093B02B9023C004102B9023A104702C101E1084D02C101D1095202410171065802C10106066002C102BF095202B9026508660239012A0F6D0239012A0F77023101D3027E02D10224020F0139027E1284027900EB0B8B024901E905600279007C09060189022015B00259012A0FD9028900D713E10269021C0FE80261014413EE025901AA1320016901F509F2025901FF07F70289004815E1026101EF14060189002E020600D90281080F01C90094100E03E102F50914039100E10A3A0399002A0F40039900A9114A03F102F20750032902F3152001F902B1120600F9021A0906003C002A0F06003C00DD01EB005101EF030F0151017E0586033C008B108C035101F30892033902A00296035101810A9C03010381080F0151011F039C0399002A0FA0033C001C0F29014400441339014400EF1406013902D608200139029408DB036901F509E10309031308E60311032A0F1000210250060004A1012A0FC000A1012E041000A101830E060421032A0F1000790154052004790154040F019901C702260451012A0F2F0451012A0F37047901F30820019901BD035D0489038F0A690451012A0F6C0424001C0F29015C0044133901D900480806015C00EF14060169002A0F0600C9012A0F0600C90147041000C901F0111000C9017414D304C901D414D304C901DD0ED304C901CC07D304C9015715D304D1012A0F0600D101270DD804D101E2130601D1016214DF04A90371061000A90312060600D101C114E504D101CB0EE504D101B8120600D101F102200189026A06EB04E1012A0F1000E9012A0F7D05290244140100E901920D8505C900D8018B05E1028B108F013102E8010601F901B8119205B903F5099805C10305030F01C103F70E2001C103A8020F01C10343060F01B903A01320011C00DD01EB0001022A0F9F0591005302A605F102DD01AB05D103CA0BB605D103E807EE02A900510D200179012A0F10009901A905C40579016105CB0579016C09D30479010808D20579013508D304E102DD01D7057901390901000E000400A9060E000800B4060E000C00BF060E001000D4060E001400E3060E001800A9060E001C00B4060E002000BF060E002400D4060E002800E3060E003400A9060E003800B4060E003C00BF060E004000D4060E004400E30602009900F006200063009D082E000B0021082E0013002A082E001B0049082E00230052082E002B0065082E00330065082E003B006B082E0043007D082E004B006B082E00530065082E005B00900840006B00A20860006B00A208800063009D08A00063009D08C00063009D081500AC01CB01E5019402A102B602FD021B035803A703EB03F0030C04400476049504A304F004F404F904BD05DE05E705EB05F505FA05050001000600080000005411FD0700008210060800007411060800005E10060800007A0F060800004E010A080000220414080000B31414080000FF11140800004B05140800006A12060800007A0F060800003014060800007B0018080000371214080000B40E140800005603140800001D0114080000F20014080000610E14080000DB0414080000940414080000ED0D14080000740414080000FB1314080000151114080000990014080000BB081D0802001C00030001001D00030002001E00050001001F000500020020000700010021000700020022000900010023000900020024000B00010025000B00020026000D00010027000D00020028000F00010029000F0002002B00110001002C00110002002D00130001002E00130002002F001500010030001500020031001700010032001700020033001900010034001900020035001B00010036001B00020037001D00010038001D00020039001F0001003A001F0002003B00210001003C00210002003D00230001003E00230002003F002500010040002500020041002700010042002700020043002900010044002900020045002B00010046002B00020047002D00010048002D00020049002F0001004A002F0002004B00310001004C00310002004D00330001004E00330002004F003500010050003500020051003700010052003700020053003900010054003900AD00B400F700FF0032013E018003D5035A0466048E04048000000100000000000000010000000706A70A0000040000000000000000000000FE05970100000000040000000000000000000000FE05580100000000040000000000000000000000FE05BF1000000000040000000000000000000000FE05070A00000000070002000000000000436F6E63757272656E744261676031004C69737460310053716C496E74333200476574496E7433320053716C496E7436340053716C496E743136006765745F55544638003C4D6F64756C653E0073457865637574654442004164645F52756E5F4944006765745F52756E5F4944007365745F52756E5F4944007652756E5F49440045786563757465434D44006765745F505744007365745F50574400504753514C004D5353514C0073457865637574655453514C005468655F53514C006765745F53514C007365745F53514C00636F6E6E656374696F6E5479706553514C004578656375746553514C007653514C004D7953514C0053797374656D2E494F006765745F49505F6F725F444E53007365745F49505F6F725F444E53007649505F6F725F444E530052657475726E5F4454006765745F526573756C745F4454007365745F526573756C745F44540076526573756C745F44540053797374656D2E446174610053716C4D657461446174610045787472616374446174615461626C65436F6C756D6E4D657461446174610074686564617461006D73636F726C69620053797374656D2E446174612E4F6462630053797374656D2E436F6C6C656374696F6E732E47656E65726963005265616400546872656164004C6F616400416464006661696C6564006765745F4973436C6F7365640053797374656D2E436F6C6C656374696F6E732E5370656369616C697A65640053716C4775696400476574477569640052656164546F456E640053656E64526573756C7473456E64004462436F6D6D616E64004F646263436F6D6D616E6400437265617465436F6D6D616E640053716C436F6D6D616E640045786563757465416E6453656E64007365745F4D6574686F64006D6574686F640053716C446174615265636F72640076507764005265706C616365006765745F536F7572636500496E76616C69644461746154797065436F64650047657454797065436F6465006765745F537461747573436F64650048747470537461747573436F6465006765745F45786974436F646500656E636F6465006765745F4D657373616765004D657267650054727954616B65006765745F5363616C65006765745F5265737475726E5F544D505F5461626C65007365745F5265737475726E5F544D505F5461626C6500765265737475726E5F544D505F5461626C6500416C7465725F54656D705F5461626C65004C6F6164446174615461626C650053656E64446174615461626C650049446973706F7361626C650053716C446F75626C650052756E74696D655479706548616E646C65004765745479706546726F6D48616E646C650053716C53696E676C6500577269746546696C650075705F7265616466696C65006765745F4E616D65007365745F4E616D65006765745F526573756C745F4E616D65007365745F526573756C745F4E616D650076526573756C745F4E616D65007365745F44657374696E6174696F6E5461626C654E616D65007365745F46696C654E616D65006765745F436F6C756D6E4E616D65006765745F557365724E616D65007365745F557365724E616D65006765745F44426E616D65007365745F44426E616D65007644426E616D6500746D707461626C655F6E616D650066696C656E616D650076557365726E616D65006765745F5365727665726E616D65007365745F5365727665726E616D6500765365727665726E616D650053797374656D2E4E65742E4D696D650053716C4461746554696D65006765745F4E65774C696E65006765745F506970650053716C50697065005472616E73616374696F6E53636F7065006765745F434D445F54797065007365745F434D445F547970650076434D445F54797065006765745F4461746154797065007365745F446174615479706500556E6B6E6F776E4461746154797065006765745F53716C44625479706500536563757269747950726F746F636F6C5479706500636C72547970650047657454797065007365745F436F6E74656E745479706500636F6E74656E745F7479706500496E7465726E616C44617461436F6C6C656374696F6E42617365006765745F526573706F6E73650048747470576562526573706F6E736500476574526573706F6E736500436C6F736500446973706F73650058353039436572746966696361746500636572746966696361746500437265617465006765745F53514C5374617465006765745F537461746500436F6E6E656374696F6E53746174650044656C6574650057726974650044656275676761626C6541747472696275746500417373656D626C795469746C654174747269627574650053716C50726F63656475726541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465007365745F5573655368656C6C457865637574650053716C42797465006765745F56616C7565004164645769746856616C75650053657456616C7565007365745F44656661756C7456616C75650076616C7565007365745F457870656374313030436F6E74696E7565007365745F556E69717565006F705F54727565006765745F4973416C6976650053797374656D2E546872656164696E6700476574456E636F64696E670053716C537472696E6700636F65726365546F537472696E6700476574537472696E6700537562737472696E67006172670052657475726E5F4D7367006765745F4465627567007365745F4465627567007664656275670052656745785F49734D61746368006765745F4C656E677468007365745F436F6E74656E744C656E677468006765745F4D61784C656E67746800537461727473576974680063616C6C5F726573745F61706900526F6C6C6261636B0053716C446563696D616C004765744F7264696E616C005365744F7264696E616C0053797374656D2E436F6D706F6E656E744D6F64656C0064625F6175746F6D6174696F6E2E646C6C007365745F416C6C6F7744424E756C6C006765745F49734E756C6C0053716C586D6C007365745F536563757269747950726F746F636F6C0053716C00657865635F72656D6F74655F73716C006170695F75726C00476574526573706F6E736553747265616D004765745265717565737453747265616D00636572746966696361746550726F626C656D006765745F4974656D007365745F4974656D0053797374656D0053716C426F6F6C65616E00476574426F6F6C65616E0054696D655370616E004F70656E0044617461436F6C756D6E0053716C4D6574614461746146726F6D436F6C756D6E0053716C4D6574614461746146726F6D4F626A656374436F6C756D6E00636F6C756D6E006F436F6E6E00636F6E6E006765745F507265636973696F6E004D6178507265636973696F6E0045787072657373696F6E0064625F6175746F6D6174696F6E006F705F5375627472616374696F6E0044625472616E73616374696F6E0053716C5472616E73616374696F6E00426567696E5472616E73616374696F6E0053797374656D2E5265666C656374696F6E004E616D6556616C7565436F6C6C656374696F6E0044617461436F6C756D6E436F6C6C656374696F6E00576562486561646572436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E004F6462634572726F72436F6C6C656374696F6E0053716C4572726F72436F6C6C656374696F6E0044617461526F77436F6C6C656374696F6E007365745F436F6E6E656374696F6E004462436F6E6E656374696F6E004F646263436F6E6E656374696F6E0053716C436F6E6E656374696F6E007365745F446972656374696F6E00506172616D65746572446972656374696F6E006F705F4164646974696F6E005472616E73616374696F6E53636F70654F7074696F6E00494F457863657074696F6E00576562457863657074696F6E004F646263457863657074696F6E005472616E73616374696F6E41626F72746564457863657074696F6E00417267756D656E744F75744F6652616E6765457863657074696F6E0053716C457863657074696F6E004170706C69636174696F6E457863657074696F6E00496E76616C69644F7065726174696F6E457863657074696F6E00556E617574686F72697A6564416363657373457863657074696F6E00417267756D656E74457863657074696F6E007352656D6F74655F457865637574696F6E0072656D6F74655F657865637574696F6E00546869735F657865637574696F6E0053797374656D2E446174612E436F6D6D6F6E006170695F72657475726E007365745F5374617274496E666F0050726F636573735374617274496E666F00536C6565700043686172006765745F4E756D62657200494461746152656164657200446244617461526561646572004F646263446174615265616465720053716C4461746152656164657200457865637574655265616465720053747265616D526561646572005465787452656164657200734578656375746544425F444250726F7669646572006765745F444250726F7669646572007365745F444250726F76696465720076444250726F7669646572007354656D705F466F6C6465720053657276696365506F696E744D616E61676572004462506172616D657465720053716C506172616D657465720053747265616D5772697465720054657874577269746572006765745F447269766572007365745F4472697665720076447269766572004D6963726F736F66742E53716C5365727665722E536572766572005772697465546F536572766572006765745F52656D6F74655F4572726F72007365745F52656D6F74655F4572726F72007652656D6F74655F4572726F72004F6462634572726F72006765745F5374616E646172644572726F72007365745F52656469726563745374616E646172644572726F72006765745F4E61746976654572726F720053716C4572726F720049456E756D657261746F7200476574456E756D657261746F72002E63746F720053797374656D2E446961676E6F7374696373006765745F54687265616473007365745F546872656164730052756E6E696E6754687265616473005265667265736854687265616473007654687265616473006D61785F74687265616473006765745F546F74616C5365636F6E64730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004D65646961547970654E616D65730053797374656D2E446174612E53716C54797065730053746F72656450726F636564757265730053797374656D2E53656375726974792E43727970746F6772617068792E583530394365727469666963617465730053716C4279746573004765744279746573006765745F52756E6E696E6773007365745F52756E6E696E6773007652756E6E696E6773006765745F57616974696E6773007365745F57616974696E6773007657616974696E677300436F6E7461696E73006765745F436F6C756D6E730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E5472616E73616374696F6E730053797374656D2E436F6C6C656374696F6E73006765745F436F6E6E656374696F6E5F4F7074696F6E73007365745F436F6E6E656374696F6E5F4F7074696F6E730076436F6E6E656374696F6E5F4F7074696F6E730052656765784F7074696F6E73006765745F457865637574696F6E73007365745F457865637574696F6E730076457865637574696F6E73006765745F53746F7073007365745F53746F7073007653746F70730053716C4368617273006765745F48656164657273006452656164657273006F526561646572730068656164657273006765745F506172616D6574657273006765745F4572726F7273006F457865637574654572726F727300737563636573730050726F63657373006765745F417267756D656E7473007365745F417267756D656E74730076417267756D656E747300726573756C745F636F6E74656E747300457869737473006765745F537461747573007365745F5374617475730076537461747573006765745F526F7773006765745F4166666563746564526F7773007365745F4166666563746564526F777300764166666563746564526F777300436F6E63617400466F726D6174004F626A65637400746869735F64740053797374656D2E4E6574006F705F496D706C696369740053706C697400436F6D6D69740057616974466F724578697400416C6C5F526573756C7400546869735F526573756C7400436865636B56616C69646174696F6E526573756C74007365745F557365724167656E7400757365726167656E740053797374656D2E446174612E53716C436C69656E7400456E7669726F6E6D656E7400457363617065417267756D656E7400436F6D706F6E656E74006765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E74005570646174655F457865635F436F6E74656E7400636F6E74656E740053657276696365506F696E7400737276506F696E74006765745F436F756E74006765745F4669656C64436F756E74007365745F416363657074006163636570740054687265616453746172740053656E64526573756C74735374617274006765745F506F7274007365745F506F72740076506F72740048747470576562526571756573740072657175657374006765745F54696D654F7574007365745F54696D654F7574007654696D654F7574007365745F54696D656F7574007365745F436F6D6D616E6454696D656F75740054686574696D656F7574006765745F5374616E64617264496E707574007365745F52656469726563745374616E64617264496E707574006765745F52656D6F74655F4F7574707574007365745F52656D6F74655F4F7574707574007652656D6F74655F4F7574707574006765745F5374616E646172644F7574707574007365745F52656469726563745374616E646172644F7574707574004D6F76654E6578740053797374656D2E54657874007365745F436F6D6D616E64546578740052656164416C6C54657874005772697465416C6C546578740053716C436F6E74657874006765745F4E6F770044617461526F770053656E64526573756C7473526F77007365745F4372656174654E6F57696E646F7700526567657800494365727469666963617465506F6C696379007365745F4365727469666963617465506F6C69637900437573746F6D4365727469666963617465506F6C6963790053716C4D6F6E65790053716C42756C6B436F70790053514C53657276657242756C6B436F70790053716C42696E61727900466F726D61745F53514C5F517565727900457865637574654E6F6E5175657279006F705F457175616C697479006F705F496E657175616C6974790049734E756C6C4F72456D7074790000000F73007500630063006500730073000001003563006F006E007400650078007400200063006F006E006E0065006300740069006F006E0020003D00200074007200750065003B000081556900660020006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074002700290020006900730020006E0075006C006C002000200072006100690073006500720072006F007200200028002700430061006E0020006E006F0074002000660069006E00640020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E007400210027002C00310036002C00310029002000730065006C0065006300740020002A002000660072006F006D0020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E00740020006F0072006400650072002000620079002000720065007400750072006E005F0074006D0070005F007400610062006C0065003B002000010D520075006E005F0049004400000F5400680072006500610064007300000F740069006D0065006F007500740000157300650072007600650072006E0061006D0065000013490050005F006F0072005F0044004E005300000D640062006E0061006D006500000D540068006500530051004C00000950006F00720074000017640062005F00700072006F00760069006400650072000013440042005F00440072006900760065007200001175007300650072006E0061006D0065000007700077006400001B520065006D006F00740065005F004F0075007400700075007400001143004D0044005F005400790070006500001341007200670075006D0065006E0074007300002543006F006E006E0065006300740069006F006E005F004F007000740069006F006E0073000021720065007400750072006E005F0074006D0070005F007400610062006C006500000B44006500620075006700000F570061006900740069006E006700000743004D0044000015530051004C0020004500720072006F0072003A00002145007800630065007000740069006F006E0020004500720072006F0072003A00001D530065006E007400200071007500650072007900200074006F00200000052D002D00010F520075006E006E0069006E006700002779007900790079002D004D004D002D00640064002000480048003A006D006D003A007300730001172D002D002D00530074006100720074006500640020000121200065007800650063007500740069006F006E007300200066006F007200200000052C0020000029200071007500720069006500730020006100720065002000770061006900740069006E006700210000192D002D002D00530065006E00740020006F00750074002000013720007100750065007200690065007300200074006F002000720065006D006F007400650020007300650072007600650072007300210000292D002D002D00520075006E006E0069006E006700200071007500650072006900650073003A00200001372D002D002D0053007400610072007400200074006F002000720065007400750072006E00200072006500730075006C00740073002E000103230000072D002D002D0001292D002D002D00640061007400610020006D00650072006700650020004500720072006F0072003A0001512D002D002D0063006F006E00630075007200720065006E00740042006100670020007400720079006F0075007400200044006100740061005400610062006C00650020006600610069006C0065006400012F20003A002000520065007400750072006E0065006400200061006C006C00200072006500730075006C0074007300000720003A002000001F45007800630065007000740069006F006E005F00530051004C003A002000003145007800630065007000740069006F006E005F005400720061006E0073005F00410062006F0072007400650064003A00001D45007800630065007000740069006F006E005F004100700070003A000051650078006300650065006400730020006D006100780069006D0075006D0020006C0065006E00670074006800200073007500700070006F00720074006500640020006F00660020003400300030003000001745007800630065007000740069006F006E003A00200000534500720072006F0072003A002000660069006C00650020006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E00002F4500720072006F0072003A002000660069006C00650020006E006F00740020006500780069007300740073002E0000514500720072006F0072003A005000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A00200000414500720072006F0072003A0049004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A00200000314500720072006F0072003A0055006E006500780070006500630074006500640020006500720072006F0072003A002000000950004F0053005400003B480054005400500020004500720072006F0072003A0020007B0030007D002C002000440065007400610069006C0073003A0020007B0031007D0000514500720072006F0072003A002000460069006C0065006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E0000455000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A002000003549004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A002000002555006E006500780070006500630074006500640020006500720072006F0072003A00200000434500720072006F0072003A00200049006E00700075007400200064006100740061002000630061006E006E006F00740020006200650020006E0075006C006C002E000019720065007400750072006E00200052006F00770073003D0000372D002D002D0045007800630065007000740069006F006E005F00530065006E00640044006100740061005400610062006C0065003A0001811775007000640061007400650020005B002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074005D0020007300650074002000720065006D006F00740065005F006F00750074007000750074003D004000720065006D006F00740065005F006F00750074007000750074002C00720065006D006F00740065005F006500720072006F0072003D004000720065006D006F00740065005F006500720072006F0072002C00610066006600650063007400650064005F0072006F00770073003D004000610066006600650063007400650064005F0072006F00770073002000770068006500720065002000720075006E005F00690064003D004000720075006E005F006900640000032E00001920002D002D0020006600610069006C00650064003A002000010D6600610069006C0065006400001D4000720065006D006F00740065005F006F0075007400700075007400001B4000720065006D006F00740065005F006500720072006F007200001D4000610066006600650063007400650064005F0072006F0077007300000F4000720075006E005F006900640000292D002D002D004C006F00610064005F004500720072006F00720020004500720072006F0072003A00010749006E007400000D42006900670049006E007400000742006900740000114400610074006500540069006D006500000B4D006F006E0065007900001153006D0061006C006C0049006E007400000F540069006E00790049006E007400002155006E0069007100750065004900640065006E00740069006600690065007200000B4E00740065007800740000095200650061006C000017730071006C005F00760061007200690061006E007400000F560061007200690061006E007400002F49004600200043004F004C005F004C0045004E0047005400480028002700540045004D005000440042002E002E00010927002C002000270001332700290020004900530020004E0055004C004C002000200041004C0054004500520020005400410042004C00450020005B00010D5D002000610064006400200000035B00001D5D002000730071006C005F00560061007200690061006E0074003B0000055D00200000033B0000052000280000052D00310001074D0041005800000529003B00000F44006500630069006D0061006C0000032C0000352D002D002D0041006C007400650072005F00540065006D0070005F005400610062006C00650020004500720072006F0072003A0001808F730065006C0065006300740020006E0061006D0065002000660072006F006D002000740065006D007000640062002E007300790073002E0063006F006C0075006D006E00730020007700680065007200650020006F0062006A006500630074005F00690064003D006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E00012B2700290020006F007200640065007200200062007900200063006F006C0075006D006E005F006900640001096E0061006D006500001B69006E007300650072007400200069006E0074006F0020005B0000155D002000760061006C0075006500730020002800000340000003290000152D002D002D0069006E0073006500720074002000010F20004500720072006F0072003A00001D49006E00760061006C0069006400200074007900700065003A002000001D55006E006B006E006F0077006E00200074007900700065003A002000001D7B0022007300740061007400750073003A0022004F004B0022007D000055540068006900730020006D006500740068006F00640020006900730020006F006E006C007900200066006F0072002000530051004C002000530065007200760065007200200045006E00670069006E006500730000317B0022007300740061007400750073003A0022006600610069006C006500640022002C0022006D00730067003A00220000032D00010522007D000011730071006C005F0063006D0064005F00001579007900790079005F004D004D005F006400640000035F0000092E00730071006C0000092E006C006F00670000092E006F0075007400000F530051004C005F0043004D004400000B4D005300530051004C000015530051004C0043004D0044002E0045005800450000192D00620020002D007200310020002D00780020002D005300010720002D006400010720002D007400010720002D006900010720002D004500010720002D005500010920002D005000220001032200000B4D007900530051004C0000134D005900530051004C002E00450058004500000D2D00420020002D0068002000010920002D0050002000010920002D0044002000010920002D0075002000010720002D007000011550006F0073007400670072006500530051004C0000115000530051004C002E00450058004500000D2D00710020002D0068002000010920002D0070002000010920002D0064002000010920002D0077002000010320000011530051004C005F00440055004D005000000F4200430050002E0045005800450000152000710075006500720079006F00750074002000000920002D0063002000010920002D0053002000010920002D0065002000010720002D005400010920002D0055002000010920002D005000270001032700011B4D005900530051004C00440055004D0050002E0045005800450000072D0068002000010720002D007500010920002D0070002700012120002D002D0072006500730075006C0074002D00660069006C0065003D0020000117500047005F00440055004D0050002E00450058004500000920002D0068002000010920002D0066002000010D4F0053005F0043004D00440000030A0000030D0000055C00220000052200220000114400720069007600650072003D007B0000137D003B005300650072007600650072003D0000153B00440061007400610062006100730065003D00000B3B005500690064003D00000D3B0050006F00720074003D00000B3B005000770064003D000019720065006D006F00740065005F006500720072006F007200002374006D0070005F006400740020006C006F006100640020006E0075006C006C002D00011D4F0064006200630045007800630065007000740069006F006E003A00000F49006E006400650078002000230000150A004D006500730073006100670065003A002000001D0A004E00610074006900760065004500720072006F0072003A00200000130A0053006F0075007200630065003A002000000D0A00530051004C003A00200000194F0044004200430020004500720072006F0072003A002000000D3B005000770064003D007B0000037B0000057B007B0000057D003B0000194400610074006100200053006F0075007200630065003D0000233B0049006E0069007400690061006C00200043006100740061006C006F0067003D0000673B0049006E00740065006700720061007400650064002000530065006300750072006900740079003D0053005300500049003B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0000453B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0075007300650072002000690064003D0000173B00700061007300730077006F00720064003D002700010527003B000127650078006500630020004000720065007400750072006E005F00760061006C00750065003D00001B4000720065007400750072006E005F00760061006C00750065000023720065006D006F00740065005F006A0073006F006E005F006500720072006F007200000330000021520065007400750072006E005F00760061006C007500650020006900730020000037530071006C0045007800630065007000740069006F006E002D004500720072006F0072003A00740069006D0065006F00750074002000011B530071006C0045007800630065007000740069006F006E002D00013549006E00760061006C00690064004F007000650072006100740069006F006E0045007800630065007000740069006F006E002D00011545007800630065007000740069006F006E002D0001395400720061006E00730061006300740069006F006E00410062006F00720074006500640045007800630065007000740069006F006E003A00002B4100700070006C00690063006100740069006F006E0045007800630065007000740069006F006E003A00001545007800630065007000740069006F006E003A000017530079007300740065006D002E00470075006900640000C62AA4824EBAAC40AB82787E8387AEB800042001010803200001052001011111042001010E8090074E0E0E15124101121415124101121812451249124D02121412511218020202125512590E080208125D080811610812651511690112141214151169011218121802151169011214121402151169011218121802120C126D11710202020E116108021210126D0202020E02020E0211750E02151169011214121412650202020202125D02020212551279127D125D0E02050001113D0E0615124101121406151241011218040000124505200101124905200101124D0420001251042001080E05200111710804200108080420010E080420010208052001011300050002020E0E07151280ED0112650615124101126D0320000204200012590320000E062001128121080500020E0E0E03200008040000116108200015116901130006151169011214042000130006151169011218052002011C18062001011281250700040E0E0E0E0E04000101080420010E0E0500010E1D0E0800021175116111610320000D0600030E0E0E0E0300000E06200102101300052000128131042001020E090002118089113D113D0600010211808906200201126502050701118089062003010808080A0004020E0E1181411175060001118089020F07070E02113D0212808D128091125D040001020E0400010E0E2E07180E12809512809912809D020202021D0E081D0E02021D051280A10202081280A5128099021280A112809D125D060001011280D50600010111814D04000101020600011280E10E0620011D0E1D03052000128155052002010E0E05000012815D0520011D050E042001010A0520001280A1072003011D05080805200012816106000112815D0E092002011280A112815D062001011280A10520001181650600030E0E1C1C080002113D113D113D0C0705020812808D128091125D0E07070E02080212808D128091125D050002010E0E2207111D021D1280A91280AD12450A1280B11280B508081C02021280B90E125D0E1161072001011D1280A9062001011280AD0520001280B10320001C0420011C0805200201081C1007061D1280A908081280BD021D1280A90520001281710620011280BD081E070F0E1280C10E151169011218121802124D125512590E08020E125D11610520001280C1092003010E12491280C10520001281790720021281050E1C2707130E0E1D02151241010E1D1280A91D1280A9081280A9021180C5020A0205124D0E125D0E116105151241010E0520001180C50520010213000320000A0520020E0E0E03200005062002010E12492D0712151241010E0E124D1251021280C1151169010E0E1280B11280B5124D151169010E0E1280B9125D0E11610E05151169010E0520020E08080420011C0E0406128185040701125D0F07080E0202124D1280D10E1255125D05200011818D0520010112651307071280A91280CD0E1180C91180C9021280A90520001280CD0800011180C91280CD072002010E1180C5082003010E1180C50A1907131280A902020202020202020202020202020202021280A9021D050800011280CD118195021D03020605092004010E1180C50505170709080808151169011214121415116901126D126D02080615116901126D0D0705080815116901126D126D022F07260E0E0E0E0E116111711280E5020208020202020202020202020202021280E90E0E020E02020202020202125D020420010102062001011280E50520001281D105200012809D040001010E0307010E040702020E8082074D12651265020E1280F11280F51280F9126502021280B11280B51280B90E021280FD0E080802125D0E02020E1280F11280F51280F9126502021280B11280B50E021280FD0E0802125D0E020212810112490202128105124D125102126502021280B11280B50E020202020E12550E021281090E125D0E0212790E127D0E125D0E02072002010E1280F10520001280F9062001011281D90520001281DD0620011281E108062001011181E5042000124D0A20031281050E1180C508062001011181ED0607021280BD020600011280CD0E062001011280CD042001011C062001011280BD08070115124101126D03070108090701151280ED01126504070111710307010208B77A5C561934E08980A0002400000480000094000000060200000024000052534131000400000100010001657C118060430AB20024C1B3584340A220EFEA08E174BB5B1DD6FFD420C6DE75EEC407A4619A2307DBB4A72E6D94155655F36B65DB8349E417995A1CBD0BB6CAB5FD4EAE45EB0194B9E1ECFC0B35BBC09E2D05B2D22A82E685AA20EE337A123EF65D808E43224584CB39648C0DCC03279FCF2586C260087D1E600E0BAAA5B10A4D005300530051004C000A4D007900530051004C001450006F0073007400670072006500530051004C000E73007500630063006500730073000C6600610069006C0065006400010102060E030612180806151280ED011265020608070615124101126D030611710206020A000408113D10113D08020F0009080E113D0E0E0E0E0E0E10113D070002080E10113D060002080E113D0500010E12650B00021D1280A91265101D020B00020E15124101121812490800030E0E12651249070001125D1180C9070001125D1280CD0A00050E12650E0E1249020A00021280A91280BD10020C00031280A90E1280BD1280CD09000108151241011214050001011214062002010E12180C2002011218151280ED01126508200015124101126D0920010115124101126D092000151280ED0112650A200101151280ED01126504200011710520010111710D2004021280D91280DD1280E10808280015124101126D03280008092800151280ED0112650328000E0428001171032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001201000D4442204175746F6D6174696F6E00000501000000001101000C3357204C6F6E67204461746100001201000D64625F6175746F6D6174696F6E00000C010007312E302E302E3000000401000000240100020054020F497344657465726D696E6973746963015402094973507265636973650100C0E7AD8023956BABED1A8C1D5BA09F509524CF00B9F1CFF2FF6A8224CBB9D15FB16CD8C0FCA75BDEC7D364FA785066F56FA9329ED54AB8060727FC2C574E49FE1F97896ADBB76EED7A99B5E3EEA10397D6F08162C5D74891D8B6A1B12B0067494A8409A005DF0E109A9139BFC9AF30E5AFBE0416162024B4FDCD5CCAEFD97114000000009A54C76800000000020000001C010000E8B40000E8960000525344534B6AA80F8ECA6E4FB33DE3B912400B1401000000433A5C6277616E675C64625F6175746F6D6174696F6E5C64625F6175746F6D6174696F6E5C6F626A5C44656275675C64625F6175746F6D6174696F6E2E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002CB60000000000000000000046B6000000200000000000000000000000000000000000000000000038B60000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058C000004C03000000000000000000004C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004AC020000010053007400720069006E006700460069006C00650049006E0066006F0000008802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003A000D00010043006F006D00700061006E0079004E0061006D006500000000003300570020004C006F006E006700200044006100740061000000000044000E000100460069006C0065004400650073006300720069007000740069006F006E00000000004400420020004100750074006F006D006100740069006F006E000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000044001200010049006E007400650072006E0061006C004E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003E000D0001004C006500670061006C0043006F00700079007200690067006800740000003300570020004C006F006E00670020004400610074006100000000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004C00120001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003C000E000100500072006F0064007500630074004E0061006D00650000000000640062005F006100750074006F006D006100740069006F006E000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000C000000583600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
select @hash=hash from sys.trusted_assemblies where description=@clrname
if @@ROWCOUNT>0
  EXEC sp_drop_trusted_assembly @hash

set @hash =HASHBYTES('SHA2_512',@asmbin)
EXEC sp_add_trusted_assembly @hash=@hash,@description=@clrname

go

CREATE ASSEMBLY [db_automation]
FROM 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103009A54C7680000000000000000E00022200B01300000980000000600000000000056B600000020000000C00000000000100020000000020000040000000000000006000000000000000000010000020000F19D010003006085000010000010000000001000001000000000000010000000000000000000000004B600004F00000000C00000A80300000000000000000000000000000000000000E000000C000000CCB400001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000005C960000002000000098000000020000000000000000000000000000200000602E72737263000000A803000000C0000000040000009A0000000000000000000000000000400000402E72656C6F6300000C00000000E0000000020000009E0000000000000000000000000000400000420000000000000000000000000000000038B60000000000004800000002000500906A0000BC490000090000000000000000000000000000004CB400008000000000000000000000000000000000000000000000000000000000000000000000001B300600B90E00000100001100037201000070280E00000A810F00000172110000700A72110000700B730F00000A0C731000000A0D281100000A1304731200000A1305731300000A13067213000070731400000A130511056F1500000A0072490000700A110611056F1600000A001106066F1700000A0005130711072C0C00110411066F1800000A0000000011066F1900000A13093804030000007355000006130A110A1109110972A00100706F1A00000A6F1B00000A6F3800000600110A1109110972AE0100706F1A00000A6F1C00000A6F3400000600110A1109110972BE0100706F1A00000A6F1C00000A6F3600000600110A1109110972CE0100706F1A00000A6F1D00000A6F4600000600110A1109110972E40100706F1A00000A6F1D00000A6F4000000600110A1109110972F80100706F1A00000A6F1D00000A6F4800000600110A1109110972060200706F1A00000A6F1D00000A6F4200000600110A1109110972140200706F1A00000A6F1D00000A6F4E00000600110A11091109721E0200706F1A00000A6F1D00000A6F4A00000600110A1109110972360200706F1A00000A6F1D00000A6F4400000600110A11091109724A0200706F1A00000A6F1D00000A6F4C00000600110A11091109725C0200706F1A00000A6F1D00000A6F5200000600110A1109110972640200706F1A00000A6F1D00000A6F2C00000600110A1109110972800200706F1A00000A6F1D00000A6F3000000600110A1109110972920200706F1A00000A6F1D00000A6F2E00000600110A1109110972A60200706F1A00000A6F1D00000A6F5000000600110A1109110972CC0200706F1A00000A6F1D00000A6F3E00000600110A1109110972EE0200706F1A00000A6F1E00000A6F5400000600110A72FA0200706F3A00000600110A72110000706F3C0000060009110A6F1F00000A00110A6F2F0000067211000070282000000A130B110B2C6300732A00000625732100000A6F270000060025732200000A6F1D0000060013081108720A0300706F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00002B7807110A6F3D000006282000000A130C110C2C6500732A00000625732100000A6F270000060025732200000A6F1D000006001308110A6F3D0000060B1108076F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00000011096F2400000A130D110D3AECFCFFFF11096F2500000A0000DDC3000000130E00110E6F2600000A130F110E6F2700000A13101613112B1D1110110F11116F2800000A6F2900000A282A00000A13101111175813111111110F6F2B00000A1759FE0216FE01131211122DCD0372120300701110282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A002038FFFFFF1313DD820A000013140003722803007011146F2700000A282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A0020D4FEFFFF1313DD430A00000000161315096F2D00000A1316282E00000A131700086F2F00000A131A2B7D121A283000000A131B0000096F3100000A131C2B4D121C283200000A131D00111D6F3D000006111B6F28000006283300000A2D13111B6F28000006720A030070283300000A2B0117131E111E2C1300111B111B6F1E00000617586F1F000006000000121C283400000A2DAADE0F121CFE160600001B6F3500000A00DC00121A283600000A3A77FFFFFFDE0F121AFE160500001B6F3500000A00DC384A0400000016131500086F2F00000A131F380F040000121F283000000A13200011206F1E00000616FE021321112139F10300000000096F3100000A132238BC0300001222283200000A13230011206F28000006720A030070283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132411243998010000000F00FE160F0000016F2900000A1123731400000613251125FE0615000006733700000A733800000A1326112611236F3700000613271227FE161C0000016F2900000A6F3900000A0011266F3A00000A0011206F1C00000611266F3B00000A0011236F53000006132811282C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151F325D16FE01132911292C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01132A112A3992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A132B1104112B6F2C00000A0020B80B0000283D00000A00000038D701000011236F3D00000611206F28000006283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132E112E399301000000112311206F260000067319000006132F112FFE061A000006733700000A733800000A1330113011236F3700000613271227FE161C0000016F2900000A6F3900000A0011306F3A00000A0011206F1C00000611306F3B00000A0011236F53000006133111312C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151758131511151F325D16FE01133211322C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01133311333992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A1334110411346F2C00000A0020B80B0000283D00000A000000001222283400000A3A38FCFFFFDE0F1222FE160600001B6F3500000A00DC11202812000006000000121F283600000A3AE5FBFFFFDE0F121FFE160500001B6F3500000A00DC2010270000283D00000A0000111616FE02133511353AA8FBFFFF096F2D00000A17FE02133611362C4A00282E00000A132C122C727E030070283E00000A7210040070096F2D00000A132D122D283F00000A722A040070283C00000A1337110411376F2C00000A0020B80B0000283D00000A0000282E00000A131708281100000613182B74000828110000061318282E00000A1117284100000A13391239284200000A230000000000003440FE02133811382C3900282E00000A1317282E00000A132C122C727E030070283E00000A72620400701218283F00000A284300000A133A1104113A6F2C00000A000020E8030000283D00000A0000111816FE02133B113B2D811104282E00000A132C122C727E030070283E00000A728C040070282A00000A6F2C00000A001104284400000A6F2C00000A00734500000A131900086F2F00000A133C38E3010000123C283000000A133D0038BB01000000113D6F26000006123E6F4600000A133F113F394D01000000113E6F4700000A6F4800000A16FE0213401140393101000000113D6F2800000672C40400706F4900000A1341114139910000000003113D6F28000006113E1105280A000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134211422C0A001FF61313DD5C03000003113D6F28000006113E1105280B000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134311432C0A001FF61313DD1703000000388400000000001119113E176F4C00000A0000DE73134400031B8D470000012516282E00000A132C122C727E030070283E00000AA2251772C8040070A22518113D6F28000006A2251972D0040070A2251A11446F2700000AA2284000000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DD8E0200000000002B550003282E00000A132C122C727E030070283E00000A72C8040070113D6F2800000672FA040070283C00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FFB1313DD3402000000113D6F260000066F4D00000A16FE02134511453A2DFEFFFF00123C283600000A3A11FEFFFFDE0F123CFE160500001B6F3500000A00DC11196F4700000A6F4800000A16FE02134611462C14000311192807000006280E00000A810F00000100030911052809000006280E00000A810F0000011104282E00000A132C122C727E030070283E00000A724C050070282A00000A6F2C00000A001104282E00000A132C122C727E030070283E00000A727C05007003FE160F0000016F2900000A284300000A6F2C00000A0011066F4E00000A0011056F4F00000A0011056F4E00000A0003FE160F0000016F2900000A7201000070282000000A134711472C0900151313DD2E010000037201000070280E00000A810F000001161313DD1601000013480003728405007011486F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FEC1313DDD70000001349000372A405007011496F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE71313DD98000000134A000372D6050070114A6F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DE5C134B00114B6F2700000A134C114C72F40500706F5000000A16FE01134D114D2C3500037246060070114C282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FCE1313DE061FC91313DE0011132A00000041240100000000007F00000031030000B00300008400000015000001000000007F00000031030000340400003F0000001700000102000000A50400005A000000FF0400000F0000000000000002000000900400008D0000001D0500000F00000000000000020000006A050000CF030000390900000F00000000000000020000003E05000022040000600900000F0000000000000000000000A60B00000F000000B50B0000730000001700000102000000B40A0000F6010000AA0C00000F0000000000000000000000740400002C090000A00D00003F0000001500000100000000740400002C090000DF0D00003F0000001E00000100000000740400002C0900001E0E00003C0000001F00000100000000740400002C0900005A0E00005C00000017000001133006002800000002000011000F00285100000A0F01285100000A1716161F1E735200000A285300000A285400000A0A2B00062A1B30020009010000030000110072110000700A0002285500000A0B072C2400725E0600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDD100000002285600000A16FE010D092C240072B20600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDA000000002285700000A0A06280E00000A0CDD8D00000013040072E206007011046F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE5E130500723407007011056F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE2F130600727607007011066F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE00082A0000000128000000000700737A002F230000010000070073A9002F240000010000070073D8002F170000011B300500E302000004000011000E087211000070280E00000A810F0000010F01FE160F0000016F2900000A0A007357000006285800000A0020000C0000285900000A0017285A00000A0002285B00000A74250000010B07056F5C00000A000E04285500000A16FE01130411042C0B00070E046F5D00000A00000E07285500000A16FE01130511052C0B00070E076F5E00000A00000E06285500000A16FE01130611062C0B00070E066F5F00000A00000720307500006F6000000A0004285500000A16FE01130711072C5B0004178D5400000125161F3B9D6F6100000A13081613092B3300110811099A178D5400000125161F3D9D6F6100000A130A076F6200000A110A169A110A179A6F6300000A0000110917581309110911088E69FE04130B110B2DBF000572A8070070283300000A130C110C2C4300286400000A066F6500000A130D07110D8E696A6F6600000A00076F6700000A130E00110E110D16110D8E696F6800000A0000DE0D110E2C08110E6F3500000A00DC00076F6900000A74260000010C0E05285500000A16FE01130F110F2C1700086F6A00000A0E05286B00000A736C00000A0D002B0E00086F6A00000A736D00000A0D00086F6E00000A20C80000002E12086F6E00000A20C9000000FE0116FE012B0116131011102C31000E0872B2070070086F6E00000A8C59000001096F6F00000A287000000A280E00000A810F0000011FCE1311DDDB0000000E080E08710F000001096F6F00000A280E00000A287100000A810F000001161311DDB500000013120011126F7200000A75260000011313111314FE03131411142C5F0011136F6A00000A13151115736D00000A1316000E0872B207007011136F6E00000A8C5900000111166F6F00000A287000000A280E00000A810F00000100DE0D11162C0811166F3500000A00DCDE0D11152C0811156F3500000A00DC002B15000E0811126F2700000A280E00000A810F000001001F9C1311DE1F1317000E0811176F2700000A280E00000A810F0000012038FFFFFF1311DE0011112A00417C0000020000004C010000130000005F0100000D00000000000000020000005A0200002D000000870200000D00000000000000020000005102000045000000960200000D0000000000000000000000200000000B0200002B020000960000002900000100000000200000000B020000C10200001F000000170000011B3003000901000005000011000002285500000A0A062C30000372EE070070280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9C0BDDCB0000000302285700000A280E00000A810F000001160BDDB30000000C00037240080070086F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9B0BDE7A0D00037286080070096F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002037FFFFFF0BDE3E1304000372BC08007011046F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002036FFFFFF0BDE00072A0000000128000000000100535400392300000100000100538D003C240000010000010053C9003E170000011B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011B300300410100000700001100140A02120028080000060B07737500000A0C281100000A0D09086F7600000A00166A13040000026F4700000A6F7700000A13052B7711056F7800000A742D000001130600161307086F7900000A175913082B3A00110611076F7A00000A130911092D06061107912B0116130A110A2C0B0011096F2900000A13090008110711096F7B00000A000011071758130711071108FE0216FE01130B110B2DB71104176A58130409086F7C00000A000011056F7D00000A2D80DE161105752E000001130C110C2C08110C6F3500000A00DC096F7E00000A000972260900701204287F00000A282A00000A6F2C00000A007201000070130DDE48130E00096F7E00000A00282E00000A13101210727E030070283E00000A7240090070110E6F2700000A284300000A130F281100000A110F6F2900000A6F2C00000A00110F130DDE00110D2A000000011C00000200340084B800160000000000002500D1F6004817000001133005006F0000000800001100026F8000000A6F4800000A8D2A0000010A03026F8000000A6F4800000A8D5D00000151160B026F8000000A6F4800000A17590C2B2400026F8000000A076F8100000A0D0607090350078F5D000001280F000006A2000717580B0708FE0216FE01130411042DCF0613052B0011052A001B3005001B020000090000110072010000700A036F8200000A0B000072780900700C00026F3100000A0D380F0100001203283200000A13040011046F390000067201000070282000000A130511052C5C00281100000A1B8D47000001251611046F45000006A2251772910A0070A2251811046F47000006A2251972950A0070A2251A11046F3B000006A2284000000A6F2C00000A00281100000A284400000A6F2C00000A0072AF0A00700A00080307738300000A13060011066F8400000A72BD0A007011046F2B0000066F8500000A2611066F8400000A72DB0A007011046F3B0000066F8500000A2611066F8400000A72F70A007011046F310000068C4A0000016F8500000A2611066F8400000A72150B007011046F370000068C1C0000016F8500000A2611066F8600000A2600DE0D11062C0811066F3500000A00DC001203283400000A3AE5FEFFFFDE0F1203FE160600001B6F3500000A00DC076F8700000A0000DDA900000013070011076F2600000A130811076F2700000A130916130A2B1D11091108110A6F2800000A6F2900000A282A00000A1309110A1758130A110A11086F2B00000A1759FE0216FE01130B110B2DCD72120300701109282A00000A0A281100000A066F2C00000A0006130CDE51130D00076F8800000A00282E00000A130E120E727E030070283E00000A72250B0070110D6F2700000A284300000A0A281100000A066F2C00000A0000DE0000DE0B072C07076F3500000A00DC06130C2B00110C2A00417C000002000000AA0000007A000000240100000D00000000000000020000001E00000022010000400100000F00000000000000000000000F0000004D0100005C0100006B00000015000001000000000F0000004D010000C70100003E00000017000001020000000E000000FA010000080200000B000000000000001B300400340300000A0000110072110000700A72110000700B140C738900000A25724F0B00706F8A00000A002572570B00706F8A00000A002572650B00706F8A00000A0025726D0B00706F8A00000A0025727F0B00706F8A00000A0025728B0B00706F8A00000A0025729D0B00706F8A00000A002572AD0B00706F8A00000A002572CF0B00706F8A00000A002572DB0B00706F8A00000A002572E50B00706F8A00000A0025726D0B00706F8A00000A002572FD0B00706F8A00000A000D0003120228080000061304001104130516130638F6010000110511069A1307001E8D47000001251606A22517720D0C0070A2251802A22519723D0C0070A2251A11076F8B00000AA2251B72470C0070A2251C02A2251D727B0C0070A2284000000A0A0911076F8C00000A13091209FE16310000016F2900000A6F8D00000A1308110839960000000011076F8C00000A13091209FE16310000016F2900000A72FD0B0070283300000A130A110A2C1C000672890C007011076F8B00000A728D0C0070283C00000A0A002B4D001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B72B10C0070A2284000000A0A000038EA0000000072B50C007011076F8E00000A130B120B287F00000A72BB0C007072C10C00706F8F00000A72C90C0070284300000A0B11076F8C00000A13091209FE16310000016F2900000A72CF0C0070283300000A130C110C2C4C001B8D47000001251672B50C0070A2251711076F9000000A130D120D289100000AA2251872DF0C0070A2251911076F9200000A130D120D289100000AA2251A72C90C0070A2284000000A0B001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B07A2284000000A0A0000110617581306110611058E693FFFFDFFFF0604739300000A130E00110E6F8600000A2600DE0D110E2C08110E6F3500000A00DC7201000070130FDE3C131000282E00000A13121212727E030070283E00000A72E30C007011106F2700000A284300000A1311281100000A11116F2C00000A001111130FDE00110F2A4134000002000000D30200000C000000DF0200000D0000000000000000000000B100000044020000F50200003C000000170000011B3005002D0200000B00001100738900000A0A72190D00700272AA0D0070284300000A0B0704739300000A0C086F1900000A0D2B1A0006090972D60D00706F1A00000A6F1D00000A6F8A00000A0000096F2400000A130411042DDA096F2500000A00086F4E00000A00046F8200000A1305000072E00D00700272FC0D0070284300000A0B00066F9400000A13062B1E1206289500000A1307000772120E0070110772DF0C0070283C00000A0B001206289600000A2DD9DE0F1206FE160800001B6F3500000A00DC0716076F9700000A17596F9800000A72160E0070282A00000A0B00036F4700000A6F7700000A1308388F00000011086F7800000A742D00000113090007041105738300000A130A0000066F9400000A130B2B36120B289500000A130C00110A6F8400000A72120E0070110C282A00000A1109110C6F9900000A252D06267E9A00000A6F8500000A2600120B289600000A2DC1DE0F120BFE160800001B6F3500000A00DC110A6F8600000A2600DE0D110A2C08110A6F3500000A00DC0011086F7D00000A3A65FFFFFFDE161108752E000001130D110D2C08110D6F3500000A00DC11056F8700000A0000DE6B130E0011056F8800000A001B8D470000012516282E00000A13101210727E030070283E00000AA22517721A0E0070A2251802A2251972300E0070A2251A110E6F2700000AA2284000000A130F281100000A110F6F2C00000A00281100000A076F2C00000A00110F1311DE1900DE0D11052C0811056F3500000A00DC720100007013112B0011112A0000004194000002000000810000002B000000AC0000000F00000000000000020000000C010000430000004F0100000F00000000000000020000000201000067000000690100000D0000000000000002000000E3000000A2000000850100001600000000000000000000006600000040010000A60100006B000000170000010200000065000000AF010000140200000D0000000000000013300200220000000C0000110072400E00700F00FE16320000016F2900000A282A00000A739B00000A0A2B00062A0000133002001B0000000C00001100725E0E0070026F2900000A282A00000A739B00000A0A2B00062A001B300400F00000000D0000110000727C0E00700A0E040B072C6300056F9C00000A16FE010C082C07056F1500000A000305739300000A0D00096F8600000A2600DE0B092C07096F3500000A00DC05739D00000A1304001104046F9E00000A001104026F9F00000A0000DE0D11042C0811046F3500000A00DC061305DE7C00729A0E007073A000000A7A1306001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911066F2700000AA2251A72260F0070A2284000000A1305DE381307001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911076F2700000AA2251A72260F0070A2284000000A1305DE0011052A0134000002002B000B36000B0000000002004900165F000D00000000000001007C7D003815000001000001007CB5003817000001133003007B0100000E00001100031652140A026FA100000A0B026FA200000A0C0728A300000A130411040D09451300000066000000CF00000041000000050000002200000093000000130000006E000000B50000007D000000BD00000088000000C60000009B000000570000004900000033000000FA000000A700000038F500000000081873A400000A0A38EF00000000081F1473A400000A0A38E000000000081F0C176A73A500000A0A38CF00000000081A73A400000A0A38C10000000018280C0000067A00081B73A400000A0A38AB00000000081F0973A400000A0A389C0000000016280C0000067A00081F1073A400000A0A388500000000081E73A400000A0A2B7A00081673A400000A0A2B6F001B280C0000067A00081F0D73A400000A0A2B5B00081F0C156A73A500000A0A2B4D001E280C0000067A001F0A280C0000067A001F0C280C0000067A0008020728100000060A0614FE01130511052C1500081F0C026FA600000A6A73A500000A0A031752002B080007280D0000067A0613062B0011062A0013300400850200000F00001100140A04D00900001B28A700000A2E2904D06600000128A700000A2E1C04D00A00001B28A700000A2E0F04D06700000128A700000AFE012B01170B072C1700021F15036FA600000A6A73A500000A0A00382802000004D00F00000128A700000AFE010C082C1200021F0C156A73A500000A0A00380502000004D06800000128A700000AFE010D092C1200021F15156A73A500000A0A0038E201000004D01C00000128A700000AFE01130411042C1000021F0E73A400000A0A0038BF01000004D00D00000128A700000AFE01130511052C1000021F1773A400000A0A00389C01000004D02200000128A700000AFE01130611062C0F00021873A400000A0A00387A01000004D06900000128A700000AFE01130711072C1000021F1473A400000A0A00385701000004D06A00000128A700000AFE01130811082C0F00021A73A400000A0A00383501000004D06B00000128A700000AFE01130911092C0F00021C73A400000A0A00381301000004D06C00000128A700000AFE01130A110A2C1000021F0E73A400000A0A0038F000000004D06D00000128A700000AFE01130B110B2C1000021F1073A400000A0A0038CD00000004D06E00000128A700000AFE01130C110C2C0F00021E73A400000A0A0038AB00000004D06F00000128A700000AFE01130D110D2C0F00021673A400000A0A00388900000004D07000000128A700000AFE01130E110E2C0D00021F0973A400000A0A002B6904D07100000128A700000AFE01130F110F2C1200021B7EA800000A1673A900000A0A002B4404D07200000128A700000AFE01131011102C0D00021F0D73A400000A0A002B2404D07300000128A700000AFE01131111112C0D00021F1973A400000A0A002B0400140A000613122B0011122A0000001B300200A90000001000001100160A160B160C00026F2F00000A0D2B761203283000000A130400160A160B0011046F1C0000066FAA00000A13052B2A120528AB00000A13060011066FAC00000A130711072C0C000617580A0817580C002B06000717580B0000120528AD00000A2DCDDE0F1205FE160B00001B6F3500000A00DC1104066F23000006001104076F2100000600001203283600000A2D81DE0F1203FE160500001B6F3500000A00DC0813082B0011082A000000011C000002002E003765000F0000000002000F008392000F000000001B300200630000001100001100160A160B00026F1C0000066FAA00000A0C2B24120228AB00000A0D00096FAC00000A130411042C08000617580A002B06000717580B0000120228AD00000A2DD3DE0F1202FE160B00001B6F3500000A00DC02066F230000060002076F21000006002A0001100000020012003143000F00000000220228AE00000A002A8A0272110000707D0B0000040228AE00000A000002047D0C00000402037D0B0000042A1B300600670A0000120000110072110000700A72110000700B1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72580F0070A2284000000A0C1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72620F0070A2284000000A0D1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B726C0F0070A2284000000A130400027B0C00000472110000706F3C00000600027B0C00000472110000706F2C00000600027B0C0000046F2F00000672760F0070283300000A1308110839AC02000000027B0C0000046F4900000672860F0070283300000A1309110939FD0000000072920F00700A1C8D47000001251672A80F0070A22517027B0C0000046F3F000006A2251872DF0C0070A22519027B0C0000046F4D000006A2251A72C20F0070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A2251772CA0F0070A22518027B0C0000046F35000006130A120A283F00000AA2251972D20F0070A2251A08A2284000000A0B027B0C0000046F51000006285500000A130B110B2C10000772DA0F0070282A00000A0B002B46001C8D47000001251607A2251772E20F0070A22518027B0C0000046F4B000006A2251972EA0F0070A2251A027B0C0000046F51000006A2251B72F40F0070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A130C110C39920000000072041000700A1C8D4700000125167218100070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A22517723A100070A22518027B0C0000046F4B000006A225197244100070A2251A027B0C0000046F51000006A2284000000A0B00027B0C0000046F49000006724C100070283300000A130D110D2C720072621000700A1C8D4700000125167274100070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B000772A0100070027B0C0000046F2D000006284300000A0B08027B0C0000046F41000006280E00000A281700000616FE03130E110E2C1700027B0C00000472AF0A00706F3A00000600DD240600000038D3030000027B0C0000046F2F00000672A4100070283300000A130F110F399B03000000027B0C0000046F4900000672860F0070283300000A13101110396C0100000072B61000700A72A0100070027B0C0000046F410000062816000006282A00000A0B027B0C0000046F2D000006285500000A131111112C5400027B0C0000046F2B0000067211000070282000000A131211122C20000772C6100070027B0C0000046F2B00000672DC100070283C00000A0B002B15000772C6100070110472DC100070283C00000A0B00002B140007027B0C0000046F2D000006282A00000A0B001F098D47000001251607A2251772E6100070A22518027B0C0000046F3F000006A2251972DF0C0070A2251A027B0C0000046F4D000006A2251B728C100070A2251C027B0C0000046F47000006A2251D72F0100070A2251E09A2284000000A0B027B0C0000046F51000006285500000A131311132C10000772FA100070282A00000A0B002B46001C8D47000001251607A225177202110070A22518027B0C0000046F4B000006A22519720C110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A1314111439F600000000721A1100700A1C8D4700000125167236110070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1C8D47000001251607A22517723E110070A22518027B0C0000046F4B000006A225197246110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B027B0C0000046F2B0000067211000070282000000A131511152C1B00077250110070027B0C0000046F2B000006284300000A0B002B0F0007725011007008284300000A0B000772A0100070027B0C0000046F2D000006284300000A0B00027B0C0000046F49000006724C100070283300000A1316111639C40000000072721100700A1C8D470000012516728A110070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B07729411007008284300000A0B027B0C0000046F2B0000067211000070282000000A131711172C1B00077294110070027B0C0000046F2B000006284300000A0B002B0F0007729411007008284300000A0B00000772A0100070027B0C0000046F2D000006284300000A0B002B1A00027B0C0000046F410000060A027B0C0000046F2D0000060B0073AF00000A25066FB000000A0025076FB100000A0025176FB200000A0025176FB300000A0025176FB400000A0025166FB500000A0025176FB600000A00130773B700000A131800111811076FB800000A0011186FB900000A26027B0C0000046F4900000672860F0070282000000A2C17027B0C0000046F2F000006729E110070282000000A2B0116131B111B2C260008285700000A131C11186FBA00000A111C6FBB00000A0011186FBA00000A6FBC00000A000011186FBD00000A6F6F00000A131911186FBE00000A6F6F00000A131A11186FBF00000A0011186FC000000A16FE01131D111D2C6400027B0C00000472010000706F3A00000600027B0C0000046F2B000006285500000A131E111E2C36001104285600000A131F111F2C1700027B0C0000041104285700000A6F2C00000600002B1000027B0C00000411196F2C00000600000000388000000000111A285500000A132011202C3B0009285600000A132111212C2B00027B0C000004027B0C0000046F3B00000609285700000A282A00000A6F3C000006000928C100000A0000002B1000027B0C000004111A6F3C0000060000027B0C0000046F3B000006285500000A132211222C1000027B0C00000411196F3C00000600000008285600000A132311232C09000828C100000A000000DE0D11182C0811186F3500000A00DC00DE19132400027B0C00000411246F2700000A6F3C0000060000DE00027B0C0000046F3B000006285500000A132511252C1500027B0C00000472010000706F3A00000600002B1300027B0C00000472AF0A00706F3A00000600002A004134000002000000610800009E010000FF0900000D00000000000000000000005B010000B40800000F0A000019000000170000011330040043000000130000110072F40F00700272AC11007072110000706F8F00000A72B011007072110000706F8F00000A72F40F007072B41100706F8F00000A72F40F0070284300000A0A2B00062A001B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011330040037000000140000110002285500000A0A062C0872BA1100700B2B2272F40F00700272F40F007072B41100706F8F00000A72F40F0070284300000A0B2B00072A001330020047000000000000000228AE00000A000002037D1300000402036F470000067D1400000402036F490000067D1500000402036F410000067D1600000402047D1800000402036F350000067D170000042A001B3006006B0D0000150000110002027B130000046F410000067D16000004027B13000004166F3200000600027B1300000472110000706F3C0000060002027B130000046F490000067D15000004734500000A0A734500000A0B027B15000004724C100070283300000A0C0839BD030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A7216120070A2251F0B027B130000046F51000006A2251F0C72B10C0070A2251F0D027B130000046F4F000006A2284000000A0D0973C200000A1304000011046F1500000A00027B16000004110473C300000A1305001105027B170000046FC400000A0011056FC500000A1306381201000000734500000A1307110711066FC600000A00110714FE031308110839C50000000011076F8000000A72221200706FC700000A130911092C7A000011076F4700000A6F7700000A130A2B44110A6F7800000A742D000001130B00027B13000004027B130000046F3B000006110B72221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000110A6F7D00000A2DB3DE16110A752E000001130C110C2C08110C6F3500000A00DC002B3000071107176F4C00000A00027B13000004027B130000046F3100000611076F4700000A6F4800000A586F320000060000002B2C00723C120070130D027B13000004027B130000046F3B000006110D284400000A284300000A6F3C00000600000011066FC800000A16FE01130E110E3ADBFEFFFF00DE0D11052C0811056F3500000A00DC00DD46010000130F007260120070131016131138B9000000001F0C8D4700000125161110A22517727E120070A225181211283F00000AA22519728E120070A2251A110F6FC900000A11116FCA00000A6FCB00000AA2251B72A4120070A2251C110F6FC900000A11116FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E110F6FC900000A11116FCA00000A6FCD00000AA2251F0972D6120070A2251F0A110F6FC900000A11116FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A1310001111175813111111110F6FC900000A6FCF00000AFE04131311133A2EFFFFFF027B13000004027B130000046F3B0000061110284400000A284300000A6F3C0000060000DE3C13140072E412007011146F2700000A282A00000A1315027B13000004027B130000046F3B0000061115284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02131611162C17000207281B00000600027B18000004076FD000000A000011046F4F00000A0011046F4E00000A0000DC00DE0D11042C0811046F3500000A00DC00027B1500000472F80F0070283300000A1317111739CE030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A72FE120070A2251F0B027B130000046F51000006720C13007072101300706F8F00000AA2251F0C7216130070A2251F0D027B130000046F4F000006A2284000000A1318111873C200000A1319000011196F1500000A00027B16000004111973C300000A131A00111A027B170000046FC400000A00111A6FC500000A131B381201000000734500000A131C111C111B6FC600000A00111C14FE03131D111D39C500000000111C6F8000000A72221200706FC700000A131E111E2C7A0000111C6F4700000A6F7700000A131F2B44111F6F7800000A742D000001132000027B13000004027B130000046F3B000006112072221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000111F6F7D00000A2DB3DE16111F752E000001130C110C2C08110C6F3500000A00DC002B300007111C176F4C00000A00027B13000004027B130000046F31000006111C6F4700000A6F4800000A586F320000060000002B2C00723C1200701321027B13000004027B130000046F3B0000061121284400000A284300000A6F3C000006000000111B6FC800000A16FE01132211223ADBFEFFFF00DE0D111A2C08111A6F3500000A00DC00DD460100001323007260120070132416132538B9000000001F0C8D4700000125161124A22517727E120070A225181225283F00000AA22519728E120070A2251A11236FC900000A11256FCA00000A6FCB00000AA2251B72A4120070A2251C11236FC900000A11256FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E11236FC900000A11256FCA00000A6FCD00000AA2251F0972D6120070A2251F0A11236FC900000A11256FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A132400112517581325112511236FC900000A6FCF00000AFE04132611263A2EFFFFFF027B13000004027B130000046F3B0000061124284400000A284300000A6F3C0000060000DE3C13270072E412007011276F2700000A282A00000A1328027B13000004027B130000046F3B0000061128284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02132911292C17000207281B00000600027B18000004076FD000000A000011196F4F00000A0011196F4E00000A0000DC00DE0D11192C0811196F3500000A00DC00027B1500000472860F0070283300000A132A112A390B05000000001873D100000A132B00731200000A132C027B130000046F51000006285500000A132D112D2C71001E8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C725A130070A2251D027B130000046F4F000006A2284000000A731400000A132C00389C000000001F0C8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C72C2130070A2251D027B130000046F4B000006A2251E7208140070A2251F09027B130000046F51000006A2251F0A7220140070A2251F0B027B130000046F4F000006A2284000000A731400000A132C000000112C6F1500000A0016132E14132F112C6FD200000A13301130027B160000046F1700000A001130027B170000046FC400000A00027B1600000472261400706F4900000A133211322C280017132E11306F8400000A724E1400701F1620C80000006FD300000A132F112F186FD400000A000011306F1900000A1331380701000000734500000A1333113311316FC600000A00113314FE031334113439C50000000011336F8000000A726A1400706FC700000A133511352C7A000011336F4700000A6F7700000A13362B4411366F7800000A742D000001133700027B13000004027B130000046F3B0000061137726A1400706F9900000A252D0426142B056F2900000A282A00000A6F3C000006000011366F7D00000A2DB3DE161136752E000001130C110C2C08110C6F3500000A00DC002B3000071133176F4C00000A00027B13000004027B130000046F3100000611336F4700000A6F4800000A586F320000060000002B2100723C1200701338027B130000041138284400000A282A00000A6F3C00000600000011316FC800000A16FE01133911393AE6FEFFFF112E133A113A2C6A00112F6FD500000A756100000114FE0316FE01133B113B2C5000112F6FD500000A7447000001728E140070282000000A133C113C2C32007292140070112F6FD500000A7447000001282A00000A133D027B13000004113D284400000A282A00000A6F3C0000060000000000DDB8000000133E007211000070133F113E6FD600000A1FFEFE01134011402C0B0072B4140070133F002B150072EC140070113E6F2700000A282A00000A133F00027B13000004113F284400000A282A00000A6F3C0000060000DE62134100720815007011416F2700000A282A00000A1342027B130000041142284400000A282A00000A6F3C0000060000DE31134300723E15007011436F2700000A282A00000A1344027B130000041144284400000A282A00000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02134511452C17000207281B00000600027B18000004076FD000000A0000112C6F4F00000A00112C6F4E00000A0000DC00DE0D112B2C08112B6F3500000A00DC00DDB4000000134600725415007011466F2700000A282A00000A1347027B13000004027B130000046F3B0000061147284400000A284300000A6F3C0000060000DE78134800728E15007011486F2700000A282A00000A1349027B13000004027B130000046F3B0000061149284400000A284300000A6F3C0000060000DE3C134A0072BA150070114A6F2700000A282A00000A134B027B13000004027B130000046F3B000006114B284400000A284300000A6F3C0000060000DE0000027B130000046F3B000006285500000A134C114C2C1500027B1300000472010000706F3A00000600002B1300027B1300000472AF0A00706F3A00000600002A0041FC0100020000009701000051000000E80100001600000000000000020000003201000045010000770200000D00000000000000000000001A010000700100008A0200000A0100003F000001000000001A01000070010000940300003C00000017000001020000001A010000B8020000D20300003E000000000000000200000019010000FA020000130400000D00000000000000020000007E05000051000000CF05000016000000000000000200000019050000450100005E0600000D00000000000000000000000105000070010000710600000A0100003F0000010000000001050000700100007B0700003C000000170000010200000001050000B8020000B90700003E000000000000000200000000050000FA020000FA0700000D00000000000000020000001F0A000051000000700A00001600000000000000000000005709000012020000690B00005600000015000001000000005709000012020000BF0B00003100000042000001000000005709000012020000F00B000031000000170000010200000057090000CC020000230C00003E00000000000000020000002B08000039040000640C00000D00000000000000000000002208000055040000770C00003C0000001E000001000000002208000055040000B30C00003C0000001F000001000000002208000055040000EF0C00003C0000001700000113300200730000001600001100036F8000000A72A00100706FC700000A16FE010B072C5A0072A001007073D700000A0A0672D015007028D800000A6FD900000A0006176FDA00000A0006027B130000046F370000068C1C0000016FDB00000A0006166FDC00000A00036F8000000A066FDD00000A0006166FDE00000A00002A00133001000C0000001700001100027B1F0000040A2B00062A260002037D1F0000042A0000133001000C0000001800001100027B1C0000040A2B00062A260002037D1C0000042A0000133001000C0000001800001100027B1B0000040A2B00062A260002037D1B0000042A0000133001000C0000001800001100027B1A0000040A2B00062A260002037D1A0000042A0000133001000C0000001800001100027B190000040A2B00062A260002037D190000042A0000133001000C0000001900001100027B1E0000040A2B00062A260002037D1E0000042A0000133001000C0000001300001100027B1D0000040A2B00062A260002037D1D0000042A0000133001000C0000001300001100027B310000040A2B00062A260002037D310000042A0000133001000C0000001300001100027B2C0000040A2B00062A260002037D2C0000042A0000133001000C0000001300001100027B2B0000040A2B00062A260002037D2B0000042A0000133001000C0000001800001100027B230000040A2B00062A260002037D230000042A0000133001000C0000001800001100027B210000040A2B00062A260002037D210000042A0000133001000C0000001800001100027B220000040A2B00062A260002037D220000042A0000133001000C0000001A00001100027B200000040A2B00062A260002037D200000042A0000133001000C0000001300001100027B2A0000040A2B00062A260002037D2A0000042A0000133001000C0000001300001100027B300000040A2B00062A260002037D300000042A0000133001000C0000001300001100027B330000040A2B00062A260002037D330000042A0000133001000C0000001300001100027B2D0000040A2B00062A260002037D2D0000042A0000133001000C0000001300001100027B2F0000040A2B00062A260002037D2F0000042A0000133001000C0000001300001100027B280000040A2B00062A260002037D280000042A0000133001000C0000001300001100027B240000040A2B00062A260002037D240000042A0000133001000C0000001300001100027B260000040A2B00062A260002037D260000042A0000133001000C0000001300001100027B270000040A2B00062A260002037D270000042A0000133001000C0000001300001100027B250000040A2B00062A260002037D250000042A0000133001000C0000001300001100027B320000040A2B00062A260002037D320000042A0000133001000C0000001300001100027B2E0000040A2B00062A260002037D2E0000042A0000133001000C0000001300001100027B290000040A2B00062A260002037D290000042A0000133001000C0000001B00001100027B340000040A2B00062A260002037D340000042A3E02167D340000040228AE00000A002A000013300100070000001B00001100170A2B00062A0042534A4201000100000000000C00000076342E302E33303331390000000005006C00000064140000237E0000D01400002C16000023537472696E677300000000FC2A0000E815000023555300E4400000100000002347554944000000F4400000C808000023426C6F620000000000000002000001571FA2090902000000FA013300160000010000007B0000000700000034000000570000005600000001000000DE00000010000000110000001B000000020000001C000000380000000B00000001000000040000000100000000005A09010000000000060041079F0F0600AE079F0F06007706300F0F00BF0F000006008B06F20A06002407F20A0600F006F20A06009507F20A06006107F20A06007A07F20A0600B806F20A0600D306F20A06008512070A0A00A206680E0A007108DD0F06001100B1010A001705680E0A00BC0B09130A00610209130A00840D09130A006D0C09130A006C0B09130600CD0C070A0600F904070A0A008B03580143001F0F00000600D101540806001F02070A0600240A070A0E00350CBF1006007A0C070A1200CE0FE6040A000F07680E0A000E0ADD0F0600A90C070A06000E0CF6001200001494121200F60594120600A00DF6000600DB09F60012001A0C94120A006401680E0A008D02680E0600100FD3100A004015580106009503070A0A00320A58010A00D20A09130A00820558010600CA02070A0600BC05070A0A00BA15091312007015941212008A1394120600200603101200041494121200350D300F1200DA11300F1200010050130A00AD0BA0010A004702A0010A00750DA0010A00270CA0010E001F05BF100A00250E091306008F0C070A0A002D15680E0A00A00B090D0A003D02090D0A00680D090D06008D08070A0A00070F09130600CB13540806002400070A06001F13070A0A007F0B58010A00CE05580112003A13440912006A15A01012002811A0100600DE03F6001200050E941212008C05941206004C0D070A12002D0B94121200040BF50106006808F8141200FA0594121200E20294120600AD0DF60006002D00070A0A00180B580106001C0A070A0A00410B09130A00C40A090D0600E307070A06007509070A0600C50C070A0A005A0658010600510C070A0600AB03070A0A003110DD0F0A007A11DD0F0A00D815DD0F0A00E007DD0F0A00F604DD0F0A00A103DD0F0A001402DD0F0A003300DD0F0A001800DD0F0A002A00DD0F0A00B115DD0F0A002309DD0F0A00CF03DD0F0A008709DD0F0600320EF60006003F0EF6000A005C0D58010A00580BA0010A00C10EA0010E00F70BBF100A00190E090D0A00D80B5801000000004500000000000100010001001000F20F0000350001000100000010008200000035000600140000001000E000000035000D0019000000100027010000350019001C0000001000E90C0000350020002B0002001000991500003500350056005180A300F2065180F000F20651809D00F2065180D211F2065180E101F2065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100F80DF2060100D70CF5065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100C311F9060100D70CF50601004E00F2060100B80DF2060100A900F20601005714020701008F11F9060100790F020701005D10020701007311020701008110020701002104F20601004D01F90601005311050701007A000D070100790F020701002F1402070100691202070100DA04F2060100B204F20601009304F2060100EC0DF2060100600EF20601009B02F20601003612F20601004A05F2060100FE11F20601001C01F20601001411F2060100EB00F2060100B30EF2060100B214F2060100FA13F20601005503F2060100C10811075020000000009600A709140701003C30000000009600C808940105007030000000009600E603A7000700B0310000000096000C091F0708001C35000000009600E3032F0711005C36000000009600D90337071300B03700000000910087033E0715001C3900000000910070014407160098390000000091006E13500718003C3C00000000910068035C071A00B03F00000000910079035C071D008042000000009100B30265072000B0420000000091006E056D072100D842000000009100C6157507220008440000000091003D0A800727009045000000009100530A8B07290024480000000091005B0F98072C00F8480000000091006A0FA2072D0078490000000086182A0F06002E0081490000000086182A0FA8072E00A449000000008600DA11060030004C54000000009100E215E00130009C54000000009100D90337073100F0550000000091002B13E001330034560000000086182A0FAF0734008856000000008600DA1106003600FC650000000081005900060436007C660000000086083511BC07370094660000000086084411C5073700A066000000008608671020013800B866000000008608741001003800C4660000000086085F1120013900DC66000000008608691101003900E866000000008608431020013A000067000000008608501001003A000C67000000008608430F20013B0024670000000086084F0F01003B0030670000000086083101CF073C0048670000000086083F01D9073C00546700000000860801040F013D006C67000000008608110410003D0078490000000086182A0F06003E0078670000000086088E140F013E009067000000008608A01410003E009C67000000008608E2110F013F00B467000000008608F01110003F00C06700000000860830050F014000D8670000000086083D0510004000E467000000008608471220014100FC670000000086085812010041000868000000008608430F2001420020680000000086084F0F010042002C68000000008608171420014300446800000000860823140100430050680000000086086400E407440068680000000086086F00E9074400746800000000860820120F0145008C680000000086082B12100045009868000000008608910E0F014600B068000000008608A20E10004600BC6800000000860829030F014700D4680000000086083F0310004700E06800000000860800010F014800F8680000000086080E01100048000469000000008608BE000F0149001C69000000008608C6001000490028690000000086084A0E0F014A004069000000008608550E10004A004C69000000008608BC040F014B006469000000008608CB0410004B0070690000000086087D040F014C008869000000008608880410004C009469000000008608CE0D0F014D00AC69000000008608DD0D10004D00B86900000000860863040F014E00D069000000008608700410004E00DC69000000008608E8130F014F00F469000000008608F11310004F00006A000000008608E6100F015000186A000000008608FD1010005000246A0000000086088D000F0151003C6A000000008608950010005100486A000000008608AD0806015200606A000000008608B708D30452006A6A0000000086182A0F060053007C6A00000000E601DB12EF07530078490000000086182A0F0600570000000100F90D02000200A20800000300820F00000400C208000001002815000002009C0A00000100A90400000100B70900000200821300000300A11100000400860200000500C10500000600FE0200000700C41300000800FF12020009001C0D00000100A904020002008F0100000100A904000002008F01000001009112000001009112000002007B0800000100091200000200760A000001009B0400000200911200000300760A000001009B0400000200911200000300760A00000100000300000100A10500000100911200000200A309000003003D04000004007C0A10100500CE00000001006F0A000002007B0800000100E104000002006F0A00000300A10500000100C41200000100CF1200000100F90D00000200FA0C00000100B60000000100A904000002008F01000001009E0800000100FA0C000002009811000001008C12000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001009713000002003006000003000F1400000400E2090700D50009002A0F010011002A0F060019002A0F0A0029002A0F100031002A0F100039002A0F100041002A0F100049002A0F100051002A0F100059002A0F100061002A0F100071002A0F060009012A0F060079009F12A7000C002A0F060014002A0F060019020E05BB0091002A0F060099002A0F060091002A0F100021022D0A06009900910BC00029020415100089006C02C6009900920DCC0031022E09D10031021C02D60031022100DC0031028A08E1003102190AE6001400DD01EB0039020F16F1001C002A0F060024002A0F06000C00DD01EB003102CC010601310212060600A900B8110A01B90005030F01B100F5091301690081080F01390277121A01B100A01320018900760210001400A0132001C100381524010C001C0F29012C004413390114001C0F290134004413390139020316F1003400EF1406017101180606002C00EF14060149022A0F4501D9002A0F4B01D900F8031000D900E21306002400DD01EB00390277125201D900460D5A01C10081085F01510281080F01390277126401C100B50A6A01E9008E0F7301390277127701590202057E01C9002A0F06001C0017038201C9003E1289016902A0132001390201098F0179000F169401110140089E01C9001103A5011C00A013200171021806060021021206060039028B108F017900E8070F01E9002A0FB2017902CE08B90111019F12C40139021D16DB0189021912DB0189021415E00191028315140291028E091B0291021F082202C1013C062702C1017B021000C101B10510002901F11210002901B9131000C101381401003902AB122E02C10183113502B102FE093B02B9023C004102B9023A104702C101E1084D02C101D1095202410171065802C10106066002C102BF095202B9026508660239012A0F6D0239012A0F77023101D3027E02D10224020F0139027E1284027900EB0B8B024901E905600279007C09060189022015B00259012A0FD9028900D713E10269021C0FE80261014413EE025901AA1320016901F509F2025901FF07F70289004815E1026101EF14060189002E020600D90281080F01C90094100E03E102F50914039100E10A3A0399002A0F40039900A9114A03F102F20750032902F3152001F902B1120600F9021A0906003C002A0F06003C00DD01EB005101EF030F0151017E0586033C008B108C035101F30892033902A00296035101810A9C03010381080F0151011F039C0399002A0FA0033C001C0F29014400441339014400EF1406013902D608200139029408DB036901F509E10309031308E60311032A0F1000210250060004A1012A0FC000A1012E041000A101830E060421032A0F1000790154052004790154040F019901C702260451012A0F2F0451012A0F37047901F30820019901BD035D0489038F0A690451012A0F6C0424001C0F29015C0044133901D900480806015C00EF14060169002A0F0600C9012A0F0600C90147041000C901F0111000C9017414D304C901D414D304C901DD0ED304C901CC07D304C9015715D304D1012A0F0600D101270DD804D101E2130601D1016214DF04A90371061000A90312060600D101C114E504D101CB0EE504D101B8120600D101F102200189026A06EB04E1012A0F1000E9012A0F7D05290244140100E901920D8505C900D8018B05E1028B108F013102E8010601F901B8119205B903F5099805C10305030F01C103F70E2001C103A8020F01C10343060F01B903A01320011C00DD01EB0001022A0F9F0591005302A605F102DD01AB05D103CA0BB605D103E807EE02A900510D200179012A0F10009901A905C40579016105CB0579016C09D30479010808D20579013508D304E102DD01D7057901390901000E000400A9060E000800B4060E000C00BF060E001000D4060E001400E3060E001800A9060E001C00B4060E002000BF060E002400D4060E002800E3060E003400A9060E003800B4060E003C00BF060E004000D4060E004400E30602009900F006200063009D082E000B0021082E0013002A082E001B0049082E00230052082E002B0065082E00330065082E003B006B082E0043007D082E004B006B082E00530065082E005B00900840006B00A20860006B00A208800063009D08A00063009D08C00063009D081500AC01CB01E5019402A102B602FD021B035803A703EB03F0030C04400476049504A304F004F404F904BD05DE05E705EB05F505FA05050001000600080000005411FD0700008210060800007411060800005E10060800007A0F060800004E010A080000220414080000B31414080000FF11140800004B05140800006A12060800007A0F060800003014060800007B0018080000371214080000B40E140800005603140800001D0114080000F20014080000610E14080000DB0414080000940414080000ED0D14080000740414080000FB1314080000151114080000990014080000BB081D0802001C00030001001D00030002001E00050001001F000500020020000700010021000700020022000900010023000900020024000B00010025000B00020026000D00010027000D00020028000F00010029000F0002002B00110001002C00110002002D00130001002E00130002002F001500010030001500020031001700010032001700020033001900010034001900020035001B00010036001B00020037001D00010038001D00020039001F0001003A001F0002003B00210001003C00210002003D00230001003E00230002003F002500010040002500020041002700010042002700020043002900010044002900020045002B00010046002B00020047002D00010048002D00020049002F0001004A002F0002004B00310001004C00310002004D00330001004E00330002004F003500010050003500020051003700010052003700020053003900010054003900AD00B400F700FF0032013E018003D5035A0466048E04048000000100000000000000010000000706A70A0000040000000000000000000000FE05970100000000040000000000000000000000FE05580100000000040000000000000000000000FE05BF1000000000040000000000000000000000FE05070A00000000070002000000000000436F6E63757272656E744261676031004C69737460310053716C496E74333200476574496E7433320053716C496E7436340053716C496E743136006765745F55544638003C4D6F64756C653E0073457865637574654442004164645F52756E5F4944006765745F52756E5F4944007365745F52756E5F4944007652756E5F49440045786563757465434D44006765745F505744007365745F50574400504753514C004D5353514C0073457865637574655453514C005468655F53514C006765745F53514C007365745F53514C00636F6E6E656374696F6E5479706553514C004578656375746553514C007653514C004D7953514C0053797374656D2E494F006765745F49505F6F725F444E53007365745F49505F6F725F444E53007649505F6F725F444E530052657475726E5F4454006765745F526573756C745F4454007365745F526573756C745F44540076526573756C745F44540053797374656D2E446174610053716C4D657461446174610045787472616374446174615461626C65436F6C756D6E4D657461446174610074686564617461006D73636F726C69620053797374656D2E446174612E4F6462630053797374656D2E436F6C6C656374696F6E732E47656E65726963005265616400546872656164004C6F616400416464006661696C6564006765745F4973436C6F7365640053797374656D2E436F6C6C656374696F6E732E5370656369616C697A65640053716C4775696400476574477569640052656164546F456E640053656E64526573756C7473456E64004462436F6D6D616E64004F646263436F6D6D616E6400437265617465436F6D6D616E640053716C436F6D6D616E640045786563757465416E6453656E64007365745F4D6574686F64006D6574686F640053716C446174615265636F72640076507764005265706C616365006765745F536F7572636500496E76616C69644461746154797065436F64650047657454797065436F6465006765745F537461747573436F64650048747470537461747573436F6465006765745F45786974436F646500656E636F6465006765745F4D657373616765004D657267650054727954616B65006765745F5363616C65006765745F5265737475726E5F544D505F5461626C65007365745F5265737475726E5F544D505F5461626C6500765265737475726E5F544D505F5461626C6500416C7465725F54656D705F5461626C65004C6F6164446174615461626C650053656E64446174615461626C650049446973706F7361626C650053716C446F75626C650052756E74696D655479706548616E646C65004765745479706546726F6D48616E646C650053716C53696E676C6500577269746546696C650075705F7265616466696C65006765745F4E616D65007365745F4E616D65006765745F526573756C745F4E616D65007365745F526573756C745F4E616D650076526573756C745F4E616D65007365745F44657374696E6174696F6E5461626C654E616D65007365745F46696C654E616D65006765745F436F6C756D6E4E616D65006765745F557365724E616D65007365745F557365724E616D65006765745F44426E616D65007365745F44426E616D65007644426E616D6500746D707461626C655F6E616D650066696C656E616D650076557365726E616D65006765745F5365727665726E616D65007365745F5365727665726E616D6500765365727665726E616D650053797374656D2E4E65742E4D696D650053716C4461746554696D65006765745F4E65774C696E65006765745F506970650053716C50697065005472616E73616374696F6E53636F7065006765745F434D445F54797065007365745F434D445F547970650076434D445F54797065006765745F4461746154797065007365745F446174615479706500556E6B6E6F776E4461746154797065006765745F53716C44625479706500536563757269747950726F746F636F6C5479706500636C72547970650047657454797065007365745F436F6E74656E745479706500636F6E74656E745F7479706500496E7465726E616C44617461436F6C6C656374696F6E42617365006765745F526573706F6E73650048747470576562526573706F6E736500476574526573706F6E736500436C6F736500446973706F73650058353039436572746966696361746500636572746966696361746500437265617465006765745F53514C5374617465006765745F537461746500436F6E6E656374696F6E53746174650044656C6574650057726974650044656275676761626C6541747472696275746500417373656D626C795469746C654174747269627574650053716C50726F63656475726541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465007365745F5573655368656C6C457865637574650053716C42797465006765745F56616C7565004164645769746856616C75650053657456616C7565007365745F44656661756C7456616C75650076616C7565007365745F457870656374313030436F6E74696E7565007365745F556E69717565006F705F54727565006765745F4973416C6976650053797374656D2E546872656164696E6700476574456E636F64696E670053716C537472696E6700636F65726365546F537472696E6700476574537472696E6700537562737472696E67006172670052657475726E5F4D7367006765745F4465627567007365745F4465627567007664656275670052656745785F49734D61746368006765745F4C656E677468007365745F436F6E74656E744C656E677468006765745F4D61784C656E67746800537461727473576974680063616C6C5F726573745F61706900526F6C6C6261636B0053716C446563696D616C004765744F7264696E616C005365744F7264696E616C0053797374656D2E436F6D706F6E656E744D6F64656C0064625F6175746F6D6174696F6E2E646C6C007365745F416C6C6F7744424E756C6C006765745F49734E756C6C0053716C586D6C007365745F536563757269747950726F746F636F6C0053716C00657865635F72656D6F74655F73716C006170695F75726C00476574526573706F6E736553747265616D004765745265717565737453747265616D00636572746966696361746550726F626C656D006765745F4974656D007365745F4974656D0053797374656D0053716C426F6F6C65616E00476574426F6F6C65616E0054696D655370616E004F70656E0044617461436F6C756D6E0053716C4D6574614461746146726F6D436F6C756D6E0053716C4D6574614461746146726F6D4F626A656374436F6C756D6E00636F6C756D6E006F436F6E6E00636F6E6E006765745F507265636973696F6E004D6178507265636973696F6E0045787072657373696F6E0064625F6175746F6D6174696F6E006F705F5375627472616374696F6E0044625472616E73616374696F6E0053716C5472616E73616374696F6E00426567696E5472616E73616374696F6E0053797374656D2E5265666C656374696F6E004E616D6556616C7565436F6C6C656374696F6E0044617461436F6C756D6E436F6C6C656374696F6E00576562486561646572436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E004F6462634572726F72436F6C6C656374696F6E0053716C4572726F72436F6C6C656374696F6E0044617461526F77436F6C6C656374696F6E007365745F436F6E6E656374696F6E004462436F6E6E656374696F6E004F646263436F6E6E656374696F6E0053716C436F6E6E656374696F6E007365745F446972656374696F6E00506172616D65746572446972656374696F6E006F705F4164646974696F6E005472616E73616374696F6E53636F70654F7074696F6E00494F457863657074696F6E00576562457863657074696F6E004F646263457863657074696F6E005472616E73616374696F6E41626F72746564457863657074696F6E00417267756D656E744F75744F6652616E6765457863657074696F6E0053716C457863657074696F6E004170706C69636174696F6E457863657074696F6E00496E76616C69644F7065726174696F6E457863657074696F6E00556E617574686F72697A6564416363657373457863657074696F6E00417267756D656E74457863657074696F6E007352656D6F74655F457865637574696F6E0072656D6F74655F657865637574696F6E00546869735F657865637574696F6E0053797374656D2E446174612E436F6D6D6F6E006170695F72657475726E007365745F5374617274496E666F0050726F636573735374617274496E666F00536C6565700043686172006765745F4E756D62657200494461746152656164657200446244617461526561646572004F646263446174615265616465720053716C4461746152656164657200457865637574655265616465720053747265616D526561646572005465787452656164657200734578656375746544425F444250726F7669646572006765745F444250726F7669646572007365745F444250726F76696465720076444250726F7669646572007354656D705F466F6C6465720053657276696365506F696E744D616E61676572004462506172616D657465720053716C506172616D657465720053747265616D5772697465720054657874577269746572006765745F447269766572007365745F4472697665720076447269766572004D6963726F736F66742E53716C5365727665722E536572766572005772697465546F536572766572006765745F52656D6F74655F4572726F72007365745F52656D6F74655F4572726F72007652656D6F74655F4572726F72004F6462634572726F72006765745F5374616E646172644572726F72007365745F52656469726563745374616E646172644572726F72006765745F4E61746976654572726F720053716C4572726F720049456E756D657261746F7200476574456E756D657261746F72002E63746F720053797374656D2E446961676E6F7374696373006765745F54687265616473007365745F546872656164730052756E6E696E6754687265616473005265667265736854687265616473007654687265616473006D61785F74687265616473006765745F546F74616C5365636F6E64730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004D65646961547970654E616D65730053797374656D2E446174612E53716C54797065730053746F72656450726F636564757265730053797374656D2E53656375726974792E43727970746F6772617068792E583530394365727469666963617465730053716C4279746573004765744279746573006765745F52756E6E696E6773007365745F52756E6E696E6773007652756E6E696E6773006765745F57616974696E6773007365745F57616974696E6773007657616974696E677300436F6E7461696E73006765745F436F6C756D6E730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E5472616E73616374696F6E730053797374656D2E436F6C6C656374696F6E73006765745F436F6E6E656374696F6E5F4F7074696F6E73007365745F436F6E6E656374696F6E5F4F7074696F6E730076436F6E6E656374696F6E5F4F7074696F6E730052656765784F7074696F6E73006765745F457865637574696F6E73007365745F457865637574696F6E730076457865637574696F6E73006765745F53746F7073007365745F53746F7073007653746F70730053716C4368617273006765745F48656164657273006452656164657273006F526561646572730068656164657273006765745F506172616D6574657273006765745F4572726F7273006F457865637574654572726F727300737563636573730050726F63657373006765745F417267756D656E7473007365745F417267756D656E74730076417267756D656E747300726573756C745F636F6E74656E747300457869737473006765745F537461747573007365745F5374617475730076537461747573006765745F526F7773006765745F4166666563746564526F7773007365745F4166666563746564526F777300764166666563746564526F777300436F6E63617400466F726D6174004F626A65637400746869735F64740053797374656D2E4E6574006F705F496D706C696369740053706C697400436F6D6D69740057616974466F724578697400416C6C5F526573756C7400546869735F526573756C7400436865636B56616C69646174696F6E526573756C74007365745F557365724167656E7400757365726167656E740053797374656D2E446174612E53716C436C69656E7400456E7669726F6E6D656E7400457363617065417267756D656E7400436F6D706F6E656E74006765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E74005570646174655F457865635F436F6E74656E7400636F6E74656E740053657276696365506F696E7400737276506F696E74006765745F436F756E74006765745F4669656C64436F756E74007365745F416363657074006163636570740054687265616453746172740053656E64526573756C74735374617274006765745F506F7274007365745F506F72740076506F72740048747470576562526571756573740072657175657374006765745F54696D654F7574007365745F54696D654F7574007654696D654F7574007365745F54696D656F7574007365745F436F6D6D616E6454696D656F75740054686574696D656F7574006765745F5374616E64617264496E707574007365745F52656469726563745374616E64617264496E707574006765745F52656D6F74655F4F7574707574007365745F52656D6F74655F4F7574707574007652656D6F74655F4F7574707574006765745F5374616E646172644F7574707574007365745F52656469726563745374616E646172644F7574707574004D6F76654E6578740053797374656D2E54657874007365745F436F6D6D616E64546578740052656164416C6C54657874005772697465416C6C546578740053716C436F6E74657874006765745F4E6F770044617461526F770053656E64526573756C7473526F77007365745F4372656174654E6F57696E646F7700526567657800494365727469666963617465506F6C696379007365745F4365727469666963617465506F6C69637900437573746F6D4365727469666963617465506F6C6963790053716C4D6F6E65790053716C42756C6B436F70790053514C53657276657242756C6B436F70790053716C42696E61727900466F726D61745F53514C5F517565727900457865637574654E6F6E5175657279006F705F457175616C697479006F705F496E657175616C6974790049734E756C6C4F72456D7074790000000F73007500630063006500730073000001003563006F006E007400650078007400200063006F006E006E0065006300740069006F006E0020003D00200074007200750065003B000081556900660020006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074002700290020006900730020006E0075006C006C002000200072006100690073006500720072006F007200200028002700430061006E0020006E006F0074002000660069006E00640020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E007400210027002C00310036002C00310029002000730065006C0065006300740020002A002000660072006F006D0020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E00740020006F0072006400650072002000620079002000720065007400750072006E005F0074006D0070005F007400610062006C0065003B002000010D520075006E005F0049004400000F5400680072006500610064007300000F740069006D0065006F007500740000157300650072007600650072006E0061006D0065000013490050005F006F0072005F0044004E005300000D640062006E0061006D006500000D540068006500530051004C00000950006F00720074000017640062005F00700072006F00760069006400650072000013440042005F00440072006900760065007200001175007300650072006E0061006D0065000007700077006400001B520065006D006F00740065005F004F0075007400700075007400001143004D0044005F005400790070006500001341007200670075006D0065006E0074007300002543006F006E006E0065006300740069006F006E005F004F007000740069006F006E0073000021720065007400750072006E005F0074006D0070005F007400610062006C006500000B44006500620075006700000F570061006900740069006E006700000743004D0044000015530051004C0020004500720072006F0072003A00002145007800630065007000740069006F006E0020004500720072006F0072003A00001D530065006E007400200071007500650072007900200074006F00200000052D002D00010F520075006E006E0069006E006700002779007900790079002D004D004D002D00640064002000480048003A006D006D003A007300730001172D002D002D00530074006100720074006500640020000121200065007800650063007500740069006F006E007300200066006F007200200000052C0020000029200071007500720069006500730020006100720065002000770061006900740069006E006700210000192D002D002D00530065006E00740020006F00750074002000013720007100750065007200690065007300200074006F002000720065006D006F007400650020007300650072007600650072007300210000292D002D002D00520075006E006E0069006E006700200071007500650072006900650073003A00200001372D002D002D0053007400610072007400200074006F002000720065007400750072006E00200072006500730075006C00740073002E000103230000072D002D002D0001292D002D002D00640061007400610020006D00650072006700650020004500720072006F0072003A0001512D002D002D0063006F006E00630075007200720065006E00740042006100670020007400720079006F0075007400200044006100740061005400610062006C00650020006600610069006C0065006400012F20003A002000520065007400750072006E0065006400200061006C006C00200072006500730075006C0074007300000720003A002000001F45007800630065007000740069006F006E005F00530051004C003A002000003145007800630065007000740069006F006E005F005400720061006E0073005F00410062006F0072007400650064003A00001D45007800630065007000740069006F006E005F004100700070003A000051650078006300650065006400730020006D006100780069006D0075006D0020006C0065006E00670074006800200073007500700070006F00720074006500640020006F00660020003400300030003000001745007800630065007000740069006F006E003A00200000534500720072006F0072003A002000660069006C00650020006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E00002F4500720072006F0072003A002000660069006C00650020006E006F00740020006500780069007300740073002E0000514500720072006F0072003A005000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A00200000414500720072006F0072003A0049004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A00200000314500720072006F0072003A0055006E006500780070006500630074006500640020006500720072006F0072003A002000000950004F0053005400003B480054005400500020004500720072006F0072003A0020007B0030007D002C002000440065007400610069006C0073003A0020007B0031007D0000514500720072006F0072003A002000460069006C0065006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E0000455000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A002000003549004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A002000002555006E006500780070006500630074006500640020006500720072006F0072003A00200000434500720072006F0072003A00200049006E00700075007400200064006100740061002000630061006E006E006F00740020006200650020006E0075006C006C002E000019720065007400750072006E00200052006F00770073003D0000372D002D002D0045007800630065007000740069006F006E005F00530065006E00640044006100740061005400610062006C0065003A0001811775007000640061007400650020005B002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074005D0020007300650074002000720065006D006F00740065005F006F00750074007000750074003D004000720065006D006F00740065005F006F00750074007000750074002C00720065006D006F00740065005F006500720072006F0072003D004000720065006D006F00740065005F006500720072006F0072002C00610066006600650063007400650064005F0072006F00770073003D004000610066006600650063007400650064005F0072006F00770073002000770068006500720065002000720075006E005F00690064003D004000720075006E005F006900640000032E00001920002D002D0020006600610069006C00650064003A002000010D6600610069006C0065006400001D4000720065006D006F00740065005F006F0075007400700075007400001B4000720065006D006F00740065005F006500720072006F007200001D4000610066006600650063007400650064005F0072006F0077007300000F4000720075006E005F006900640000292D002D002D004C006F00610064005F004500720072006F00720020004500720072006F0072003A00010749006E007400000D42006900670049006E007400000742006900740000114400610074006500540069006D006500000B4D006F006E0065007900001153006D0061006C006C0049006E007400000F540069006E00790049006E007400002155006E0069007100750065004900640065006E00740069006600690065007200000B4E00740065007800740000095200650061006C000017730071006C005F00760061007200690061006E007400000F560061007200690061006E007400002F49004600200043004F004C005F004C0045004E0047005400480028002700540045004D005000440042002E002E00010927002C002000270001332700290020004900530020004E0055004C004C002000200041004C0054004500520020005400410042004C00450020005B00010D5D002000610064006400200000035B00001D5D002000730071006C005F00560061007200690061006E0074003B0000055D00200000033B0000052000280000052D00310001074D0041005800000529003B00000F44006500630069006D0061006C0000032C0000352D002D002D0041006C007400650072005F00540065006D0070005F005400610062006C00650020004500720072006F0072003A0001808F730065006C0065006300740020006E0061006D0065002000660072006F006D002000740065006D007000640062002E007300790073002E0063006F006C0075006D006E00730020007700680065007200650020006F0062006A006500630074005F00690064003D006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E00012B2700290020006F007200640065007200200062007900200063006F006C0075006D006E005F006900640001096E0061006D006500001B69006E007300650072007400200069006E0074006F0020005B0000155D002000760061006C0075006500730020002800000340000003290000152D002D002D0069006E0073006500720074002000010F20004500720072006F0072003A00001D49006E00760061006C0069006400200074007900700065003A002000001D55006E006B006E006F0077006E00200074007900700065003A002000001D7B0022007300740061007400750073003A0022004F004B0022007D000055540068006900730020006D006500740068006F00640020006900730020006F006E006C007900200066006F0072002000530051004C002000530065007200760065007200200045006E00670069006E006500730000317B0022007300740061007400750073003A0022006600610069006C006500640022002C0022006D00730067003A00220000032D00010522007D000011730071006C005F0063006D0064005F00001579007900790079005F004D004D005F006400640000035F0000092E00730071006C0000092E006C006F00670000092E006F0075007400000F530051004C005F0043004D004400000B4D005300530051004C000015530051004C0043004D0044002E0045005800450000192D00620020002D007200310020002D00780020002D005300010720002D006400010720002D007400010720002D006900010720002D004500010720002D005500010920002D005000220001032200000B4D007900530051004C0000134D005900530051004C002E00450058004500000D2D00420020002D0068002000010920002D0050002000010920002D0044002000010920002D0075002000010720002D007000011550006F0073007400670072006500530051004C0000115000530051004C002E00450058004500000D2D00710020002D0068002000010920002D0070002000010920002D0064002000010920002D0077002000010320000011530051004C005F00440055004D005000000F4200430050002E0045005800450000152000710075006500720079006F00750074002000000920002D0063002000010920002D0053002000010920002D0065002000010720002D005400010920002D0055002000010920002D005000270001032700011B4D005900530051004C00440055004D0050002E0045005800450000072D0068002000010720002D007500010920002D0070002700012120002D002D0072006500730075006C0074002D00660069006C0065003D0020000117500047005F00440055004D0050002E00450058004500000920002D0068002000010920002D0066002000010D4F0053005F0043004D00440000030A0000030D0000055C00220000052200220000114400720069007600650072003D007B0000137D003B005300650072007600650072003D0000153B00440061007400610062006100730065003D00000B3B005500690064003D00000D3B0050006F00720074003D00000B3B005000770064003D000019720065006D006F00740065005F006500720072006F007200002374006D0070005F006400740020006C006F006100640020006E0075006C006C002D00011D4F0064006200630045007800630065007000740069006F006E003A00000F49006E006400650078002000230000150A004D006500730073006100670065003A002000001D0A004E00610074006900760065004500720072006F0072003A00200000130A0053006F0075007200630065003A002000000D0A00530051004C003A00200000194F0044004200430020004500720072006F0072003A002000000D3B005000770064003D007B0000037B0000057B007B0000057D003B0000194400610074006100200053006F0075007200630065003D0000233B0049006E0069007400690061006C00200043006100740061006C006F0067003D0000673B0049006E00740065006700720061007400650064002000530065006300750072006900740079003D0053005300500049003B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0000453B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0075007300650072002000690064003D0000173B00700061007300730077006F00720064003D002700010527003B000127650078006500630020004000720065007400750072006E005F00760061006C00750065003D00001B4000720065007400750072006E005F00760061006C00750065000023720065006D006F00740065005F006A0073006F006E005F006500720072006F007200000330000021520065007400750072006E005F00760061006C007500650020006900730020000037530071006C0045007800630065007000740069006F006E002D004500720072006F0072003A00740069006D0065006F00750074002000011B530071006C0045007800630065007000740069006F006E002D00013549006E00760061006C00690064004F007000650072006100740069006F006E0045007800630065007000740069006F006E002D00011545007800630065007000740069006F006E002D0001395400720061006E00730061006300740069006F006E00410062006F00720074006500640045007800630065007000740069006F006E003A00002B4100700070006C00690063006100740069006F006E0045007800630065007000740069006F006E003A00001545007800630065007000740069006F006E003A000017530079007300740065006D002E00470075006900640000C62AA4824EBAAC40AB82787E8387AEB800042001010803200001052001011111042001010E8090074E0E0E15124101121415124101121812451249124D02121412511218020202125512590E080208125D080811610812651511690112141214151169011218121802151169011214121402151169011218121802120C126D11710202020E116108021210126D0202020E02020E0211750E02151169011214121412650202020202125D02020212551279127D125D0E02050001113D0E0615124101121406151241011218040000124505200101124905200101124D0420001251042001080E05200111710804200108080420010E080420010208052001011300050002020E0E07151280ED0112650615124101126D0320000204200012590320000E062001128121080500020E0E0E03200008040000116108200015116901130006151169011214042000130006151169011218052002011C18062001011281250700040E0E0E0E0E04000101080420010E0E0500010E1D0E0800021175116111610320000D0600030E0E0E0E0300000E06200102101300052000128131042001020E090002118089113D113D0600010211808906200201126502050701118089062003010808080A0004020E0E1181411175060001118089020F07070E02113D0212808D128091125D040001020E0400010E0E2E07180E12809512809912809D020202021D0E081D0E02021D051280A10202081280A5128099021280A112809D125D060001011280D50600010111814D04000101020600011280E10E0620011D0E1D03052000128155052002010E0E05000012815D0520011D050E042001010A0520001280A1072003011D05080805200012816106000112815D0E092002011280A112815D062001011280A10520001181650600030E0E1C1C080002113D113D113D0C0705020812808D128091125D0E07070E02080212808D128091125D050002010E0E2207111D021D1280A91280AD12450A1280B11280B508081C02021280B90E125D0E1161072001011D1280A9062001011280AD0520001280B10320001C0420011C0805200201081C1007061D1280A908081280BD021D1280A90520001281710620011280BD081E070F0E1280C10E151169011218121802124D125512590E08020E125D11610520001280C1092003010E12491280C10520001281790720021281050E1C2707130E0E1D02151241010E1D1280A91D1280A9081280A9021180C5020A0205124D0E125D0E116105151241010E0520001180C50520010213000320000A0520020E0E0E03200005062002010E12492D0712151241010E0E124D1251021280C1151169010E0E1280B11280B5124D151169010E0E1280B9125D0E11610E05151169010E0520020E08080420011C0E0406128185040701125D0F07080E0202124D1280D10E1255125D05200011818D0520010112651307071280A91280CD0E1180C91180C9021280A90520001280CD0800011180C91280CD072002010E1180C5082003010E1180C50A1907131280A902020202020202020202020202020202021280A9021D050800011280CD118195021D03020605092004010E1180C50505170709080808151169011214121415116901126D126D02080615116901126D0D0705080815116901126D126D022F07260E0E0E0E0E116111711280E5020208020202020202020202020202021280E90E0E020E02020202020202125D020420010102062001011280E50520001281D105200012809D040001010E0307010E040702020E8082074D12651265020E1280F11280F51280F9126502021280B11280B51280B90E021280FD0E080802125D0E02020E1280F11280F51280F9126502021280B11280B50E021280FD0E0802125D0E020212810112490202128105124D125102126502021280B11280B50E020202020E12550E021281090E125D0E0212790E127D0E125D0E02072002010E1280F10520001280F9062001011281D90520001281DD0620011281E108062001011181E5042000124D0A20031281050E1180C508062001011181ED0607021280BD020600011280CD0E062001011280CD042001011C062001011280BD08070115124101126D03070108090701151280ED01126504070111710307010208B77A5C561934E08980A0002400000480000094000000060200000024000052534131000400000100010001657C118060430AB20024C1B3584340A220EFEA08E174BB5B1DD6FFD420C6DE75EEC407A4619A2307DBB4A72E6D94155655F36B65DB8349E417995A1CBD0BB6CAB5FD4EAE45EB0194B9E1ECFC0B35BBC09E2D05B2D22A82E685AA20EE337A123EF65D808E43224584CB39648C0DCC03279FCF2586C260087D1E600E0BAAA5B10A4D005300530051004C000A4D007900530051004C001450006F0073007400670072006500530051004C000E73007500630063006500730073000C6600610069006C0065006400010102060E030612180806151280ED011265020608070615124101126D030611710206020A000408113D10113D08020F0009080E113D0E0E0E0E0E0E10113D070002080E10113D060002080E113D0500010E12650B00021D1280A91265101D020B00020E15124101121812490800030E0E12651249070001125D1180C9070001125D1280CD0A00050E12650E0E1249020A00021280A91280BD10020C00031280A90E1280BD1280CD09000108151241011214050001011214062002010E12180C2002011218151280ED01126508200015124101126D0920010115124101126D092000151280ED0112650A200101151280ED01126504200011710520010111710D2004021280D91280DD1280E10808280015124101126D03280008092800151280ED0112650328000E0428001171032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001201000D4442204175746F6D6174696F6E00000501000000001101000C3357204C6F6E67204461746100001201000D64625F6175746F6D6174696F6E00000C010007312E302E302E3000000401000000240100020054020F497344657465726D696E6973746963015402094973507265636973650100C0E7AD8023956BABED1A8C1D5BA09F509524CF00B9F1CFF2FF6A8224CBB9D15FB16CD8C0FCA75BDEC7D364FA785066F56FA9329ED54AB8060727FC2C574E49FE1F97896ADBB76EED7A99B5E3EEA10397D6F08162C5D74891D8B6A1B12B0067494A8409A005DF0E109A9139BFC9AF30E5AFBE0416162024B4FDCD5CCAEFD97114000000009A54C76800000000020000001C010000E8B40000E8960000525344534B6AA80F8ECA6E4FB33DE3B912400B1401000000433A5C6277616E675C64625F6175746F6D6174696F6E5C64625F6175746F6D6174696F6E5C6F626A5C44656275675C64625F6175746F6D6174696F6E2E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002CB60000000000000000000046B6000000200000000000000000000000000000000000000000000038B60000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058C000004C03000000000000000000004C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004AC020000010053007400720069006E006700460069006C00650049006E0066006F0000008802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003A000D00010043006F006D00700061006E0079004E0061006D006500000000003300570020004C006F006E006700200044006100740061000000000044000E000100460069006C0065004400650073006300720069007000740069006F006E00000000004400420020004100750074006F006D006100740069006F006E000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000044001200010049006E007400650072006E0061006C004E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003E000D0001004C006500670061006C0043006F00700079007200690067006800740000003300570020004C006F006E00670020004400610074006100000000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004C00120001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003C000E000100500072006F0064007500630074004E0061006D00650000000000640062005F006100750074006F006D006100740069006F006E000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000C000000583600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
WITH PERMISSION_SET = UNSAFE
GO

SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[up_exec_remote_sql]
	@temp_folder [nvarchar](4000) = N'$(temp_folder)',
	@return_msg [nvarchar](max) OUTPUT,
	@max_threads [int] = 10,
	@debug [bit] = False
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [db_automation].[StoredProcedures].[exec_remote_sql]
GO


SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[dblist](
	[servername] [varchar](100) NOT NULL,
	[dbname] [varchar](100) NOT NULL,
	[db_type] [varchar](128) NOT NULL,
	[is_primary] [bit] NOT NULL,
	[ag_listener] [varchar](100) NOT NULL,
	[create_date] [datetime] NULL,
	[db_version] [varchar](100) NOT NULL,
	[app_version] [varchar](200) NOT NULL,
	[db_size_gb] [smallmoney] NOT NULL,
	[data_used_gb] [smallmoney] NOT NULL,
	[log_used_gb] [smallmoney] NOT NULL,
	[comp_level] [smallint] NOT NULL,
	[collation_name] [varchar](50) NULL,
	[recovery_model_desc] [varchar](50) NULL,
	[thumbprint] [varchar](100) NULL,
	[last_login] [datetime] NULL,
	[environment_id] [int] NOT NULL,
	[filelist] [varchar](1000) NOT NULL,
	[last_update] [datetime] NOT NULL,
	[app_url] [varchar](4000) NOT NULL,
	[is_read_only] [bit] NOT NULL,
 CONSTRAINT [PK_dblist] PRIMARY KEY CLUSTERED 
(
	[servername] ASC,
	[dbname] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[para_list](
	[pname] [varchar](200) NOT NULL,
	[pvalue] [nvarchar](4000) NOT NULL,
 CONSTRAINT [PK_para_list] PRIMARY KEY CLUSTERED 
(
	[pname] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO



SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[environments](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[name] [nvarchar](100) NOT NULL,
	[notes] [nvarchar](500) NOT NULL,
 CONSTRAINT [PK_environment] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[instance_types](
	[id] [bigint] NOT NULL,
	[name] [nvarchar](500) NOT NULL,
	[notes] [nvarchar](500) NULL,
 CONSTRAINT [PK_servertype] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[remote_sql_log](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[run_id] [uniqueidentifier] NULL,
	[remote_user] [varchar](128) NULL,
	[servername] [varchar](300) NOT NULL,
	[bywho] [varchar](200) NOT NULL,
	[sqlstring] [nvarchar](max) NOT NULL,
	[applytime] [datetime] NOT NULL,
	[errormsg] [nvarchar](max) NULL,
 CONSTRAINT [PK_remote_sql_log] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[serverlist](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[servername] [varchar](100) NOT NULL,
	[ip_or_dns] [varchar](500) NOT NULL,
	[port_number] [int] NOT NULL,
	[username] [varchar](128) NOT NULL,
	[pwd] [varchar](128) NOT NULL,
	[db_provider] [varchar](50) NOT NULL,
	[odbc_driver] [varchar](100) NOT NULL,
	[connection_options] [varchar](500) NOT NULL,
	[environment_options] [bigint] NULL,
	[max_threads] [int] NOT NULL,
	[ag_node] [bit] NOT NULL,
	[nodelist] [varchar](100) NULL,
	[islive] [bit] NOT NULL,
	[instance_options] [bigint] NOT NULL,
	[Last_reboot] [datetime] NULL,
	[DB_Instance_Property] [nvarchar](max) NOT NULL,
	[OS_Property] [nvarchar](max) NOT NULL,
	[createdate] [datetime] NOT NULL,
	[modifydate] [datetime] NOT NULL,
	[last_update] [datetime] NOT NULL,
	[notes] [nvarchar](4000) NULL,
 CONSTRAINT [PK_serverlist_new] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[sql_functions](
	[id] [int] IDENTITY(1,1) NOT NULL,
	[db_provider] [varchar](128) NOT NULL,
	[fn_name] [varchar](100) NOT NULL,
	[TheSQL] [varchar](max) NOT NULL,
	[enabled] [bit] NOT NULL,
	[modify_date] [datetime] NOT NULL,
	[modifiy_by] [varchar](100) NOT NULL,
 CONSTRAINT [PK_SQLFunctions] PRIMARY KEY CLUSTERED 
(
	[id] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO
SET IDENTITY_INSERT [dbo].[serverlist] ON 
GO
INSERT [dbo].[serverlist] ([id], [servername], [ip_or_dns], [port_number], [username], [pwd], [db_provider], [odbc_driver], [connection_options], [environment_options], [max_threads], [ag_node], [nodelist], [islive], [instance_options], [Last_reboot], [DB_Instance_Property], [OS_Property], [createdate], [modifydate], [last_update], [notes]) VALUES (1, N'mysql_test', N'192.168.68.103', 3306, N'test_user', N'Password&testdb12345', N'MySQL', N'MySQL ODBC 9.4 Unicode Driver', N'option=67108864;', 1, 10, 0, NULL, 1, 0, NULL, N'', N'', getdate(), getdate(), getdate(), NULL)
GO
INSERT [dbo].[serverlist] ([id], [servername], [ip_or_dns], [port_number], [username], [pwd], [db_provider], [odbc_driver], [connection_options], [environment_options], [max_threads], [ag_node], [nodelist], [islive], [instance_options], [Last_reboot], [DB_Instance_Property], [OS_Property], [createdate], [modifydate], [last_update], [notes]) VALUES (2, N'mssql_test', N'192.168.68.103', 1433, N'test_user', N'Password&testdb12345', N'MSSQL', N'', N'', 1, 10, 0, NULL, 1, 0, NULL, N'', N'', getdate(), getdate(), getdate(), NULL)
GO
INSERT [dbo].[serverlist] ([id], [servername], [ip_or_dns], [port_number], [username], [pwd], [db_provider], [odbc_driver], [connection_options], [environment_options], [max_threads], [ag_node], [nodelist], [islive], [instance_options], [Last_reboot], [DB_Instance_Property], [OS_Property], [createdate], [modifydate], [last_update], [notes]) VALUES (3, N'pgsql_test', N'192.168.68.103', 5432, N'test_user', N'Password&testdb12345', N'PostgreSQL', N'PostgreSQL Unicode(x64)', N'', 1, 10, 0, NULL, 1, 0, NULL, N'', N'', getdate(), getdate(), getdate(), NULL)
GO
SET IDENTITY_INSERT [dbo].[serverlist] OFF
GO
SET IDENTITY_INSERT [dbo].[sql_functions] ON 
GO
INSERT [dbo].[sql_functions] ([id], [db_provider], [fn_name], [TheSQL], [enabled], [modify_date], [modifiy_by]) VALUES (1, N'MSSQL', N'get_db_list', N'select name as dbname from sys.databases', 1, getdate(), N'test_user')
GO
INSERT [dbo].[sql_functions] ([id], [db_provider], [fn_name], [TheSQL], [enabled], [modify_date], [modifiy_by]) VALUES (2, N'MySQL', N'get_db_list', N'SELECT SCHEMA_NAME as dbname FROM INFORMATION_SCHEMA.SCHEMATA;', 1, getdate(), N'test_user')
GO
INSERT [dbo].[sql_functions] ([id], [db_provider], [fn_name], [TheSQL], [enabled], [modify_date], [modifiy_by]) VALUES (3, N'PostgreSQL', N'get_db_list', N' SELECT datname as dbname FROM pg_database;', 1, getdate(), N'test_user')
GO
SET IDENTITY_INSERT [dbo].[sql_functions] OFF
GO
SET ANSI_PADDING ON
GO
   
CREATE UNIQUE NONCLUSTERED INDEX [NonClusteredIndex_fn_name] ON [dbo].[sql_functions]
(
	[db_provider] ASC,
	[fn_name] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
GO
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[backup_history](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[backup_set_id] [int] NOT NULL,
	[first_lsn] [numeric](25, 0) NOT NULL,
	[last_lsn] [numeric](25, 0) NOT NULL,
	[backup_start_date] [datetime] NOT NULL,
	[backup_finish_date] [datetime] NOT NULL,
	[type] [char](1) NOT NULL,
	[backup_size_kb] [int] NOT NULL,
	[database_name] [nvarchar](128) NOT NULL,
	[server_name] [nvarchar](128) NOT NULL,
	[device_type] tinyint null,
	[physical_device_name] [nvarchar](520) NOT NULL,
	[family_sequence_number] [tinyint] NOT NULL,
	[sync_status] [varchar](50) NOT NULL,
	[last_update] [datetime] NOT NULL,
 CONSTRAINT [PK_backup_history] PRIMARY KEY CLUSTERED 
(	[ID] DESC)) ON [PRIMARY]
GO

ALTER TABLE [dbo].[backup_history] ADD  CONSTRAINT [DF_backup_history_family_sequence_number]  DEFAULT ((1)) FOR [family_sequence_number]
GO

ALTER TABLE [dbo].[backup_history] ADD  CONSTRAINT [DF_backup_history_sync_status]  DEFAULT ('waiting') FOR [sync_status]
GO

ALTER TABLE [dbo].[backup_history] ADD  CONSTRAINT [DF_backup_history_last_update]  DEFAULT (getdate()) FOR [last_update]
GO

CREATE UNIQUE NONCLUSTERED INDEX [UNIQUENonClusteredIndex-lsn] ON [dbo].[backup_history]
(
	[server_name] ASC,
	[backup_set_id] ASC,
	[type] ASC,
	[database_name] ASC,
	[last_lsn] ASC,
	[family_sequence_number] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO

SET ANSI_PADDING ON
GO

/****** Object:  Index [index_for_merge]    Script Date: 2025-09-19 9:03:16 PM ******/
CREATE NONCLUSTERED INDEX [index_for_merge] ON [dbo].[backup_history]
(
	[last_lsn] ASC,
	[type] ASC,
	[database_name] ASC,
	[server_name] ASC,
	[family_sequence_number] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
GO
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[alert_state](
	[servername] [varchar](128) NOT NULL,
	[alert_name] [varchar](50) NOT NULL,
	[counts] [smallint] NOT NULL,
 CONSTRAINT [PK_alert_state] PRIMARY KEY CLUSTERED 
(
	[servername] ASC,
	[alert_name] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[alert_hist](
	[servername] [varchar](128) NOT NULL,
	[alert_name] [varchar](50) NOT NULL,
	[threshold] [smallint] NOT NULL,
	[threshold_counts] [smallint] NOT NULL,
	[actual_counts] [smallint] NULL,
	[inserted_date] [datetime] NOT NULL
) ON [PRIMARY]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE TABLE [dbo].[WhoIsActive](
	[servername] [varchar](128) NOT NULL,
	[collection_time] [datetime] NOT NULL,
	[cpu_usage_%] [tinyint] NOT NULL,
	[dd hh:mm:ss.mss] [varchar](8000) NULL,
	[session_id] [smallint] NOT NULL,
	[sql_text] [xml] NULL,
	[login_name] [nvarchar](128) NOT NULL,
	[wait_info] [nvarchar](4000) NULL,
	[CPU] [varchar](30) NULL,
	[tempdb_allocations] [varchar](30) NULL,
	[tempdb_current] [varchar](30) NULL,
	[blocking_session_id] [smallint] NULL,
	[blocked_session_count] [int] NOT NULL,
	[reads] [varchar](30) NULL,
	[writes] [varchar](30) NULL,
	[physical_reads] [varchar](30) NULL,
	[used_memory] [varchar](30) NULL,
	[status] [varchar](30) NOT NULL,
	[open_tran_count] [varchar](30) NULL,
	[percent_complete] [varchar](30) NULL,
	[host_name] [nvarchar](128) NULL,
	[database_name] [nvarchar](128) NULL,
	[program_name] [nvarchar](128) NULL,
	[start_time] [datetime] NOT NULL,
	[login_time] [datetime] NULL,
	[request_id] [int] NULL,
	[reads_delta] [varchar](30) NULL,
	[physical_reads_delta] [varchar](30) NULL,
	[writes_delta] [varchar](30) NULL,
	[tempdb_allocations_delta] [varchar](30) NULL,
	[tempdb_current_delta] [varchar](30) NULL,
	[CPU_delta] [varchar](30) NULL,
	[used_memory_delta] [varchar](30) NULL
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF_WhoIsActive_blocked_session_count]  DEFAULT ((0)) FOR [blocked_session_count]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__reads__392E6792]  DEFAULT ((0)) FOR [reads_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__physi__3A228BCB]  DEFAULT ((0)) FOR [physical_reads_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__write__3B16B004]  DEFAULT ((0)) FOR [writes_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__tempd__3C0AD43D]  DEFAULT ((0)) FOR [tempdb_allocations_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__tempd__3CFEF876]  DEFAULT ((0)) FOR [tempdb_current_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__CPU_d__3DF31CAF]  DEFAULT ((0)) FOR [CPU_delta]
GO

ALTER TABLE [dbo].[WhoIsActive] ADD  CONSTRAINT [DF__WhoIsActi__used___3EE740E8]  DEFAULT ((0)) FOR [used_memory_delta]
GO


	   
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_db_type]  DEFAULT ('') FOR [db_type]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_is_primary]  DEFAULT ((1)) FOR [is_primary]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_agname]  DEFAULT ('') FOR [ag_listener]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_db_version]  DEFAULT ('') FOR [db_version]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_app_version]  DEFAULT ('') FOR [app_version]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_db_size_gb]  DEFAULT ((0)) FOR [db_size_gb]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_data_used_gb]  DEFAULT ((0)) FOR [data_used_gb]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_log_used_gb]  DEFAULT ((0)) FOR [log_used_gb]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_comp_level]  DEFAULT ((0)) FOR [comp_level]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_environment_id]  DEFAULT ((0)) FOR [environment_id]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblist_filelist]  DEFAULT ('{}') FOR [filelist]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF_dblists_last_update]  DEFAULT (getdate()) FOR [last_update]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF__dblist__web_url__7A672E12]  DEFAULT ('') FOR [app_url]
GO
ALTER TABLE [dbo].[dblist] ADD  CONSTRAINT [DF__dblist__is_read___7E37BEF6]  DEFAULT ((0)) FOR [is_read_only]
GO
ALTER TABLE [dbo].[environments] ADD  CONSTRAINT [DF__environme__locat__239E4DCF]  DEFAULT ('') FOR [notes]
GO
ALTER TABLE [dbo].[remote_sql_log] ADD  CONSTRAINT [DF_remote_sql_log_bywho]  DEFAULT (suser_sname()) FOR [bywho]
GO
ALTER TABLE [dbo].[remote_sql_log] ADD  CONSTRAINT [DF_remote_sql_log_applytime]  DEFAULT (getdate()) FOR [applytime]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_ip_or_dns]  DEFAULT ('') FOR [ip_or_dns]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_port_number]  DEFAULT ((1433)) FOR [port_number]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_username]  DEFAULT ('') FOR [username]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_pwd]  DEFAULT ('') FOR [pwd]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_db_provider]  DEFAULT ('MSSQL') FOR [db_provider]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_odbc_driver]  DEFAULT ('') FOR [odbc_driver]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_Option_str]  DEFAULT ('') FOR [connection_options]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_env_id]  DEFAULT ((0)) FOR [environment_options]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_max_threads]  DEFAULT ((10)) FOR [max_threads]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_ag_node]  DEFAULT ((0)) FOR [ag_node]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF__serverlis__isliv__267ABA7A]  DEFAULT ((0)) FOR [islive]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_type_options]  DEFAULT ((0)) FOR [instance_options]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_SQL_Version]  DEFAULT (N'{}') FOR [DB_Instance_Property]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_OS_version]  DEFAULT (N'{}') FOR [OS_Property]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF__serverlis__creat__2F10007B]  DEFAULT (getdate()) FOR [createdate]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF__serverlis__modif__300424B4]  DEFAULT (getdate()) FOR [modifydate]
GO
ALTER TABLE [dbo].[serverlist] ADD  CONSTRAINT [DF_serverlist_last_update]  DEFAULT (getdate()) FOR [last_update]
GO
ALTER TABLE [dbo].[sql_functions] ADD  CONSTRAINT [DF_SQLFunctions_db_type]  DEFAULT ('MSSQL') FOR [db_provider]
GO
ALTER TABLE [dbo].[sql_functions] ADD  CONSTRAINT [DF_SQLFunctions_active]  DEFAULT ((1)) FOR [enabled]
GO
ALTER TABLE [dbo].[sql_functions] ADD  CONSTRAINT [DF__SQLFuncti__modif__6EF57B66]  DEFAULT (getdate()) FOR [modify_date]
GO
ALTER TABLE [dbo].[sql_functions] ADD  CONSTRAINT [DF_sql_functions_modifiy_by]  DEFAULT (suser_sname()) FOR [modifiy_by]
GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO





CREATE         PROC [dbo].[UP_add_trusted_assembly]
 @clrname nvarchar(4000)=N'up_exec_remote_sql, version=0.0.0.0, culture=neutral, publickeytoken=41f433bef3edd586, processorarchitecture=msil',@dll_file varchar(4000)=null,
 @asmbin varbinary(max)=0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103009A54C7680000000000000000E00022200B01300000980000000600000000000056B600000020000000C00000000000100020000000020000040000000000000006000000000000000000010000020000F19D010003006085000010000010000000001000001000000000000010000000000000000000000004B600004F00000000C00000A80300000000000000000000000000000000000000E000000C000000CCB400001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E746578740000005C960000002000000098000000020000000000000000000000000000200000602E72737263000000A803000000C0000000040000009A0000000000000000000000000000400000402E72656C6F6300000C00000000E0000000020000009E0000000000000000000000000000400000420000000000000000000000000000000038B60000000000004800000002000500906A0000BC490000090000000000000000000000000000004CB400008000000000000000000000000000000000000000000000000000000000000000000000001B300600B90E00000100001100037201000070280E00000A810F00000172110000700A72110000700B730F00000A0C731000000A0D281100000A1304731200000A1305731300000A13067213000070731400000A130511056F1500000A0072490000700A110611056F1600000A001106066F1700000A0005130711072C0C00110411066F1800000A0000000011066F1900000A13093804030000007355000006130A110A1109110972A00100706F1A00000A6F1B00000A6F3800000600110A1109110972AE0100706F1A00000A6F1C00000A6F3400000600110A1109110972BE0100706F1A00000A6F1C00000A6F3600000600110A1109110972CE0100706F1A00000A6F1D00000A6F4600000600110A1109110972E40100706F1A00000A6F1D00000A6F4000000600110A1109110972F80100706F1A00000A6F1D00000A6F4800000600110A1109110972060200706F1A00000A6F1D00000A6F4200000600110A1109110972140200706F1A00000A6F1D00000A6F4E00000600110A11091109721E0200706F1A00000A6F1D00000A6F4A00000600110A1109110972360200706F1A00000A6F1D00000A6F4400000600110A11091109724A0200706F1A00000A6F1D00000A6F4C00000600110A11091109725C0200706F1A00000A6F1D00000A6F5200000600110A1109110972640200706F1A00000A6F1D00000A6F2C00000600110A1109110972800200706F1A00000A6F1D00000A6F3000000600110A1109110972920200706F1A00000A6F1D00000A6F2E00000600110A1109110972A60200706F1A00000A6F1D00000A6F5000000600110A1109110972CC0200706F1A00000A6F1D00000A6F3E00000600110A1109110972EE0200706F1A00000A6F1E00000A6F5400000600110A72FA0200706F3A00000600110A72110000706F3C0000060009110A6F1F00000A00110A6F2F0000067211000070282000000A130B110B2C6300732A00000625732100000A6F270000060025732200000A6F1D0000060013081108720A0300706F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00002B7807110A6F3D000006282000000A130C110C2C6500732A00000625732100000A6F270000060025732200000A6F1D000006001308110A6F3D0000060B1108076F29000006001108166F1F000006001108166F23000006001108166F21000006001108110A6F330000066F25000006000811086F2300000A00000011096F2400000A130D110D3AECFCFFFF11096F2500000A0000DDC3000000130E00110E6F2600000A130F110E6F2700000A13101613112B1D1110110F11116F2800000A6F2900000A282A00000A13101111175813111111110F6F2B00000A1759FE0216FE01131211122DCD0372120300701110282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A002038FFFFFF1313DD820A000013140003722803007011146F2700000A282A00000A280E00000A810F000001110403FE160F0000016F2900000A6F2C00000A0020D4FEFFFF1313DD430A00000000161315096F2D00000A1316282E00000A131700086F2F00000A131A2B7D121A283000000A131B0000096F3100000A131C2B4D121C283200000A131D00111D6F3D000006111B6F28000006283300000A2D13111B6F28000006720A030070283300000A2B0117131E111E2C1300111B111B6F1E00000617586F1F000006000000121C283400000A2DAADE0F121CFE160600001B6F3500000A00DC00121A283600000A3A77FFFFFFDE0F121AFE160500001B6F3500000A00DC384A0400000016131500086F2F00000A131F380F040000121F283000000A13200011206F1E00000616FE021321112139F10300000000096F3100000A132238BC0300001222283200000A13230011206F28000006720A030070283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132411243998010000000F00FE160F0000016F2900000A1123731400000613251125FE0615000006733700000A733800000A1326112611236F3700000613271227FE161C0000016F2900000A6F3900000A0011266F3A00000A0011206F1C00000611266F3B00000A0011236F53000006132811282C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151F325D16FE01132911292C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01132A112A3992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A132B1104112B6F2C00000A0020B80B0000283D00000A00000038D701000011236F3D00000611206F28000006283300000A2C2511236F3900000672FA020070283300000A2C1211206F2200000611206F24000006FE042B0116132E112E399301000000112311206F260000067319000006132F112FFE061A000006733700000A733800000A1330113011236F3700000613271227FE161C0000016F2900000A6F3900000A0011306F3A00000A0011206F1C00000611306F3B00000A0011236F53000006133111312C27001104724A03007011236F45000006726803007011236F47000006283C00000A6F2C00000A00001123726E0300706F3A00000600111617591316112011206F1E00000617596F1F00000600112011206F2200000617586F230000060011151758131511151F325D16FE01133211322C0D0020D0070000283D00000A000011206F2200000611206F24000006FE0416FE01133311333992000000001E8D470000012516282E00000A132C122C727E030070283E00000AA2251772A6030070A2251811206F2200000611206F2000000658132D122D283F00000AA2251972BE030070A2251A11206F28000006A2251B72E0030070A2251C11206F1E000006132D122D283F00000AA2251D72E6030070A2284000000A1334110411346F2C00000A0020B80B0000283D00000A000000001222283400000A3A38FCFFFFDE0F1222FE160600001B6F3500000A00DC11202812000006000000121F283600000A3AE5FBFFFFDE0F121FFE160500001B6F3500000A00DC2010270000283D00000A0000111616FE02133511353AA8FBFFFF096F2D00000A17FE02133611362C4A00282E00000A132C122C727E030070283E00000A7210040070096F2D00000A132D122D283F00000A722A040070283C00000A1337110411376F2C00000A0020B80B0000283D00000A0000282E00000A131708281100000613182B74000828110000061318282E00000A1117284100000A13391239284200000A230000000000003440FE02133811382C3900282E00000A1317282E00000A132C122C727E030070283E00000A72620400701218283F00000A284300000A133A1104113A6F2C00000A000020E8030000283D00000A0000111816FE02133B113B2D811104282E00000A132C122C727E030070283E00000A728C040070282A00000A6F2C00000A001104284400000A6F2C00000A00734500000A131900086F2F00000A133C38E3010000123C283000000A133D0038BB01000000113D6F26000006123E6F4600000A133F113F394D01000000113E6F4700000A6F4800000A16FE0213401140393101000000113D6F2800000672C40400706F4900000A1341114139910000000003113D6F28000006113E1105280A000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134211422C0A001FF61313DD5C03000003113D6F28000006113E1105280B000006280E00000A810F00000103710F0000017201000070280E00000A284A00000A284B00000A134311432C0A001FF61313DD1703000000388400000000001119113E176F4C00000A0000DE73134400031B8D470000012516282E00000A132C122C727E030070283E00000AA2251772C8040070A22518113D6F28000006A2251972D0040070A2251A11446F2700000AA2284000000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DD8E0200000000002B550003282E00000A132C122C727E030070283E00000A72C8040070113D6F2800000672FA040070283C00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FFB1313DD3402000000113D6F260000066F4D00000A16FE02134511453A2DFEFFFF00123C283600000A3A11FEFFFFDE0F123CFE160500001B6F3500000A00DC11196F4700000A6F4800000A16FE02134611462C14000311192807000006280E00000A810F00000100030911052809000006280E00000A810F0000011104282E00000A132C122C727E030070283E00000A724C050070282A00000A6F2C00000A001104282E00000A132C122C727E030070283E00000A727C05007003FE160F0000016F2900000A284300000A6F2C00000A0011066F4E00000A0011056F4F00000A0011056F4E00000A0003FE160F0000016F2900000A7201000070282000000A134711472C0900151313DD2E010000037201000070280E00000A810F000001161313DD1601000013480003728405007011486F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FEC1313DDD70000001349000372A405007011496F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE71313DD98000000134A000372D6050070114A6F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FE21313DE5C134B00114B6F2700000A134C114C72F40500706F5000000A16FE01134D114D2C3500037246060070114C282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001FCE1313DE061FC91313DE0011132A00000041240100000000007F00000031030000B00300008400000015000001000000007F00000031030000340400003F0000001700000102000000A50400005A000000FF0400000F0000000000000002000000900400008D0000001D0500000F00000000000000020000006A050000CF030000390900000F00000000000000020000003E05000022040000600900000F0000000000000000000000A60B00000F000000B50B0000730000001700000102000000B40A0000F6010000AA0C00000F0000000000000000000000740400002C090000A00D00003F0000001500000100000000740400002C090000DF0D00003F0000001E00000100000000740400002C0900001E0E00003C0000001F00000100000000740400002C0900005A0E00005C00000017000001133006002800000002000011000F00285100000A0F01285100000A1716161F1E735200000A285300000A285400000A0A2B00062A1B30020009010000030000110072110000700A0002285500000A0B072C2400725E0600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDD100000002285600000A16FE010D092C240072B20600700A281100000A066F2900000A6F2C00000A0006280E00000A0CDDA000000002285700000A0A06280E00000A0CDD8D00000013040072E206007011046F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE5E130500723407007011056F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE2F130600727607007011066F2700000A282A00000A0A281100000A066F2900000A6F2C00000A0006280E00000A0CDE00082A0000000128000000000700737A002F230000010000070073A9002F240000010000070073D8002F170000011B300500E302000004000011000E087211000070280E00000A810F0000010F01FE160F0000016F2900000A0A007357000006285800000A0020000C0000285900000A0017285A00000A0002285B00000A74250000010B07056F5C00000A000E04285500000A16FE01130411042C0B00070E046F5D00000A00000E07285500000A16FE01130511052C0B00070E076F5E00000A00000E06285500000A16FE01130611062C0B00070E066F5F00000A00000720307500006F6000000A0004285500000A16FE01130711072C5B0004178D5400000125161F3B9D6F6100000A13081613092B3300110811099A178D5400000125161F3D9D6F6100000A130A076F6200000A110A169A110A179A6F6300000A0000110917581309110911088E69FE04130B110B2DBF000572A8070070283300000A130C110C2C4300286400000A066F6500000A130D07110D8E696A6F6600000A00076F6700000A130E00110E110D16110D8E696F6800000A0000DE0D110E2C08110E6F3500000A00DC00076F6900000A74260000010C0E05285500000A16FE01130F110F2C1700086F6A00000A0E05286B00000A736C00000A0D002B0E00086F6A00000A736D00000A0D00086F6E00000A20C80000002E12086F6E00000A20C9000000FE0116FE012B0116131011102C31000E0872B2070070086F6E00000A8C59000001096F6F00000A287000000A280E00000A810F0000011FCE1311DDDB0000000E080E08710F000001096F6F00000A280E00000A287100000A810F000001161311DDB500000013120011126F7200000A75260000011313111314FE03131411142C5F0011136F6A00000A13151115736D00000A1316000E0872B207007011136F6E00000A8C5900000111166F6F00000A287000000A280E00000A810F00000100DE0D11162C0811166F3500000A00DCDE0D11152C0811156F3500000A00DC002B15000E0811126F2700000A280E00000A810F000001001F9C1311DE1F1317000E0811176F2700000A280E00000A810F0000012038FFFFFF1311DE0011112A00417C0000020000004C010000130000005F0100000D00000000000000020000005A0200002D000000870200000D00000000000000020000005102000045000000960200000D0000000000000000000000200000000B0200002B020000960000002900000100000000200000000B020000C10200001F000000170000011B3003000901000005000011000002285500000A0A062C30000372EE070070280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9C0BDDCB0000000302285700000A280E00000A810F000001160BDDB30000000C00037240080070086F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A001F9B0BDE7A0D00037286080070096F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002037FFFFFF0BDE3E1304000372BC08007011046F2700000A282A00000A280E00000A810F000001281100000A03FE160F0000016F2900000A6F2C00000A002036FFFFFF0BDE00072A0000000128000000000100535400392300000100000100538D003C240000010000010053C9003E170000011B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011B300300410100000700001100140A02120028080000060B07737500000A0C281100000A0D09086F7600000A00166A13040000026F4700000A6F7700000A13052B7711056F7800000A742D000001130600161307086F7900000A175913082B3A00110611076F7A00000A130911092D06061107912B0116130A110A2C0B0011096F2900000A13090008110711096F7B00000A000011071758130711071108FE0216FE01130B110B2DB71104176A58130409086F7C00000A000011056F7D00000A2D80DE161105752E000001130C110C2C08110C6F3500000A00DC096F7E00000A000972260900701204287F00000A282A00000A6F2C00000A007201000070130DDE48130E00096F7E00000A00282E00000A13101210727E030070283E00000A7240090070110E6F2700000A284300000A130F281100000A110F6F2900000A6F2C00000A00110F130DDE00110D2A000000011C00000200340084B800160000000000002500D1F6004817000001133005006F0000000800001100026F8000000A6F4800000A8D2A0000010A03026F8000000A6F4800000A8D5D00000151160B026F8000000A6F4800000A17590C2B2400026F8000000A076F8100000A0D0607090350078F5D000001280F000006A2000717580B0708FE0216FE01130411042DCF0613052B0011052A001B3005001B020000090000110072010000700A036F8200000A0B000072780900700C00026F3100000A0D380F0100001203283200000A13040011046F390000067201000070282000000A130511052C5C00281100000A1B8D47000001251611046F45000006A2251772910A0070A2251811046F47000006A2251972950A0070A2251A11046F3B000006A2284000000A6F2C00000A00281100000A284400000A6F2C00000A0072AF0A00700A00080307738300000A13060011066F8400000A72BD0A007011046F2B0000066F8500000A2611066F8400000A72DB0A007011046F3B0000066F8500000A2611066F8400000A72F70A007011046F310000068C4A0000016F8500000A2611066F8400000A72150B007011046F370000068C1C0000016F8500000A2611066F8600000A2600DE0D11062C0811066F3500000A00DC001203283400000A3AE5FEFFFFDE0F1203FE160600001B6F3500000A00DC076F8700000A0000DDA900000013070011076F2600000A130811076F2700000A130916130A2B1D11091108110A6F2800000A6F2900000A282A00000A1309110A1758130A110A11086F2B00000A1759FE0216FE01130B110B2DCD72120300701109282A00000A0A281100000A066F2C00000A0006130CDE51130D00076F8800000A00282E00000A130E120E727E030070283E00000A72250B0070110D6F2700000A284300000A0A281100000A066F2C00000A0000DE0000DE0B072C07076F3500000A00DC06130C2B00110C2A00417C000002000000AA0000007A000000240100000D00000000000000020000001E00000022010000400100000F00000000000000000000000F0000004D0100005C0100006B00000015000001000000000F0000004D010000C70100003E00000017000001020000000E000000FA010000080200000B000000000000001B300400340300000A0000110072110000700A72110000700B140C738900000A25724F0B00706F8A00000A002572570B00706F8A00000A002572650B00706F8A00000A0025726D0B00706F8A00000A0025727F0B00706F8A00000A0025728B0B00706F8A00000A0025729D0B00706F8A00000A002572AD0B00706F8A00000A002572CF0B00706F8A00000A002572DB0B00706F8A00000A002572E50B00706F8A00000A0025726D0B00706F8A00000A002572FD0B00706F8A00000A000D0003120228080000061304001104130516130638F6010000110511069A1307001E8D47000001251606A22517720D0C0070A2251802A22519723D0C0070A2251A11076F8B00000AA2251B72470C0070A2251C02A2251D727B0C0070A2284000000A0A0911076F8C00000A13091209FE16310000016F2900000A6F8D00000A1308110839960000000011076F8C00000A13091209FE16310000016F2900000A72FD0B0070283300000A130A110A2C1C000672890C007011076F8B00000A728D0C0070283C00000A0A002B4D001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B72B10C0070A2284000000A0A000038EA0000000072B50C007011076F8E00000A130B120B287F00000A72BB0C007072C10C00706F8F00000A72C90C0070284300000A0B11076F8C00000A13091209FE16310000016F2900000A72CF0C0070283300000A130C110C2C4C001B8D47000001251672B50C0070A2251711076F9000000A130D120D289100000AA2251872DF0C0070A2251911076F9200000A130D120D289100000AA2251A72C90C0070A2284000000A0B001C8D47000001251606A2251772890C0070A2251811076F8B00000AA2251972AB0C0070A2251A11076F8C00000A13091209FE16310000016F2900000AA2251B07A2284000000A0A0000110617581306110611058E693FFFFDFFFF0604739300000A130E00110E6F8600000A2600DE0D110E2C08110E6F3500000A00DC7201000070130FDE3C131000282E00000A13121212727E030070283E00000A72E30C007011106F2700000A284300000A1311281100000A11116F2C00000A001111130FDE00110F2A4134000002000000D30200000C000000DF0200000D0000000000000000000000B100000044020000F50200003C000000170000011B3005002D0200000B00001100738900000A0A72190D00700272AA0D0070284300000A0B0704739300000A0C086F1900000A0D2B1A0006090972D60D00706F1A00000A6F1D00000A6F8A00000A0000096F2400000A130411042DDA096F2500000A00086F4E00000A00046F8200000A1305000072E00D00700272FC0D0070284300000A0B00066F9400000A13062B1E1206289500000A1307000772120E0070110772DF0C0070283C00000A0B001206289600000A2DD9DE0F1206FE160800001B6F3500000A00DC0716076F9700000A17596F9800000A72160E0070282A00000A0B00036F4700000A6F7700000A1308388F00000011086F7800000A742D00000113090007041105738300000A130A0000066F9400000A130B2B36120B289500000A130C00110A6F8400000A72120E0070110C282A00000A1109110C6F9900000A252D06267E9A00000A6F8500000A2600120B289600000A2DC1DE0F120BFE160800001B6F3500000A00DC110A6F8600000A2600DE0D110A2C08110A6F3500000A00DC0011086F7D00000A3A65FFFFFFDE161108752E000001130D110D2C08110D6F3500000A00DC11056F8700000A0000DE6B130E0011056F8800000A001B8D470000012516282E00000A13101210727E030070283E00000AA22517721A0E0070A2251802A2251972300E0070A2251A110E6F2700000AA2284000000A130F281100000A110F6F2C00000A00281100000A076F2C00000A00110F1311DE1900DE0D11052C0811056F3500000A00DC720100007013112B0011112A0000004194000002000000810000002B000000AC0000000F00000000000000020000000C010000430000004F0100000F00000000000000020000000201000067000000690100000D0000000000000002000000E3000000A2000000850100001600000000000000000000006600000040010000A60100006B000000170000010200000065000000AF010000140200000D0000000000000013300200220000000C0000110072400E00700F00FE16320000016F2900000A282A00000A739B00000A0A2B00062A0000133002001B0000000C00001100725E0E0070026F2900000A282A00000A739B00000A0A2B00062A001B300400F00000000D0000110000727C0E00700A0E040B072C6300056F9C00000A16FE010C082C07056F1500000A000305739300000A0D00096F8600000A2600DE0B092C07096F3500000A00DC05739D00000A1304001104046F9E00000A001104026F9F00000A0000DE0D11042C0811046F3500000A00DC061305DE7C00729A0E007073A000000A7A1306001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911066F2700000AA2251A72260F0070A2284000000A1305DE381307001B8D47000001251672F00E0070A2251704A2251872220F0070A2251911076F2700000AA2251A72260F0070A2284000000A1305DE0011052A0134000002002B000B36000B0000000002004900165F000D00000000000001007C7D003815000001000001007CB5003817000001133003007B0100000E00001100031652140A026FA100000A0B026FA200000A0C0728A300000A130411040D09451300000066000000CF00000041000000050000002200000093000000130000006E000000B50000007D000000BD00000088000000C60000009B000000570000004900000033000000FA000000A700000038F500000000081873A400000A0A38EF00000000081F1473A400000A0A38E000000000081F0C176A73A500000A0A38CF00000000081A73A400000A0A38C10000000018280C0000067A00081B73A400000A0A38AB00000000081F0973A400000A0A389C0000000016280C0000067A00081F1073A400000A0A388500000000081E73A400000A0A2B7A00081673A400000A0A2B6F001B280C0000067A00081F0D73A400000A0A2B5B00081F0C156A73A500000A0A2B4D001E280C0000067A001F0A280C0000067A001F0C280C0000067A0008020728100000060A0614FE01130511052C1500081F0C026FA600000A6A73A500000A0A031752002B080007280D0000067A0613062B0011062A0013300400850200000F00001100140A04D00900001B28A700000A2E2904D06600000128A700000A2E1C04D00A00001B28A700000A2E0F04D06700000128A700000AFE012B01170B072C1700021F15036FA600000A6A73A500000A0A00382802000004D00F00000128A700000AFE010C082C1200021F0C156A73A500000A0A00380502000004D06800000128A700000AFE010D092C1200021F15156A73A500000A0A0038E201000004D01C00000128A700000AFE01130411042C1000021F0E73A400000A0A0038BF01000004D00D00000128A700000AFE01130511052C1000021F1773A400000A0A00389C01000004D02200000128A700000AFE01130611062C0F00021873A400000A0A00387A01000004D06900000128A700000AFE01130711072C1000021F1473A400000A0A00385701000004D06A00000128A700000AFE01130811082C0F00021A73A400000A0A00383501000004D06B00000128A700000AFE01130911092C0F00021C73A400000A0A00381301000004D06C00000128A700000AFE01130A110A2C1000021F0E73A400000A0A0038F000000004D06D00000128A700000AFE01130B110B2C1000021F1073A400000A0A0038CD00000004D06E00000128A700000AFE01130C110C2C0F00021E73A400000A0A0038AB00000004D06F00000128A700000AFE01130D110D2C0F00021673A400000A0A00388900000004D07000000128A700000AFE01130E110E2C0D00021F0973A400000A0A002B6904D07100000128A700000AFE01130F110F2C1200021B7EA800000A1673A900000A0A002B4404D07200000128A700000AFE01131011102C0D00021F0D73A400000A0A002B2404D07300000128A700000AFE01131111112C0D00021F1973A400000A0A002B0400140A000613122B0011122A0000001B300200A90000001000001100160A160B160C00026F2F00000A0D2B761203283000000A130400160A160B0011046F1C0000066FAA00000A13052B2A120528AB00000A13060011066FAC00000A130711072C0C000617580A0817580C002B06000717580B0000120528AD00000A2DCDDE0F1205FE160B00001B6F3500000A00DC1104066F23000006001104076F2100000600001203283600000A2D81DE0F1203FE160500001B6F3500000A00DC0813082B0011082A000000011C000002002E003765000F0000000002000F008392000F000000001B300200630000001100001100160A160B00026F1C0000066FAA00000A0C2B24120228AB00000A0D00096FAC00000A130411042C08000617580A002B06000717580B0000120228AD00000A2DD3DE0F1202FE160B00001B6F3500000A00DC02066F230000060002076F21000006002A0001100000020012003143000F00000000220228AE00000A002A8A0272110000707D0B0000040228AE00000A000002047D0C00000402037D0B0000042A1B300600670A0000120000110072110000700A72110000700B1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72580F0070A2284000000A0C1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B72620F0070A2284000000A0D1C8D470000012516027B0B000004A22517722C0F0070A22518282E00000A13051205723E0F0070283E00000AA2251972540F0070A2251A027B0C0000046F3700000613061206FE161C0000016F2900000A72220F007072110000706F8F00000AA2251B726C0F0070A2284000000A130400027B0C00000472110000706F3C00000600027B0C00000472110000706F2C00000600027B0C0000046F2F00000672760F0070283300000A1308110839AC02000000027B0C0000046F4900000672860F0070283300000A1309110939FD0000000072920F00700A1C8D47000001251672A80F0070A22517027B0C0000046F3F000006A2251872DF0C0070A22519027B0C0000046F4D000006A2251A72C20F0070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A2251772CA0F0070A22518027B0C0000046F35000006130A120A283F00000AA2251972D20F0070A2251A08A2284000000A0B027B0C0000046F51000006285500000A130B110B2C10000772DA0F0070282A00000A0B002B46001C8D47000001251607A2251772E20F0070A22518027B0C0000046F4B000006A2251972EA0F0070A2251A027B0C0000046F51000006A2251B72F40F0070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A130C110C39920000000072041000700A1C8D4700000125167218100070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1B8D47000001251607A22517723A100070A22518027B0C0000046F4B000006A225197244100070A2251A027B0C0000046F51000006A2284000000A0B00027B0C0000046F49000006724C100070283300000A130D110D2C720072621000700A1C8D4700000125167274100070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B000772A0100070027B0C0000046F2D000006284300000A0B08027B0C0000046F41000006280E00000A281700000616FE03130E110E2C1700027B0C00000472AF0A00706F3A00000600DD240600000038D3030000027B0C0000046F2F00000672A4100070283300000A130F110F399B03000000027B0C0000046F4900000672860F0070283300000A13101110396C0100000072B61000700A72A0100070027B0C0000046F410000062816000006282A00000A0B027B0C0000046F2D000006285500000A131111112C5400027B0C0000046F2B0000067211000070282000000A131211122C20000772C6100070027B0C0000046F2B00000672DC100070283C00000A0B002B15000772C6100070110472DC100070283C00000A0B00002B140007027B0C0000046F2D000006282A00000A0B001F098D47000001251607A2251772E6100070A22518027B0C0000046F3F000006A2251972DF0C0070A2251A027B0C0000046F4D000006A2251B728C100070A2251C027B0C0000046F47000006A2251D72F0100070A2251E09A2284000000A0B027B0C0000046F51000006285500000A131311132C10000772FA100070282A00000A0B002B46001C8D47000001251607A225177202110070A22518027B0C0000046F4B000006A22519720C110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B0000027B0C0000046F4900000672F80F0070283300000A1314111439F600000000721A1100700A1C8D4700000125167236110070A22517027B0C0000046F3F000006A225187226100070A22519027B0C0000046F4D000006A2251A7230100070A2251B027B0C0000046F47000006A2284000000A0B1C8D47000001251607A22517723E110070A22518027B0C0000046F4B000006A225197246110070A2251A027B0C0000046F51000006A2251B7216110070A2284000000A0B027B0C0000046F2B0000067211000070282000000A131511152C1B00077250110070027B0C0000046F2B000006284300000A0B002B0F0007725011007008284300000A0B000772A0100070027B0C0000046F2D000006284300000A0B00027B0C0000046F49000006724C100070283300000A1316111639C40000000072721100700A1C8D470000012516728A110070A22517027B0C0000046F3F000006A225187282100070A22519027B0C0000046F4D000006A2251A728C100070A2251B027B0C0000046F47000006A2284000000A0B0772E20F0070027B0C0000046F4B0000067296100070283C00000A0B07729411007008284300000A0B027B0C0000046F2B0000067211000070282000000A131711172C1B00077294110070027B0C0000046F2B000006284300000A0B002B0F0007729411007008284300000A0B00000772A0100070027B0C0000046F2D000006284300000A0B002B1A00027B0C0000046F410000060A027B0C0000046F2D0000060B0073AF00000A25066FB000000A0025076FB100000A0025176FB200000A0025176FB300000A0025176FB400000A0025166FB500000A0025176FB600000A00130773B700000A131800111811076FB800000A0011186FB900000A26027B0C0000046F4900000672860F0070282000000A2C17027B0C0000046F2F000006729E110070282000000A2B0116131B111B2C260008285700000A131C11186FBA00000A111C6FBB00000A0011186FBA00000A6FBC00000A000011186FBD00000A6F6F00000A131911186FBE00000A6F6F00000A131A11186FBF00000A0011186FC000000A16FE01131D111D2C6400027B0C00000472010000706F3A00000600027B0C0000046F2B000006285500000A131E111E2C36001104285600000A131F111F2C1700027B0C0000041104285700000A6F2C00000600002B1000027B0C00000411196F2C00000600000000388000000000111A285500000A132011202C3B0009285600000A132111212C2B00027B0C000004027B0C0000046F3B00000609285700000A282A00000A6F3C000006000928C100000A0000002B1000027B0C000004111A6F3C0000060000027B0C0000046F3B000006285500000A132211222C1000027B0C00000411196F3C00000600000008285600000A132311232C09000828C100000A000000DE0D11182C0811186F3500000A00DC00DE19132400027B0C00000411246F2700000A6F3C0000060000DE00027B0C0000046F3B000006285500000A132511252C1500027B0C00000472010000706F3A00000600002B1300027B0C00000472AF0A00706F3A00000600002A004134000002000000610800009E010000FF0900000D00000000000000000000005B010000B40800000F0A000019000000170000011330040043000000130000110072F40F00700272AC11007072110000706F8F00000A72B011007072110000706F8F00000A72F40F007072B41100706F8F00000A72F40F0070284300000A0A2B00062A001B3002001F010000060000110072110000700A0002285500000A0B072C2D0072EE070070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A001F9C0CDDDE0000000F01287300000A0D092C300072E2080070280E00000A1001281100000A0F01FE160F0000016F2900000A6F2C00000A002038FFFFFF0CDDA3000000020F01FE160F0000016F2900000A287400000A00160CDD88000000130400724008007011046F2700000A282A00000A0A281100000A066F2C00000A001F9B0CDE62130500728608007011056F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002037FFFFFF0CDE3113060072BC08007011066F2700000A282A00000A0A06280E00000A1001281100000A066F2C00000A002036FFFFFF0CDE00082A0001280000000007008E95002623000001000007008EBB003124000001000007008EEC0031170000011330040037000000140000110002285500000A0A062C0872BA1100700B2B2272F40F00700272F40F007072B41100706F8F00000A72F40F0070284300000A0B2B00072A001330020047000000000000000228AE00000A000002037D1300000402036F470000067D1400000402036F490000067D1500000402036F410000067D1600000402047D1800000402036F350000067D170000042A001B3006006B0D0000150000110002027B130000046F410000067D16000004027B13000004166F3200000600027B1300000472110000706F3C0000060002027B130000046F490000067D15000004734500000A0A734500000A0B027B15000004724C100070283300000A0C0839BD030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A7216120070A2251F0B027B130000046F51000006A2251F0C72B10C0070A2251F0D027B130000046F4F000006A2284000000A0D0973C200000A1304000011046F1500000A00027B16000004110473C300000A1305001105027B170000046FC400000A0011056FC500000A1306381201000000734500000A1307110711066FC600000A00110714FE031308110839C50000000011076F8000000A72221200706FC700000A130911092C7A000011076F4700000A6F7700000A130A2B44110A6F7800000A742D000001130B00027B13000004027B130000046F3B000006110B72221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000110A6F7D00000A2DB3DE16110A752E000001130C110C2C08110C6F3500000A00DC002B3000071107176F4C00000A00027B13000004027B130000046F3100000611076F4700000A6F4800000A586F320000060000002B2C00723C120070130D027B13000004027B130000046F3B000006110D284400000A284300000A6F3C00000600000011066FC800000A16FE01130E110E3ADBFEFFFF00DE0D11052C0811056F3500000A00DC00DD46010000130F007260120070131016131138B9000000001F0C8D4700000125161110A22517727E120070A225181211283F00000AA22519728E120070A2251A110F6FC900000A11116FCA00000A6FCB00000AA2251B72A4120070A2251C110F6FC900000A11116FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E110F6FC900000A11116FCA00000A6FCD00000AA2251F0972D6120070A2251F0A110F6FC900000A11116FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A1310001111175813111111110F6FC900000A6FCF00000AFE04131311133A2EFFFFFF027B13000004027B130000046F3B0000061110284400000A284300000A6F3C0000060000DE3C13140072E412007011146F2700000A282A00000A1315027B13000004027B130000046F3B0000061115284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02131611162C17000207281B00000600027B18000004076FD000000A000011046F4F00000A0011046F4E00000A0000DC00DE0D11042C0811046F3500000A00DC00027B1500000472F80F0070283300000A1317111739CE030000001F0E8D47000001251672C0110070A22517027B130000046F43000006A2251872D2110070A22519027B130000046F3F000006A2251A72E6110070A2251B027B14000004A2251C72FC110070A2251D027B130000046F4B000006A2251E7208120070A2251F09027B130000046F4D0000066F2900000AA2251F0A72FE120070A2251F0B027B130000046F51000006720C13007072101300706F8F00000AA2251F0C7216130070A2251F0D027B130000046F4F000006A2284000000A1318111873C200000A1319000011196F1500000A00027B16000004111973C300000A131A00111A027B170000046FC400000A00111A6FC500000A131B381201000000734500000A131C111C111B6FC600000A00111C14FE03131D111D39C500000000111C6F8000000A72221200706FC700000A131E111E2C7A0000111C6F4700000A6F7700000A131F2B44111F6F7800000A742D000001132000027B13000004027B130000046F3B000006112072221200706F9900000A252D0426142B056F2900000A282A00000A6F3C0000060000111F6F7D00000A2DB3DE16111F752E000001130C110C2C08110C6F3500000A00DC002B300007111C176F4C00000A00027B13000004027B130000046F31000006111C6F4700000A6F4800000A586F320000060000002B2C00723C1200701321027B13000004027B130000046F3B0000061121284400000A284300000A6F3C000006000000111B6FC800000A16FE01132211223ADBFEFFFF00DE0D111A2C08111A6F3500000A00DC00DD460100001323007260120070132416132538B9000000001F0C8D4700000125161124A22517727E120070A225181225283F00000AA22519728E120070A2251A11236FC900000A11256FCA00000A6FCB00000AA2251B72A4120070A2251C11236FC900000A11256FCA00000A6FCC00000A13121212283F00000AA2251D72C2120070A2251E11236FC900000A11256FCA00000A6FCD00000AA2251F0972D6120070A2251F0A11236FC900000A11256FCA00000A6FCE00000AA2251F0B72AC110070A2284000000A132400112517581325112511236FC900000A6FCF00000AFE04132611263A2EFFFFFF027B13000004027B130000046F3B0000061124284400000A284300000A6F3C0000060000DE3C13270072E412007011276F2700000A282A00000A1328027B13000004027B130000046F3B0000061128284400000A284300000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02132911292C17000207281B00000600027B18000004076FD000000A000011196F4F00000A0011196F4E00000A0000DC00DE0D11192C0811196F3500000A00DC00027B1500000472860F0070283300000A132A112A390B05000000001873D100000A132B00731200000A132C027B130000046F51000006285500000A132D112D2C71001E8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C725A130070A2251D027B130000046F4F000006A2284000000A731400000A132C00389C000000001F0C8D470000012516721C130070A22517027B130000046F3F000006A2251872DF0C0070A22519027B130000046F4D000006A2251A7236130070A2251B027B130000046F47000006A2251C72C2130070A2251D027B130000046F4B000006A2251E7208140070A2251F09027B130000046F51000006A2251F0A7220140070A2251F0B027B130000046F4F000006A2284000000A731400000A132C000000112C6F1500000A0016132E14132F112C6FD200000A13301130027B160000046F1700000A001130027B170000046FC400000A00027B1600000472261400706F4900000A133211322C280017132E11306F8400000A724E1400701F1620C80000006FD300000A132F112F186FD400000A000011306F1900000A1331380701000000734500000A1333113311316FC600000A00113314FE031334113439C50000000011336F8000000A726A1400706FC700000A133511352C7A000011336F4700000A6F7700000A13362B4411366F7800000A742D000001133700027B13000004027B130000046F3B0000061137726A1400706F9900000A252D0426142B056F2900000A282A00000A6F3C000006000011366F7D00000A2DB3DE161136752E000001130C110C2C08110C6F3500000A00DC002B3000071133176F4C00000A00027B13000004027B130000046F3100000611336F4700000A6F4800000A586F320000060000002B2100723C1200701338027B130000041138284400000A282A00000A6F3C00000600000011316FC800000A16FE01133911393AE6FEFFFF112E133A113A2C6A00112F6FD500000A756100000114FE0316FE01133B113B2C5000112F6FD500000A7447000001728E140070282000000A133C113C2C32007292140070112F6FD500000A7447000001282A00000A133D027B13000004113D284400000A282A00000A6F3C0000060000000000DDB8000000133E007211000070133F113E6FD600000A1FFEFE01134011402C0B0072B4140070133F002B150072EC140070113E6F2700000A282A00000A133F00027B13000004113F284400000A282A00000A6F3C0000060000DE62134100720815007011416F2700000A282A00000A1342027B130000041142284400000A282A00000A6F3C0000060000DE31134300723E15007011436F2700000A282A00000A1344027B130000041144284400000A282A00000A6F3C0000060000DE00DE3E00076F8000000A6F4800000A16FE02134511452C17000207281B00000600027B18000004076FD000000A0000112C6F4F00000A00112C6F4E00000A0000DC00DE0D112B2C08112B6F3500000A00DC00DDB4000000134600725415007011466F2700000A282A00000A1347027B13000004027B130000046F3B0000061147284400000A284300000A6F3C0000060000DE78134800728E15007011486F2700000A282A00000A1349027B13000004027B130000046F3B0000061149284400000A284300000A6F3C0000060000DE3C134A0072BA150070114A6F2700000A282A00000A134B027B13000004027B130000046F3B000006114B284400000A284300000A6F3C0000060000DE0000027B130000046F3B000006285500000A134C114C2C1500027B1300000472010000706F3A00000600002B1300027B1300000472AF0A00706F3A00000600002A0041FC0100020000009701000051000000E80100001600000000000000020000003201000045010000770200000D00000000000000000000001A010000700100008A0200000A0100003F000001000000001A01000070010000940300003C00000017000001020000001A010000B8020000D20300003E000000000000000200000019010000FA020000130400000D00000000000000020000007E05000051000000CF05000016000000000000000200000019050000450100005E0600000D00000000000000000000000105000070010000710600000A0100003F0000010000000001050000700100007B0700003C000000170000010200000001050000B8020000B90700003E000000000000000200000000050000FA020000FA0700000D00000000000000020000001F0A000051000000700A00001600000000000000000000005709000012020000690B00005600000015000001000000005709000012020000BF0B00003100000042000001000000005709000012020000F00B000031000000170000010200000057090000CC020000230C00003E00000000000000020000002B08000039040000640C00000D00000000000000000000002208000055040000770C00003C0000001E000001000000002208000055040000B30C00003C0000001F000001000000002208000055040000EF0C00003C0000001700000113300200730000001600001100036F8000000A72A00100706FC700000A16FE010B072C5A0072A001007073D700000A0A0672D015007028D800000A6FD900000A0006176FDA00000A0006027B130000046F370000068C1C0000016FDB00000A0006166FDC00000A00036F8000000A066FDD00000A0006166FDE00000A00002A00133001000C0000001700001100027B1F0000040A2B00062A260002037D1F0000042A0000133001000C0000001800001100027B1C0000040A2B00062A260002037D1C0000042A0000133001000C0000001800001100027B1B0000040A2B00062A260002037D1B0000042A0000133001000C0000001800001100027B1A0000040A2B00062A260002037D1A0000042A0000133001000C0000001800001100027B190000040A2B00062A260002037D190000042A0000133001000C0000001900001100027B1E0000040A2B00062A260002037D1E0000042A0000133001000C0000001300001100027B1D0000040A2B00062A260002037D1D0000042A0000133001000C0000001300001100027B310000040A2B00062A260002037D310000042A0000133001000C0000001300001100027B2C0000040A2B00062A260002037D2C0000042A0000133001000C0000001300001100027B2B0000040A2B00062A260002037D2B0000042A0000133001000C0000001800001100027B230000040A2B00062A260002037D230000042A0000133001000C0000001800001100027B210000040A2B00062A260002037D210000042A0000133001000C0000001800001100027B220000040A2B00062A260002037D220000042A0000133001000C0000001A00001100027B200000040A2B00062A260002037D200000042A0000133001000C0000001300001100027B2A0000040A2B00062A260002037D2A0000042A0000133001000C0000001300001100027B300000040A2B00062A260002037D300000042A0000133001000C0000001300001100027B330000040A2B00062A260002037D330000042A0000133001000C0000001300001100027B2D0000040A2B00062A260002037D2D0000042A0000133001000C0000001300001100027B2F0000040A2B00062A260002037D2F0000042A0000133001000C0000001300001100027B280000040A2B00062A260002037D280000042A0000133001000C0000001300001100027B240000040A2B00062A260002037D240000042A0000133001000C0000001300001100027B260000040A2B00062A260002037D260000042A0000133001000C0000001300001100027B270000040A2B00062A260002037D270000042A0000133001000C0000001300001100027B250000040A2B00062A260002037D250000042A0000133001000C0000001300001100027B320000040A2B00062A260002037D320000042A0000133001000C0000001300001100027B2E0000040A2B00062A260002037D2E0000042A0000133001000C0000001300001100027B290000040A2B00062A260002037D290000042A0000133001000C0000001B00001100027B340000040A2B00062A260002037D340000042A3E02167D340000040228AE00000A002A000013300100070000001B00001100170A2B00062A0042534A4201000100000000000C00000076342E302E33303331390000000005006C00000064140000237E0000D01400002C16000023537472696E677300000000FC2A0000E815000023555300E4400000100000002347554944000000F4400000C808000023426C6F620000000000000002000001571FA2090902000000FA013300160000010000007B0000000700000034000000570000005600000001000000DE00000010000000110000001B000000020000001C000000380000000B00000001000000040000000100000000005A09010000000000060041079F0F0600AE079F0F06007706300F0F00BF0F000006008B06F20A06002407F20A0600F006F20A06009507F20A06006107F20A06007A07F20A0600B806F20A0600D306F20A06008512070A0A00A206680E0A007108DD0F06001100B1010A001705680E0A00BC0B09130A00610209130A00840D09130A006D0C09130A006C0B09130600CD0C070A0600F904070A0A008B03580143001F0F00000600D101540806001F02070A0600240A070A0E00350CBF1006007A0C070A1200CE0FE6040A000F07680E0A000E0ADD0F0600A90C070A06000E0CF6001200001494121200F60594120600A00DF6000600DB09F60012001A0C94120A006401680E0A008D02680E0600100FD3100A004015580106009503070A0A00320A58010A00D20A09130A00820558010600CA02070A0600BC05070A0A00BA15091312007015941212008A1394120600200603101200041494121200350D300F1200DA11300F1200010050130A00AD0BA0010A004702A0010A00750DA0010A00270CA0010E001F05BF100A00250E091306008F0C070A0A002D15680E0A00A00B090D0A003D02090D0A00680D090D06008D08070A0A00070F09130600CB13540806002400070A06001F13070A0A007F0B58010A00CE05580112003A13440912006A15A01012002811A0100600DE03F6001200050E941212008C05941206004C0D070A12002D0B94121200040BF50106006808F8141200FA0594121200E20294120600AD0DF60006002D00070A0A00180B580106001C0A070A0A00410B09130A00C40A090D0600E307070A06007509070A0600C50C070A0A005A0658010600510C070A0600AB03070A0A003110DD0F0A007A11DD0F0A00D815DD0F0A00E007DD0F0A00F604DD0F0A00A103DD0F0A001402DD0F0A003300DD0F0A001800DD0F0A002A00DD0F0A00B115DD0F0A002309DD0F0A00CF03DD0F0A008709DD0F0600320EF60006003F0EF6000A005C0D58010A00580BA0010A00C10EA0010E00F70BBF100A00190E090D0A00D80B5801000000004500000000000100010001001000F20F0000350001000100000010008200000035000600140000001000E000000035000D0019000000100027010000350019001C0000001000E90C0000350020002B0002001000991500003500350056005180A300F2065180F000F20651809D00F2065180D211F2065180E101F2065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100F80DF2060100D70CF5065180A300F2065180F000F20651809D00F2065180D211F2065180E101F2060100C311F9060100D70CF50601004E00F2060100B80DF2060100A900F20601005714020701008F11F9060100790F020701005D10020701007311020701008110020701002104F20601004D01F90601005311050701007A000D070100790F020701002F1402070100691202070100DA04F2060100B204F20601009304F2060100EC0DF2060100600EF20601009B02F20601003612F20601004A05F2060100FE11F20601001C01F20601001411F2060100EB00F2060100B30EF2060100B214F2060100FA13F20601005503F2060100C10811075020000000009600A709140701003C30000000009600C808940105007030000000009600E603A7000700B0310000000096000C091F0708001C35000000009600E3032F0711005C36000000009600D90337071300B03700000000910087033E0715001C3900000000910070014407160098390000000091006E13500718003C3C00000000910068035C071A00B03F00000000910079035C071D008042000000009100B30265072000B0420000000091006E056D072100D842000000009100C6157507220008440000000091003D0A800727009045000000009100530A8B07290024480000000091005B0F98072C00F8480000000091006A0FA2072D0078490000000086182A0F06002E0081490000000086182A0FA8072E00A449000000008600DA11060030004C54000000009100E215E00130009C54000000009100D90337073100F0550000000091002B13E001330034560000000086182A0FAF0734008856000000008600DA1106003600FC650000000081005900060436007C660000000086083511BC07370094660000000086084411C5073700A066000000008608671020013800B866000000008608741001003800C4660000000086085F1120013900DC66000000008608691101003900E866000000008608431020013A000067000000008608501001003A000C67000000008608430F20013B0024670000000086084F0F01003B0030670000000086083101CF073C0048670000000086083F01D9073C00546700000000860801040F013D006C67000000008608110410003D0078490000000086182A0F06003E0078670000000086088E140F013E009067000000008608A01410003E009C67000000008608E2110F013F00B467000000008608F01110003F00C06700000000860830050F014000D8670000000086083D0510004000E467000000008608471220014100FC670000000086085812010041000868000000008608430F2001420020680000000086084F0F010042002C68000000008608171420014300446800000000860823140100430050680000000086086400E407440068680000000086086F00E9074400746800000000860820120F0145008C680000000086082B12100045009868000000008608910E0F014600B068000000008608A20E10004600BC6800000000860829030F014700D4680000000086083F0310004700E06800000000860800010F014800F8680000000086080E01100048000469000000008608BE000F0149001C69000000008608C6001000490028690000000086084A0E0F014A004069000000008608550E10004A004C69000000008608BC040F014B006469000000008608CB0410004B0070690000000086087D040F014C008869000000008608880410004C009469000000008608CE0D0F014D00AC69000000008608DD0D10004D00B86900000000860863040F014E00D069000000008608700410004E00DC69000000008608E8130F014F00F469000000008608F11310004F00006A000000008608E6100F015000186A000000008608FD1010005000246A0000000086088D000F0151003C6A000000008608950010005100486A000000008608AD0806015200606A000000008608B708D30452006A6A0000000086182A0F060053007C6A00000000E601DB12EF07530078490000000086182A0F0600570000000100F90D02000200A20800000300820F00000400C208000001002815000002009C0A00000100A90400000100B70900000200821300000300A11100000400860200000500C10500000600FE0200000700C41300000800FF12020009001C0D00000100A904020002008F0100000100A904000002008F01000001009112000001009112000002007B0800000100091200000200760A000001009B0400000200911200000300760A000001009B0400000200911200000300760A00000100000300000100A10500000100911200000200A309000003003D04000004007C0A10100500CE00000001006F0A000002007B0800000100E104000002006F0A00000300A10500000100C41200000100CF1200000100F90D00000200FA0C00000100B60000000100A904000002008F01000001009E0800000100FA0C000002009811000001008C12000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001001908000001009713000002003006000003000F1400000400E2090700D50009002A0F010011002A0F060019002A0F0A0029002A0F100031002A0F100039002A0F100041002A0F100049002A0F100051002A0F100059002A0F100061002A0F100071002A0F060009012A0F060079009F12A7000C002A0F060014002A0F060019020E05BB0091002A0F060099002A0F060091002A0F100021022D0A06009900910BC00029020415100089006C02C6009900920DCC0031022E09D10031021C02D60031022100DC0031028A08E1003102190AE6001400DD01EB0039020F16F1001C002A0F060024002A0F06000C00DD01EB003102CC010601310212060600A900B8110A01B90005030F01B100F5091301690081080F01390277121A01B100A01320018900760210001400A0132001C100381524010C001C0F29012C004413390114001C0F290134004413390139020316F1003400EF1406017101180606002C00EF14060149022A0F4501D9002A0F4B01D900F8031000D900E21306002400DD01EB00390277125201D900460D5A01C10081085F01510281080F01390277126401C100B50A6A01E9008E0F7301390277127701590202057E01C9002A0F06001C0017038201C9003E1289016902A0132001390201098F0179000F169401110140089E01C9001103A5011C00A013200171021806060021021206060039028B108F017900E8070F01E9002A0FB2017902CE08B90111019F12C40139021D16DB0189021912DB0189021415E00191028315140291028E091B0291021F082202C1013C062702C1017B021000C101B10510002901F11210002901B9131000C101381401003902AB122E02C10183113502B102FE093B02B9023C004102B9023A104702C101E1084D02C101D1095202410171065802C10106066002C102BF095202B9026508660239012A0F6D0239012A0F77023101D3027E02D10224020F0139027E1284027900EB0B8B024901E905600279007C09060189022015B00259012A0FD9028900D713E10269021C0FE80261014413EE025901AA1320016901F509F2025901FF07F70289004815E1026101EF14060189002E020600D90281080F01C90094100E03E102F50914039100E10A3A0399002A0F40039900A9114A03F102F20750032902F3152001F902B1120600F9021A0906003C002A0F06003C00DD01EB005101EF030F0151017E0586033C008B108C035101F30892033902A00296035101810A9C03010381080F0151011F039C0399002A0FA0033C001C0F29014400441339014400EF1406013902D608200139029408DB036901F509E10309031308E60311032A0F1000210250060004A1012A0FC000A1012E041000A101830E060421032A0F1000790154052004790154040F019901C702260451012A0F2F0451012A0F37047901F30820019901BD035D0489038F0A690451012A0F6C0424001C0F29015C0044133901D900480806015C00EF14060169002A0F0600C9012A0F0600C90147041000C901F0111000C9017414D304C901D414D304C901DD0ED304C901CC07D304C9015715D304D1012A0F0600D101270DD804D101E2130601D1016214DF04A90371061000A90312060600D101C114E504D101CB0EE504D101B8120600D101F102200189026A06EB04E1012A0F1000E9012A0F7D05290244140100E901920D8505C900D8018B05E1028B108F013102E8010601F901B8119205B903F5099805C10305030F01C103F70E2001C103A8020F01C10343060F01B903A01320011C00DD01EB0001022A0F9F0591005302A605F102DD01AB05D103CA0BB605D103E807EE02A900510D200179012A0F10009901A905C40579016105CB0579016C09D30479010808D20579013508D304E102DD01D7057901390901000E000400A9060E000800B4060E000C00BF060E001000D4060E001400E3060E001800A9060E001C00B4060E002000BF060E002400D4060E002800E3060E003400A9060E003800B4060E003C00BF060E004000D4060E004400E30602009900F006200063009D082E000B0021082E0013002A082E001B0049082E00230052082E002B0065082E00330065082E003B006B082E0043007D082E004B006B082E00530065082E005B00900840006B00A20860006B00A208800063009D08A00063009D08C00063009D081500AC01CB01E5019402A102B602FD021B035803A703EB03F0030C04400476049504A304F004F404F904BD05DE05E705EB05F505FA05050001000600080000005411FD0700008210060800007411060800005E10060800007A0F060800004E010A080000220414080000B31414080000FF11140800004B05140800006A12060800007A0F060800003014060800007B0018080000371214080000B40E140800005603140800001D0114080000F20014080000610E14080000DB0414080000940414080000ED0D14080000740414080000FB1314080000151114080000990014080000BB081D0802001C00030001001D00030002001E00050001001F000500020020000700010021000700020022000900010023000900020024000B00010025000B00020026000D00010027000D00020028000F00010029000F0002002B00110001002C00110002002D00130001002E00130002002F001500010030001500020031001700010032001700020033001900010034001900020035001B00010036001B00020037001D00010038001D00020039001F0001003A001F0002003B00210001003C00210002003D00230001003E00230002003F002500010040002500020041002700010042002700020043002900010044002900020045002B00010046002B00020047002D00010048002D00020049002F0001004A002F0002004B00310001004C00310002004D00330001004E00330002004F003500010050003500020051003700010052003700020053003900010054003900AD00B400F700FF0032013E018003D5035A0466048E04048000000100000000000000010000000706A70A0000040000000000000000000000FE05970100000000040000000000000000000000FE05580100000000040000000000000000000000FE05BF1000000000040000000000000000000000FE05070A00000000070002000000000000436F6E63757272656E744261676031004C69737460310053716C496E74333200476574496E7433320053716C496E7436340053716C496E743136006765745F55544638003C4D6F64756C653E0073457865637574654442004164645F52756E5F4944006765745F52756E5F4944007365745F52756E5F4944007652756E5F49440045786563757465434D44006765745F505744007365745F50574400504753514C004D5353514C0073457865637574655453514C005468655F53514C006765745F53514C007365745F53514C00636F6E6E656374696F6E5479706553514C004578656375746553514C007653514C004D7953514C0053797374656D2E494F006765745F49505F6F725F444E53007365745F49505F6F725F444E53007649505F6F725F444E530052657475726E5F4454006765745F526573756C745F4454007365745F526573756C745F44540076526573756C745F44540053797374656D2E446174610053716C4D657461446174610045787472616374446174615461626C65436F6C756D6E4D657461446174610074686564617461006D73636F726C69620053797374656D2E446174612E4F6462630053797374656D2E436F6C6C656374696F6E732E47656E65726963005265616400546872656164004C6F616400416464006661696C6564006765745F4973436C6F7365640053797374656D2E436F6C6C656374696F6E732E5370656369616C697A65640053716C4775696400476574477569640052656164546F456E640053656E64526573756C7473456E64004462436F6D6D616E64004F646263436F6D6D616E6400437265617465436F6D6D616E640053716C436F6D6D616E640045786563757465416E6453656E64007365745F4D6574686F64006D6574686F640053716C446174615265636F72640076507764005265706C616365006765745F536F7572636500496E76616C69644461746154797065436F64650047657454797065436F6465006765745F537461747573436F64650048747470537461747573436F6465006765745F45786974436F646500656E636F6465006765745F4D657373616765004D657267650054727954616B65006765745F5363616C65006765745F5265737475726E5F544D505F5461626C65007365745F5265737475726E5F544D505F5461626C6500765265737475726E5F544D505F5461626C6500416C7465725F54656D705F5461626C65004C6F6164446174615461626C650053656E64446174615461626C650049446973706F7361626C650053716C446F75626C650052756E74696D655479706548616E646C65004765745479706546726F6D48616E646C650053716C53696E676C6500577269746546696C650075705F7265616466696C65006765745F4E616D65007365745F4E616D65006765745F526573756C745F4E616D65007365745F526573756C745F4E616D650076526573756C745F4E616D65007365745F44657374696E6174696F6E5461626C654E616D65007365745F46696C654E616D65006765745F436F6C756D6E4E616D65006765745F557365724E616D65007365745F557365724E616D65006765745F44426E616D65007365745F44426E616D65007644426E616D6500746D707461626C655F6E616D650066696C656E616D650076557365726E616D65006765745F5365727665726E616D65007365745F5365727665726E616D6500765365727665726E616D650053797374656D2E4E65742E4D696D650053716C4461746554696D65006765745F4E65774C696E65006765745F506970650053716C50697065005472616E73616374696F6E53636F7065006765745F434D445F54797065007365745F434D445F547970650076434D445F54797065006765745F4461746154797065007365745F446174615479706500556E6B6E6F776E4461746154797065006765745F53716C44625479706500536563757269747950726F746F636F6C5479706500636C72547970650047657454797065007365745F436F6E74656E745479706500636F6E74656E745F7479706500496E7465726E616C44617461436F6C6C656374696F6E42617365006765745F526573706F6E73650048747470576562526573706F6E736500476574526573706F6E736500436C6F736500446973706F73650058353039436572746966696361746500636572746966696361746500437265617465006765745F53514C5374617465006765745F537461746500436F6E6E656374696F6E53746174650044656C6574650057726974650044656275676761626C6541747472696275746500417373656D626C795469746C654174747269627574650053716C50726F63656475726541747472696275746500417373656D626C7954726164656D61726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E4174747269627574650053716C46756E6374696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465007365745F5573655368656C6C457865637574650053716C42797465006765745F56616C7565004164645769746856616C75650053657456616C7565007365745F44656661756C7456616C75650076616C7565007365745F457870656374313030436F6E74696E7565007365745F556E69717565006F705F54727565006765745F4973416C6976650053797374656D2E546872656164696E6700476574456E636F64696E670053716C537472696E6700636F65726365546F537472696E6700476574537472696E6700537562737472696E67006172670052657475726E5F4D7367006765745F4465627567007365745F4465627567007664656275670052656745785F49734D61746368006765745F4C656E677468007365745F436F6E74656E744C656E677468006765745F4D61784C656E67746800537461727473576974680063616C6C5F726573745F61706900526F6C6C6261636B0053716C446563696D616C004765744F7264696E616C005365744F7264696E616C0053797374656D2E436F6D706F6E656E744D6F64656C0064625F6175746F6D6174696F6E2E646C6C007365745F416C6C6F7744424E756C6C006765745F49734E756C6C0053716C586D6C007365745F536563757269747950726F746F636F6C0053716C00657865635F72656D6F74655F73716C006170695F75726C00476574526573706F6E736553747265616D004765745265717565737453747265616D00636572746966696361746550726F626C656D006765745F4974656D007365745F4974656D0053797374656D0053716C426F6F6C65616E00476574426F6F6C65616E0054696D655370616E004F70656E0044617461436F6C756D6E0053716C4D6574614461746146726F6D436F6C756D6E0053716C4D6574614461746146726F6D4F626A656374436F6C756D6E00636F6C756D6E006F436F6E6E00636F6E6E006765745F507265636973696F6E004D6178507265636973696F6E0045787072657373696F6E0064625F6175746F6D6174696F6E006F705F5375627472616374696F6E0044625472616E73616374696F6E0053716C5472616E73616374696F6E00426567696E5472616E73616374696F6E0053797374656D2E5265666C656374696F6E004E616D6556616C7565436F6C6C656374696F6E0044617461436F6C756D6E436F6C6C656374696F6E00576562486561646572436F6C6C656374696F6E0053716C506172616D65746572436F6C6C656374696F6E004F6462634572726F72436F6C6C656374696F6E0053716C4572726F72436F6C6C656374696F6E0044617461526F77436F6C6C656374696F6E007365745F436F6E6E656374696F6E004462436F6E6E656374696F6E004F646263436F6E6E656374696F6E0053716C436F6E6E656374696F6E007365745F446972656374696F6E00506172616D65746572446972656374696F6E006F705F4164646974696F6E005472616E73616374696F6E53636F70654F7074696F6E00494F457863657074696F6E00576562457863657074696F6E004F646263457863657074696F6E005472616E73616374696F6E41626F72746564457863657074696F6E00417267756D656E744F75744F6652616E6765457863657074696F6E0053716C457863657074696F6E004170706C69636174696F6E457863657074696F6E00496E76616C69644F7065726174696F6E457863657074696F6E00556E617574686F72697A6564416363657373457863657074696F6E00417267756D656E74457863657074696F6E007352656D6F74655F457865637574696F6E0072656D6F74655F657865637574696F6E00546869735F657865637574696F6E0053797374656D2E446174612E436F6D6D6F6E006170695F72657475726E007365745F5374617274496E666F0050726F636573735374617274496E666F00536C6565700043686172006765745F4E756D62657200494461746152656164657200446244617461526561646572004F646263446174615265616465720053716C4461746152656164657200457865637574655265616465720053747265616D526561646572005465787452656164657200734578656375746544425F444250726F7669646572006765745F444250726F7669646572007365745F444250726F76696465720076444250726F7669646572007354656D705F466F6C6465720053657276696365506F696E744D616E61676572004462506172616D657465720053716C506172616D657465720053747265616D5772697465720054657874577269746572006765745F447269766572007365745F4472697665720076447269766572004D6963726F736F66742E53716C5365727665722E536572766572005772697465546F536572766572006765745F52656D6F74655F4572726F72007365745F52656D6F74655F4572726F72007652656D6F74655F4572726F72004F6462634572726F72006765745F5374616E646172644572726F72007365745F52656469726563745374616E646172644572726F72006765745F4E61746976654572726F720053716C4572726F720049456E756D657261746F7200476574456E756D657261746F72002E63746F720053797374656D2E446961676E6F7374696373006765745F54687265616473007365745F546872656164730052756E6E696E6754687265616473005265667265736854687265616473007654687265616473006D61785F74687265616473006765745F546F74616C5365636F6E64730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004D65646961547970654E616D65730053797374656D2E446174612E53716C54797065730053746F72656450726F636564757265730053797374656D2E53656375726974792E43727970746F6772617068792E583530394365727469666963617465730053716C4279746573004765744279746573006765745F52756E6E696E6773007365745F52756E6E696E6773007652756E6E696E6773006765745F57616974696E6773007365745F57616974696E6773007657616974696E677300436F6E7461696E73006765745F436F6C756D6E730053797374656D2E546578742E526567756C617245787072657373696F6E730053797374656D2E5472616E73616374696F6E730053797374656D2E436F6C6C656374696F6E73006765745F436F6E6E656374696F6E5F4F7074696F6E73007365745F436F6E6E656374696F6E5F4F7074696F6E730076436F6E6E656374696F6E5F4F7074696F6E730052656765784F7074696F6E73006765745F457865637574696F6E73007365745F457865637574696F6E730076457865637574696F6E73006765745F53746F7073007365745F53746F7073007653746F70730053716C4368617273006765745F48656164657273006452656164657273006F526561646572730068656164657273006765745F506172616D6574657273006765745F4572726F7273006F457865637574654572726F727300737563636573730050726F63657373006765745F417267756D656E7473007365745F417267756D656E74730076417267756D656E747300726573756C745F636F6E74656E747300457869737473006765745F537461747573007365745F5374617475730076537461747573006765745F526F7773006765745F4166666563746564526F7773007365745F4166666563746564526F777300764166666563746564526F777300436F6E63617400466F726D6174004F626A65637400746869735F64740053797374656D2E4E6574006F705F496D706C696369740053706C697400436F6D6D69740057616974466F724578697400416C6C5F526573756C7400546869735F526573756C7400436865636B56616C69646174696F6E526573756C74007365745F557365724167656E7400757365726167656E740053797374656D2E446174612E53716C436C69656E7400456E7669726F6E6D656E7400457363617065417267756D656E7400436F6D706F6E656E74006765745F43757272656E740053797374656D2E436F6C6C656374696F6E732E436F6E63757272656E74005570646174655F457865635F436F6E74656E7400636F6E74656E740053657276696365506F696E7400737276506F696E74006765745F436F756E74006765745F4669656C64436F756E74007365745F416363657074006163636570740054687265616453746172740053656E64526573756C74735374617274006765745F506F7274007365745F506F72740076506F72740048747470576562526571756573740072657175657374006765745F54696D654F7574007365745F54696D654F7574007654696D654F7574007365745F54696D656F7574007365745F436F6D6D616E6454696D656F75740054686574696D656F7574006765745F5374616E64617264496E707574007365745F52656469726563745374616E64617264496E707574006765745F52656D6F74655F4F7574707574007365745F52656D6F74655F4F7574707574007652656D6F74655F4F7574707574006765745F5374616E646172644F7574707574007365745F52656469726563745374616E646172644F7574707574004D6F76654E6578740053797374656D2E54657874007365745F436F6D6D616E64546578740052656164416C6C54657874005772697465416C6C546578740053716C436F6E74657874006765745F4E6F770044617461526F770053656E64526573756C7473526F77007365745F4372656174654E6F57696E646F7700526567657800494365727469666963617465506F6C696379007365745F4365727469666963617465506F6C69637900437573746F6D4365727469666963617465506F6C6963790053716C4D6F6E65790053716C42756C6B436F70790053514C53657276657242756C6B436F70790053716C42696E61727900466F726D61745F53514C5F517565727900457865637574654E6F6E5175657279006F705F457175616C697479006F705F496E657175616C6974790049734E756C6C4F72456D7074790000000F73007500630063006500730073000001003563006F006E007400650078007400200063006F006E006E0065006300740069006F006E0020003D00200074007200750065003B000081556900660020006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074002700290020006900730020006E0075006C006C002000200072006100690073006500720072006F007200200028002700430061006E0020006E006F0074002000660069006E00640020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E007400210027002C00310036002C00310029002000730065006C0065006300740020002A002000660072006F006D0020002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E00740020006F0072006400650072002000620079002000720065007400750072006E005F0074006D0070005F007400610062006C0065003B002000010D520075006E005F0049004400000F5400680072006500610064007300000F740069006D0065006F007500740000157300650072007600650072006E0061006D0065000013490050005F006F0072005F0044004E005300000D640062006E0061006D006500000D540068006500530051004C00000950006F00720074000017640062005F00700072006F00760069006400650072000013440042005F00440072006900760065007200001175007300650072006E0061006D0065000007700077006400001B520065006D006F00740065005F004F0075007400700075007400001143004D0044005F005400790070006500001341007200670075006D0065006E0074007300002543006F006E006E0065006300740069006F006E005F004F007000740069006F006E0073000021720065007400750072006E005F0074006D0070005F007400610062006C006500000B44006500620075006700000F570061006900740069006E006700000743004D0044000015530051004C0020004500720072006F0072003A00002145007800630065007000740069006F006E0020004500720072006F0072003A00001D530065006E007400200071007500650072007900200074006F00200000052D002D00010F520075006E006E0069006E006700002779007900790079002D004D004D002D00640064002000480048003A006D006D003A007300730001172D002D002D00530074006100720074006500640020000121200065007800650063007500740069006F006E007300200066006F007200200000052C0020000029200071007500720069006500730020006100720065002000770061006900740069006E006700210000192D002D002D00530065006E00740020006F00750074002000013720007100750065007200690065007300200074006F002000720065006D006F007400650020007300650072007600650072007300210000292D002D002D00520075006E006E0069006E006700200071007500650072006900650073003A00200001372D002D002D0053007400610072007400200074006F002000720065007400750072006E00200072006500730075006C00740073002E000103230000072D002D002D0001292D002D002D00640061007400610020006D00650072006700650020004500720072006F0072003A0001512D002D002D0063006F006E00630075007200720065006E00740042006100670020007400720079006F0075007400200044006100740061005400610062006C00650020006600610069006C0065006400012F20003A002000520065007400750072006E0065006400200061006C006C00200072006500730075006C0074007300000720003A002000001F45007800630065007000740069006F006E005F00530051004C003A002000003145007800630065007000740069006F006E005F005400720061006E0073005F00410062006F0072007400650064003A00001D45007800630065007000740069006F006E005F004100700070003A000051650078006300650065006400730020006D006100780069006D0075006D0020006C0065006E00670074006800200073007500700070006F00720074006500640020006F00660020003400300030003000001745007800630065007000740069006F006E003A00200000534500720072006F0072003A002000660069006C00650020006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E00002F4500720072006F0072003A002000660069006C00650020006E006F00740020006500780069007300740073002E0000514500720072006F0072003A005000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A00200000414500720072006F0072003A0049004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A00200000314500720072006F0072003A0055006E006500780070006500630074006500640020006500720072006F0072003A002000000950004F0053005400003B480054005400500020004500720072006F0072003A0020007B0030007D002C002000440065007400610069006C0073003A0020007B0031007D0000514500720072006F0072003A002000460069006C0065006E0061006D0065002000630061006E006E006F00740020006200650020006E0075006C006C0020006F007200200065006D007000740079002E0000455000650072006D0069007300730069006F006E002000640065006E00690065006400200061006300630065007300730069006E0067002000660069006C0065003A002000003549004F0020006500720072006F0072002000770072006900740069006E006700200074006F002000660069006C0065003A002000002555006E006500780070006500630074006500640020006500720072006F0072003A00200000434500720072006F0072003A00200049006E00700075007400200064006100740061002000630061006E006E006F00740020006200650020006E0075006C006C002E000019720065007400750072006E00200052006F00770073003D0000372D002D002D0045007800630065007000740069006F006E005F00530065006E00640044006100740061005400610062006C0065003A0001811775007000640061007400650020005B002300720065006D006F00740065005F0065007800650063005F0063006F006E00740065006E0074005D0020007300650074002000720065006D006F00740065005F006F00750074007000750074003D004000720065006D006F00740065005F006F00750074007000750074002C00720065006D006F00740065005F006500720072006F0072003D004000720065006D006F00740065005F006500720072006F0072002C00610066006600650063007400650064005F0072006F00770073003D004000610066006600650063007400650064005F0072006F00770073002000770068006500720065002000720075006E005F00690064003D004000720075006E005F006900640000032E00001920002D002D0020006600610069006C00650064003A002000010D6600610069006C0065006400001D4000720065006D006F00740065005F006F0075007400700075007400001B4000720065006D006F00740065005F006500720072006F007200001D4000610066006600650063007400650064005F0072006F0077007300000F4000720075006E005F006900640000292D002D002D004C006F00610064005F004500720072006F00720020004500720072006F0072003A00010749006E007400000D42006900670049006E007400000742006900740000114400610074006500540069006D006500000B4D006F006E0065007900001153006D0061006C006C0049006E007400000F540069006E00790049006E007400002155006E0069007100750065004900640065006E00740069006600690065007200000B4E00740065007800740000095200650061006C000017730071006C005F00760061007200690061006E007400000F560061007200690061006E007400002F49004600200043004F004C005F004C0045004E0047005400480028002700540045004D005000440042002E002E00010927002C002000270001332700290020004900530020004E0055004C004C002000200041004C0054004500520020005400410042004C00450020005B00010D5D002000610064006400200000035B00001D5D002000730071006C005F00560061007200690061006E0074003B0000055D00200000033B0000052000280000052D00310001074D0041005800000529003B00000F44006500630069006D0061006C0000032C0000352D002D002D0041006C007400650072005F00540065006D0070005F005400610062006C00650020004500720072006F0072003A0001808F730065006C0065006300740020006E0061006D0065002000660072006F006D002000740065006D007000640062002E007300790073002E0063006F006C0075006D006E00730020007700680065007200650020006F0062006A006500630074005F00690064003D006F0062006A006500630074005F006900640028002700740065006D007000640062002E002E00012B2700290020006F007200640065007200200062007900200063006F006C0075006D006E005F006900640001096E0061006D006500001B69006E007300650072007400200069006E0074006F0020005B0000155D002000760061006C0075006500730020002800000340000003290000152D002D002D0069006E0073006500720074002000010F20004500720072006F0072003A00001D49006E00760061006C0069006400200074007900700065003A002000001D55006E006B006E006F0077006E00200074007900700065003A002000001D7B0022007300740061007400750073003A0022004F004B0022007D000055540068006900730020006D006500740068006F00640020006900730020006F006E006C007900200066006F0072002000530051004C002000530065007200760065007200200045006E00670069006E006500730000317B0022007300740061007400750073003A0022006600610069006C006500640022002C0022006D00730067003A00220000032D00010522007D000011730071006C005F0063006D0064005F00001579007900790079005F004D004D005F006400640000035F0000092E00730071006C0000092E006C006F00670000092E006F0075007400000F530051004C005F0043004D004400000B4D005300530051004C000015530051004C0043004D0044002E0045005800450000192D00620020002D007200310020002D00780020002D005300010720002D006400010720002D007400010720002D006900010720002D004500010720002D005500010920002D005000220001032200000B4D007900530051004C0000134D005900530051004C002E00450058004500000D2D00420020002D0068002000010920002D0050002000010920002D0044002000010920002D0075002000010720002D007000011550006F0073007400670072006500530051004C0000115000530051004C002E00450058004500000D2D00710020002D0068002000010920002D0070002000010920002D0064002000010920002D0077002000010320000011530051004C005F00440055004D005000000F4200430050002E0045005800450000152000710075006500720079006F00750074002000000920002D0063002000010920002D0053002000010920002D0065002000010720002D005400010920002D0055002000010920002D005000270001032700011B4D005900530051004C00440055004D0050002E0045005800450000072D0068002000010720002D007500010920002D0070002700012120002D002D0072006500730075006C0074002D00660069006C0065003D0020000117500047005F00440055004D0050002E00450058004500000920002D0068002000010920002D0066002000010D4F0053005F0043004D00440000030A0000030D0000055C00220000052200220000114400720069007600650072003D007B0000137D003B005300650072007600650072003D0000153B00440061007400610062006100730065003D00000B3B005500690064003D00000D3B0050006F00720074003D00000B3B005000770064003D000019720065006D006F00740065005F006500720072006F007200002374006D0070005F006400740020006C006F006100640020006E0075006C006C002D00011D4F0064006200630045007800630065007000740069006F006E003A00000F49006E006400650078002000230000150A004D006500730073006100670065003A002000001D0A004E00610074006900760065004500720072006F0072003A00200000130A0053006F0075007200630065003A002000000D0A00530051004C003A00200000194F0044004200430020004500720072006F0072003A002000000D3B005000770064003D007B0000037B0000057B007B0000057D003B0000194400610074006100200053006F0075007200630065003D0000233B0049006E0069007400690061006C00200043006100740061006C006F0067003D0000673B0049006E00740065006700720061007400650064002000530065006300750072006900740079003D0053005300500049003B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0000453B004E006500740077006F0072006B0020004C006900620072006100720079003D00440042004D00530053004F0043004E003B0075007300650072002000690064003D0000173B00700061007300730077006F00720064003D002700010527003B000127650078006500630020004000720065007400750072006E005F00760061006C00750065003D00001B4000720065007400750072006E005F00760061006C00750065000023720065006D006F00740065005F006A0073006F006E005F006500720072006F007200000330000021520065007400750072006E005F00760061006C007500650020006900730020000037530071006C0045007800630065007000740069006F006E002D004500720072006F0072003A00740069006D0065006F00750074002000011B530071006C0045007800630065007000740069006F006E002D00013549006E00760061006C00690064004F007000650072006100740069006F006E0045007800630065007000740069006F006E002D00011545007800630065007000740069006F006E002D0001395400720061006E00730061006300740069006F006E00410062006F00720074006500640045007800630065007000740069006F006E003A00002B4100700070006C00690063006100740069006F006E0045007800630065007000740069006F006E003A00001545007800630065007000740069006F006E003A000017530079007300740065006D002E00470075006900640000C62AA4824EBAAC40AB82787E8387AEB800042001010803200001052001011111042001010E8090074E0E0E15124101121415124101121812451249124D02121412511218020202125512590E080208125D080811610812651511690112141214151169011218121802151169011214121402151169011218121802120C126D11710202020E116108021210126D0202020E02020E0211750E02151169011214121412650202020202125D02020212551279127D125D0E02050001113D0E0615124101121406151241011218040000124505200101124905200101124D0420001251042001080E05200111710804200108080420010E080420010208052001011300050002020E0E07151280ED0112650615124101126D0320000204200012590320000E062001128121080500020E0E0E03200008040000116108200015116901130006151169011214042000130006151169011218052002011C18062001011281250700040E0E0E0E0E04000101080420010E0E0500010E1D0E0800021175116111610320000D0600030E0E0E0E0300000E06200102101300052000128131042001020E090002118089113D113D0600010211808906200201126502050701118089062003010808080A0004020E0E1181411175060001118089020F07070E02113D0212808D128091125D040001020E0400010E0E2E07180E12809512809912809D020202021D0E081D0E02021D051280A10202081280A5128099021280A112809D125D060001011280D50600010111814D04000101020600011280E10E0620011D0E1D03052000128155052002010E0E05000012815D0520011D050E042001010A0520001280A1072003011D05080805200012816106000112815D0E092002011280A112815D062001011280A10520001181650600030E0E1C1C080002113D113D113D0C0705020812808D128091125D0E07070E02080212808D128091125D050002010E0E2207111D021D1280A91280AD12450A1280B11280B508081C02021280B90E125D0E1161072001011D1280A9062001011280AD0520001280B10320001C0420011C0805200201081C1007061D1280A908081280BD021D1280A90520001281710620011280BD081E070F0E1280C10E151169011218121802124D125512590E08020E125D11610520001280C1092003010E12491280C10520001281790720021281050E1C2707130E0E1D02151241010E1D1280A91D1280A9081280A9021180C5020A0205124D0E125D0E116105151241010E0520001180C50520010213000320000A0520020E0E0E03200005062002010E12492D0712151241010E0E124D1251021280C1151169010E0E1280B11280B5124D151169010E0E1280B9125D0E11610E05151169010E0520020E08080420011C0E0406128185040701125D0F07080E0202124D1280D10E1255125D05200011818D0520010112651307071280A91280CD0E1180C91180C9021280A90520001280CD0800011180C91280CD072002010E1180C5082003010E1180C50A1907131280A902020202020202020202020202020202021280A9021D050800011280CD118195021D03020605092004010E1180C50505170709080808151169011214121415116901126D126D02080615116901126D0D0705080815116901126D126D022F07260E0E0E0E0E116111711280E5020208020202020202020202020202021280E90E0E020E02020202020202125D020420010102062001011280E50520001281D105200012809D040001010E0307010E040702020E8082074D12651265020E1280F11280F51280F9126502021280B11280B51280B90E021280FD0E080802125D0E02020E1280F11280F51280F9126502021280B11280B50E021280FD0E0802125D0E020212810112490202128105124D125102126502021280B11280B50E020202020E12550E021281090E125D0E0212790E127D0E125D0E02072002010E1280F10520001280F9062001011281D90520001281DD0620011281E108062001011181E5042000124D0A20031281050E1180C508062001011181ED0607021280BD020600011280CD0E062001011280CD042001011C062001011280BD08070115124101126D03070108090701151280ED01126504070111710307010208B77A5C561934E08980A0002400000480000094000000060200000024000052534131000400000100010001657C118060430AB20024C1B3584340A220EFEA08E174BB5B1DD6FFD420C6DE75EEC407A4619A2307DBB4A72E6D94155655F36B65DB8349E417995A1CBD0BB6CAB5FD4EAE45EB0194B9E1ECFC0B35BBC09E2D05B2D22A82E685AA20EE337A123EF65D808E43224584CB39648C0DCC03279FCF2586C260087D1E600E0BAAA5B10A4D005300530051004C000A4D007900530051004C001450006F0073007400670072006500530051004C000E73007500630063006500730073000C6600610069006C0065006400010102060E030612180806151280ED011265020608070615124101126D030611710206020A000408113D10113D08020F0009080E113D0E0E0E0E0E0E10113D070002080E10113D060002080E113D0500010E12650B00021D1280A91265101D020B00020E15124101121812490800030E0E12651249070001125D1180C9070001125D1280CD0A00050E12650E0E1249020A00021280A91280BD10020C00031280A90E1280BD1280CD09000108151241011214050001011214062002010E12180C2002011218151280ED01126508200015124101126D0920010115124101126D092000151280ED0112650A200101151280ED01126504200011710520010111710D2004021280D91280DD1280E10808280015124101126D03280008092800151280ED0112650328000E0428001171032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000701000000001201000D4442204175746F6D6174696F6E00000501000000001101000C3357204C6F6E67204461746100001201000D64625F6175746F6D6174696F6E00000C010007312E302E302E3000000401000000240100020054020F497344657465726D696E6973746963015402094973507265636973650100C0E7AD8023956BABED1A8C1D5BA09F509524CF00B9F1CFF2FF6A8224CBB9D15FB16CD8C0FCA75BDEC7D364FA785066F56FA9329ED54AB8060727FC2C574E49FE1F97896ADBB76EED7A99B5E3EEA10397D6F08162C5D74891D8B6A1B12B0067494A8409A005DF0E109A9139BFC9AF30E5AFBE0416162024B4FDCD5CCAEFD97114000000009A54C76800000000020000001C010000E8B40000E8960000525344534B6AA80F8ECA6E4FB33DE3B912400B1401000000433A5C6277616E675C64625F6175746F6D6174696F6E5C64625F6175746F6D6174696F6E5C6F626A5C44656275675C64625F6175746F6D6174696F6E2E706462000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002CB60000000000000000000046B6000000200000000000000000000000000000000000000000000038B60000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF250020001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100100000001800008000000000000000000000000000000100010000003000008000000000000000000000000000000100000000004800000058C000004C03000000000000000000004C0334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004AC020000010053007400720069006E006700460069006C00650049006E0066006F0000008802000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003A000D00010043006F006D00700061006E0079004E0061006D006500000000003300570020004C006F006E006700200044006100740061000000000044000E000100460069006C0065004400650073006300720069007000740069006F006E00000000004400420020004100750074006F006D006100740069006F006E000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E003000000044001200010049006E007400650072006E0061006C004E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003E000D0001004C006500670061006C0043006F00700079007200690067006800740000003300570020004C006F006E00670020004400610074006100000000002A00010001004C006500670061006C00540072006100640065006D00610072006B00730000000000000000004C00120001004F0072006900670069006E0061006C00460069006C0065006E0061006D0065000000640062005F006100750074006F006D006100740069006F006E002E0064006C006C0000003C000E000100500072006F0064007500630074004E0061006D00650000000000640062005F006100750074006F006D006100740069006F006E000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000B000000C000000583600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
 
as

declare @hash binary (64),@sql varchar(max)
if @dll_file is not null
     begin
		 CREATE TABLE #my_assembly(asmbin varbinary(max))
		 set @sql='SELECT my_assembly.BulkColumn FROM OPENROWSET(BULK N'''+@dll_file+''', SINGLE_BLOB) AS my_assembly'
		 insert #my_assembly exec(@sql)
		 select @asmbin=asmbin from #my_assembly
		 if @@ROWCOUNT<>1
		   RAISERROR ('failed to read dll file for this assembly.', 16,1);
	  end
else if @asmbin is null
   begin
		select @asmbin=af.content from sys.assemblies a, sys.assembly_files af where af.assembly_id=a.assembly_id and a.clr_name=@clrname
		if @@ROWCOUNT<>1
		   RAISERROR ('can''t find this assembly.', 16,1);
   end

select @hash=hash from sys.trusted_assemblies where description=@clrname
if @@ROWCOUNT>0
  EXEC sp_drop_trusted_assembly @hash
set @hash =HASHBYTES('SHA2_512',@asmbin)
EXEC sp_add_trusted_assembly @hash=@hash,@description=@clrname

select * from sys.trusted_assemblies
GO

SET ANSI_NULLS OFF
GO
SET QUOTED_IDENTIFIER OFF
GO
CREATE PROCEDURE [dbo].[up_call_rest_api]
	@api_url [nvarchar](4000),
	@content [nvarchar](max),
	@headers [nvarchar](4000) = N'',
	@method [nvarchar](4000) = N'GET',
	@content_type [nvarchar](4000) = N'',
	@encode [nvarchar](4000) = N'',
	@accept [nvarchar](4000) = N'',
	@useragent [nvarchar](4000) = N'',
	@api_return [nvarchar](max) OUTPUT
WITH EXECUTE AS CALLER
AS
EXTERNAL NAME [db_automation].[StoredProcedures].[call_rest_api]
GO


SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


 CREATE OR ALTER   function  [dbo].[fn_get_para_value]
(@para_name varchar(300))
RETURNS varchar(4000)
AS
BEGIN
    declare @p_value varchar(4000)
	select @p_value=pvalue from para_list where pname=@para_name

	return @p_value
end
GO



SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO




CREATE OR ALTER             procedure [dbo].[up_call_sqlfunction]
@The_SQL nvarchar(max),@json_input nvarchar(max)='{}',@json_return nvarchar(max)='{}' output,@error_msg nvarchar(max)='' output
as
declare @servername_or_list varchar(max),@dbname_or_list nvarchar(max),@return_type nvarchar(100)='',@return_temp_table varchar(128)=N'',
@instance_types varchar(4000)=N'*',@db_types varchar(4000)=N'*',@environment_or_list nvarchar(max)=N'*',@cmd_type varchar(20)='',
@dry_run bit=0,@debug bit=0,@max_threads int=0,@timeout int=60,@include_remote_info bit=0,@log bit=1,@stop_by_error bit =1,
@raise_error bit=0,@include_ag_node bit=0,@exclude_ag_listener bit=0

declare @MSSQL varchar(50) = 'MSSQL',@MySQL varchar(50) = 'MySQL',@PGSQL varchar(50) = 'PostgreSQL'  
declare @success varchar(20)='success',@failed as varchar(20)='failed'
declare @jsonlist table(thekey nvarchar(500),thevalue nvarchar(max))
declare @fn_para nvarchar(max)='{}',@sql nvarchar(max),@return_json nvarchar(max)
declare @all_servers bit=0,@all_dbs bit=0,@all_instance_types bit=0,@all_db_types bit=0,@all_environments bit=0
declare @return int,@return_data nvarchar(max),@arguments nvarchar(4000)
declare @server_list table (servername varchar(128))
declare @instance_type_list table (id int,instance_type varchar(128))
declare @db_list table (dbname varchar(128))
declare @db_type_list table (db_type varchar(128))
declare @environment_list table (id int,environment varchar(128))
declare @mssql_template nvarchar(max)=N'',@mysql_template nvarchar(max)=N'',@pgsql_template nvarchar(max)=N''
declare @guid varchar(100)=replace(convert(varchar(50),newid()),'-',''),@the_date varchar(11)=format(getdate(),'yyyy_MM_dd_')
set @error_msg=''
if isnull(@The_SQL,'')=''
   begin
      raiserror('@The_SQL is empty!',16,1)
      return -110
   end
if isjson(@json_input)=0
   begin
      raiserror('@json_input is not formatted as correct json!',16,1)
      return -100
   end
set @servername_or_list=isnull(JSON_VALUE(@json_input,'$.servername_or_list'),'')
set @dbname_or_list=isnull(JSON_VALUE(@json_input,'$.dbname_or_list'),'')
set @return_type=isnull(JSON_VALUE(@json_input,'$.return_type'),'')
set @return_temp_table=isnull(JSON_VALUE(@json_input,'$.return_temp_table'),'')
set @arguments=isnull(JSON_VALUE(@json_input,N'$.arguments'),N'')
set @exclude_ag_listener=isnull(JSON_VALUE(@json_input,N'$.exclude_ag_listener'),0)
set @include_ag_node=isnull(JSON_VALUE(@json_input,N'$.include_ag_node'),0)

set @instance_types=isnull(JSON_VALUE(@json_input,'$.instance_types'),'*')

set @db_types=isnull(JSON_VALUE(@json_input,'$.db_types'),'*')
set @environment_or_list=isnull(JSON_VALUE(@json_input,'$.environment_or_list'),'*')

set @cmd_type=isnull(JSON_VALUE(@json_input,'$.cmd_type'),'')

set @dry_run=isnull(JSON_VALUE(@json_input,'$.dry_run'),0)
set @debug=isnull(JSON_VALUE(@json_input,'$.debug'),0)
set @timeout=isnull(JSON_VALUE(@json_input,'$.timeout'),60)
set @include_remote_info=isnull(JSON_VALUE(@json_input,'$.include_remote_info'),0)
set @stop_by_error=isnull(JSON_VALUE(@json_input,'$.stop_by_error'),1)
set @log=isnull(JSON_VALUE(@json_input,'$.log'),1)
set @raise_error=isnull(JSON_VALUE(@json_input,'$.raise_error'),0)
set @max_threads=isnull(JSON_VALUE(@json_input,'$.max_threads'),10)

if N'' in (@servername_or_list,@dbname_or_list)
    begin
	   set @error_msg=N'Server or db can not be empty!'
       if @raise_error=1 throw 51000,@error_msg,1
	   return -100
	end
if @cmd_type in ('OS_CMD')  -- SQL execution
	begin
	   set @error_msg=N'Please call up_call_os_cmd by this cmd_type!'
       if @raise_error=1 throw 51000,@error_msg,1
	   return -100
	end
if object_id('tempdb..#remote_exec_content') is not null
     drop table #remote_exec_content
if @return_temp_table=''
   begin
		set @return_temp_table='#tmp_default'
		if object_id('tempdb..'+@return_temp_table) is not null   
		   drop table #tmp_default
		create table #tmp_default (run_id uniqueidentifier not null)
   end
if object_id('tempdb..'+@return_temp_table) is null   
   begin
	   set @error_msg=N'Can''t find out return temp table--'+isnull(@return_temp_table,'')
       if @raise_error=1 throw 51000,@error_msg,1
	   return -100
   end
if @return_temp_table='#tmp_result' 
   begin
      truncate table #tmp_result
	  set @sql=''
	  select @sql=+@sql+'ALTER TABLE tempdb..#tmp_result DROP COLUMN ['+name+'];' from tempdb.sys.columns 
			where object_id=object_id('tempdb..#tmp_result') AND name <>'run_id' 
      if @sql<>''
	     exec(@sql)
   end

if @servername_or_list='*'
   set @all_servers=1
else
   insert @server_list (servername) select distinct trim(value) from string_split(@servername_or_list,',')
if @instance_types='*'
   set @all_instance_types=1
else
   insert @instance_type_list (id,instance_type) select distinct i.id,i.name from string_split(@instance_types,',') f,instance_types i where i.name=trim(value)
if @dbname_or_list='default'
   set @dbname_or_list='master,INFORMATION_SCHEMA,postgres'
if @dbname_or_list='*'
   set @all_dbs=1
else
   insert @db_list select distinct trim(value) from string_split(@dbname_or_list,',')

if @db_types='*'
   set @all_db_types=1
else
   insert @db_type_list select distinct trim(value) from string_split(@db_types,',')
if @environment_or_list='*'
   set @all_environments=1
else
   insert @environment_list (id,environment) select distinct e.id,e.name from string_split(@environment_or_list,',') f, environments e where e.name=trim(value) 

create table #remote_exec_content (run_id uniqueidentifier not null default(newid()),Threads int,servername varchar(128),IP_or_DNS varchar(500),dbname varchar(8000),TheSQL nvarchar(max),
[Port] varchar(10),db_provider varchar(50),db_driver varchar(100),username varchar(128),pwd varchar(128),connection_options varchar(500),cmd_type varchar(20) default(''),arguments nvarchar(4000) default(N''),
return_tmp_table varchar(max),[timeout] int,debug bit, remote_error nvarchar(max) default(N''),remote_output nvarchar(max) default(N''),affected_rows int default(0))

insert #remote_exec_content (Threads,servername,IP_or_DNS,dbname, [port], db_provider,DB_Driver,username,pwd,connection_options,[timeout],debug,return_tmp_table,cmd_type,arguments)
	select case when @max_threads>0 then @max_threads when s.max_threads>0 then s.max_threads else 5 end, 
		s.servername,IP_or_DNS,d.dbname,[port_number],db_provider,odbc_driver,username,pwd,connection_options,
		@timeout,@debug,@return_temp_table,@cmd_type,@arguments
			from serverlist s,dblist d where d.servername=s.servername 
			and @include_ag_node=case when ag_listener='' then @include_ag_node else ag_node end
			and @exclude_ag_listener=case when ag_listener='' then @exclude_ag_listener when d.servername=ag_listener then 0 else 1 end
			and (@all_instance_types=1 or exists(select 1 from @instance_type_list i where (s.instance_options & i.id)>0))
			and (@all_environments=1 or exists(select 1 from @environment_list e where (s.environment_options & e.id)>0))
			and (@all_dbs=1 or exists(select 1 from @db_list dl where dl.dbname=d.dbname))
			and (@all_servers=1 or exists(select 1 from @server_list dl where dl.servername=d.servername))
			and (@all_environments=1 or exists(select 1 from @environment_list e where e.id=d.environment_id))
			and (@all_db_types=1 or exists(select 1 from @db_type_list tl where tl.db_type=d.db_type))
if @@ROWCOUNT=0
	begin
		if @dbname_or_list='master,INFORMATION_SCHEMA,postgres'
			begin
				
				insert #remote_exec_content (Threads,servername,IP_or_DNS,dbname, [port], db_provider,DB_Driver,username,pwd,connection_options,[timeout],debug,return_tmp_table,cmd_type,arguments)
					select case when @max_threads>0 then @max_threads when s.max_threads>0 then s.max_threads else 5 end, 
						s.servername,IP_or_DNS,d.dbname,[port_number],db_provider,odbc_driver,username,pwd,connection_options,
						@timeout,@debug,@return_temp_table,@cmd_type,@arguments
							from serverlist s,@db_list d where d.dbname=case when s.db_provider=@MSSQL then 'master'
																			when s.db_provider=@PGSQL then 'postgres'							
																			when s.db_provider=@MySQL then 'INFORMATION_SCHEMA' else '' end							
							and (@all_instance_types=1 or exists(select 1 from @instance_type_list i where (s.instance_options & i.id)>0))
							and (@all_environments=1 or exists(select 1 from @environment_list e where (s.environment_options & e.id)>0))						
				if @@ROWCOUNT=0
						begin
						set @error_msg=N'Can''t find out any dbs to run this query!'
						if @raise_error=1 throw 51000,@error_msg,1
						return -100
						end     	   
			end
		else
			begin
				set @error_msg=N'Can''t find out any dbs to run this query!'
				if @raise_error=1 throw 51000,@error_msg,1
				return -100
			end
	end
update r set TheSQL=f.thesql from #remote_exec_content r, sql_functions f 
	where f.fn_name=@The_SQL and f.db_provider=r.db_provider and f.enabled=1
if @@ROWCOUNT=0
	update #remote_exec_content set TheSQL=@The_SQL
if exists(select 1 from #remote_exec_content where TheSQL is null)
		begin
			set @error_msg='Can not find out the sql function in sql_functions by '+@The_SQL+char(13)
			select @error_msg+@error_msg+servername+'--'+dbname +'--'+db_provider+ char(13) from #remote_exec_content where TheSQL is null
			if @raise_error=1 throw 51000,@error_msg,1
			return -101
		end

if isnull(json_value(@json_input,'$.sql_parameters'),'')<>''
	begin
		update r set TheSQL=replace(TheSQL,'$('+j.[key] COLLATE SQL_Latin1_General_CP1_CI_AS+')',j.[value] COLLATE SQL_Latin1_General_CP1_CI_AS) 	
			from #remote_exec_content r, openjson(@json_input,'$.sql_parameters') j 
		set @json_input='{}'
	end  
set @mssql_template=N'
begin try
	execute {{dbname_'+@guid+N'}}..sp_executesql N''{{all_sqls_'+@guid+N'}}'';
end try
begin catch
		if @@TRANCOUNT > 0
			rollback
		select ERROR_MESSAGE() as remote_json_error;
		'+case when @stop_by_error=1 then N'return;' else N'' end+N'
end catch;'

set @mysql_template=N'
CREATE PROCEDURE IF NOT EXISTS remote_process_'+@the_date+@guid+'()
BEGIN
	DECLARE EXIT HANDLER FOR SQLEXCEPTION
	BEGIN
		GET DIAGNOSTICS CONDITION 1 
			@sqlstate = RETURNED_SQLSTATE, 
			@errno = MYSQL_ERRNO, 
			@message = MESSAGE_TEXT;
		SELECT CONCAT(''Error '', @errno, '' ('', @sqlstate, ''): '', @message) AS remote_error;
	END;
	{{all_sqls_'+@guid+N'}}
END;
CALL remote_process_'+@the_date+@guid+'();
DROP PROCEDURE IF EXISTS remote_process_'+@the_date+@guid+';'
set @pgsql_template=N''
update #remote_exec_content set TheSQL=case 
	when db_provider=@MSSQL then replace(replace(@mssql_template,@guid,replace(convert(varchar(50),run_id),'-','')),N'{{all_sqls_'+replace(convert(varchar(50),run_id),'-','')+N'}}',TheSQL)
	when db_provider=@MySQL and dbname not in ('INFORMATION_SCHEMA') then replace(replace(@mysql_template,@guid,replace(convert(varchar(50),run_id),'-','')),N'{{all_sqls_'+replace(convert(varchar(50),run_id),'-','')+N'}}',TheSQL)
	else TheSQL end where cmd_type=0
update #remote_exec_content set TheSQL=replace(TheSQL,N'{{dbname_'+replace(convert(varchar(50),run_id),'-','')+N'}}',dbname) where cmd_type=0
if @dry_run=1
	begin
		select * from #remote_exec_content order by run_id
		print 'Please check if the SQL is correct that can be applied in the database on the remote server! No any SQL executed on any dbs!'
		return 0
	end
begin try
exec @return=up_exec_remote_sql @return_msg=@error_msg out,@max_threads=@max_threads,@debug=@debug 
if @return<>0
   select @error_msg=@error_msg+char(13)+isnull(remote_error,N'')  from #remote_exec_content where isnull(remote_error,N'')<>N''
update #remote_exec_content set pwd=null
if @log=1
   insert remote_sql_log (run_id,servername,remote_user,sqlstring,errormsg) select run_id,servername,username, TheSQL,remote_error from #remote_exec_content
select @json_return=(select run_id,case when remote_error<>@success then @failed else remote_error end as [status], servername,dbname,affected_rows,remote_error from #remote_exec_content for json path,root('remote_execution'))
if @include_remote_info=1
   begin
		set @sql='if COL_LENGTH(''tempdb..'+@return_temp_table+''',''Server Name'') is null alter table ['+@return_temp_table+'] add [Server Name] varchar(128);'
		set @sql=@sql+'if COL_LENGTH(''tempdb..'+@return_temp_table+''',''DB Name'') is null alter table ['+@return_temp_table+'] add [DB Name] varchar(128);'
		exec(@sql)
		set @sql='update t set [Server Name]=r.servername,[DB Name]=r.dbname from #remote_exec_content r,'+@return_temp_table+' t where t.run_id=r.run_id'
		exec(@sql)
   end
if @return_type=N'json'
   begin
	  set @sql=N'select @return_json= (select * from '+@return_temp_table+' for json path,root(''remote_return''))'
	  exec sp_executesql @sql,N'@return_json nvarchar(max) output',@return_json=@return_json output
	  set @json_return=JSON_MODIFY(@json_return,'$.remote_return',json_query(@return_json,'$.remote_return'))
   end
if @debug=1
   select * from #remote_exec_content
return @return    
end try
begin catch
  set @error_msg=ERROR_MESSAGE()
  if @raise_error=1 throw 
  return -102
end catch

GO



CREATE OR ALTER           procedure [dbo].[up_call_os_cmd]
@cmd nvarchar(4000),@json_input nvarchar(max)='{}',@cmd_return nvarchar(max)='{}' output,@error_msg nvarchar(max)='' output
as
declare @return_temp_table varchar(128)=N'',@max_threads int=5,
@cmd_type varchar(20)='OS_CMD',@dry_run bit=0,@debug bit=0,@log bit=1,@stop_by_error bit =1,
@raise_error bit=0,@sql nvarchar(max)

declare @success varchar(20)='success',@failed as varchar(20)='failed'

declare @return int,@return_data nvarchar(max),@arguments nvarchar(max)
declare @guid varchar(100)=replace(convert(varchar(50),newid()),'-',''),@the_date varchar(11)=format(getdate(),'yyyy_MM_dd_')
set @error_msg=''
if isnull(@cmd,'')=''
   begin
      raiserror('@cmd is empty!',16,1)
      return -110
   end
if isjson(@json_input)=0
   begin
      raiserror('@json_input is not formatted as correct json!',16,1)
      return -100
   end
set @arguments=isnull(JSON_VALUE(@json_input,N'$.arguments'),N'')
set @return_temp_table=isnull(JSON_VALUE(@json_input,'$.return_temp_table'),'')
set @dry_run=isnull(JSON_VALUE(@json_input,'$.dry_run'),0)
set @debug=isnull(JSON_VALUE(@json_input,'$.debug'),0)
set @log=isnull(JSON_VALUE(@json_input,'$.log'),1)
set @raise_error=isnull(JSON_VALUE(@json_input,'$.raise_error'),0)
if @return_temp_table<>''
   begin
	  if object_id('tempdb..'+@return_temp_table) is null       
	     begin
			raiserror('Can not find out %s',16,1,@return_temp_table)
			return -100
		end   
   end
if @return_temp_table='#tmp_result' 
   begin
      truncate table #tmp_result
	  set @sql=''
	  select @sql=+@sql+'ALTER TABLE tempdb..#tmp_result DROP COLUMN ['+name+'];' from tempdb.sys.columns 
			where object_id=object_id('tempdb..#tmp_result') AND name <>'run_id' 
      if @sql<>''
	     exec(@sql)
   end

if object_id('tempdb..#remote_exec_content') is not null 
   drop table #remote_exec_content

create table #remote_exec_content (run_id uniqueidentifier not null default(newid()),Threads int default(10),servername varchar(128) default(''),IP_or_DNS varchar(500) default(''),dbname varchar(8000) default(''),TheSQL nvarchar(max),
		[Port] varchar(10) default(''),db_provider varchar(50) default(''),db_driver varchar(100) default(''),username varchar(128) default(''),pwd varchar(128) default(''),connection_options varchar(500) default(''),cmd_type varchar(20) default(''),arguments nvarchar(max) default(N''),
		return_tmp_table varchar(max) default(''),[timeout] int default(120),debug bit default(0), remote_error nvarchar(max) default(N''),remote_output nvarchar(max) default(N''),affected_rows int default(0))

insert #remote_exec_content (TheSQL,servername,username,Threads, cmd_type,arguments)
	values(@cmd,@@servername,suser_sname(),1,@cmd_type,@arguments)
if @dry_run=1
   begin
      select * from #remote_exec_content
      return 0
   end

begin try
exec @return=up_exec_remote_sql @return_msg=@error_msg out,@max_threads=@max_threads,@debug=@debug 
if @return<>0
   select @error_msg=@error_msg+char(13)+isnull(remote_error,N'')  from #remote_exec_content where isnull(remote_error,N'')<>N''
update #remote_exec_content set pwd='*****************'
if @log=1
   insert remote_sql_log (run_id,servername,remote_user,sqlstring,errormsg) select run_id,servername,username, TheSQL,remote_error from #remote_exec_content

if @return_temp_table<>''
   begin
        set @sql='if COL_LENGTH(''tempdb..'+@return_temp_table+''',''run_id'') is null alter table ['+@return_temp_table+'] add [run_id] uniqueidentifier;'
		set @sql=@sql+'if COL_LENGTH(''tempdb..'+@return_temp_table+''',''remote_output'') is null alter table ['+@return_temp_table+'] add [remote_output] nvarchar(max);'
		set @sql=@sql+'if COL_LENGTH(''tempdb..'+@return_temp_table+''',''remote_error'') is null alter table ['+@return_temp_table+'] add [remote_error] nvarchar(max);'
		exec(@sql)
		set @sql='insert ['+@return_temp_table+'] ([run_id],[remote_output],[remote_error]) select [run_id],[remote_output],[remote_error] from #remote_exec_content'
		exec(@sql)
   end

select @cmd_return=isnull(remote_output,N'') from #remote_exec_content 

if @debug=1
   select * from #remote_exec_content
return @return    
end try
begin catch
  select @error_msg=ERROR_MESSAGE(), @cmd_return=N''
  if @raise_error=1 throw 
  return -102
end catch

GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE OR ALTER    procedure [dbo].[up_execute_powershell]
 @ps_scripts nvarchar(max),@return_temp_table varchar(128)='#tmp_result', @error_msg nvarchar(max)='' output,@ps_result nvarchar(max)='{}' output
as
declare @cmd varchar(5000)='',@return int,@json_input nvarchar(max)=N'{}',@ps nvarchar(max),@arguments nvarchar(max)
set @error_msg=''
if isnull(@ps_scripts,'')=''
   begin
       set @error_msg='@ps_scripts is null or empty!'
	   return -100
   end
set @ps=N'try {'+@ps_scripts+N'}
		  catch {Write-Output "PS exception: $($_.Exception.Message)";exit -100}'
set @ps=replace(@ps,'"','\"')
set @arguments='-command "& {'+@ps++'}"'

set @cmd=N'powershell.exe'
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table',@return_temp_table)
set @json_input=JSON_MODIFY(@json_input,'$.arguments',@arguments)

EXEC @return=[dbo].[up_call_os_cmd]
    @cmd=@cmd,
    @json_input = @json_input,
    @cmd_return =@ps_result output,
    @error_msg =@error_msg output

return @return

GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



CREATE OR ALTER        procedure [dbo].[up_execute_aws_cli]
 @aws_cmd nvarchar(max),@profile varchar(400)='',@region varchar(50)='', @return_temp_table varchar(128)='#tmp_result', @error_msg nvarchar(max)='' output,@aws_result nvarchar(max)='{}' output
as
declare @cmd nvarchar(max)='',@return int,@json_input nvarchar(max)=N'{}',@arguments nvarchar(max)
set @error_msg=''
if isnull(@aws_cmd,'')=''
   begin
       set @error_msg='@aws_cmd is null or empty!'
  return -100
   end
if @profile like '@%'
   set @profile=[dbo].[fn_get_para_value](@profile)
if isnull(@profile,'')<>''
  set @aws_cmd=' --profile '+@profile
if @region<>''
 set @aws_cmd=' --region '+@region
set @cmd=N'aws.exe'
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table',@return_temp_table)
set @json_input=JSON_MODIFY(@json_input,'$.arguments',@aws_cmd)

EXEC @return=[dbo].[up_call_os_cmd]
    @cmd=@cmd,
    @json_input = @json_input,
    @cmd_return =@aws_result output,
    @error_msg =@error_msg output

return @return

GO

SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO


 CREATE       procedure [dbo].[up_refresh_dblists]
 @remote_server varchar(4000)='*'
as

declare @json_data varchar(max)='{}',@json_para varchar(max)='{}',@errormsg varchar(4000),
@DBName nvarchar(4000)='master',@ExitCode smallint=0 , @Error_MSG nvarchar(max)='' 
declare @return int,@return_json nvarchar(max),@the_sql nvarchar(max),@json_input nvarchar(max)=N'{}',@json_return nvarchar(max)=N'{}'

set nocount on
if object_id('tempdb..#tmp_result') is not null
     drop table #tmp_result
create table #tmp_result (run_id uniqueidentifier)
set @the_sql=N'get_db_list'
set @json_input=JSON_MODIFY(@json_input,'$.servername_or_list',@remote_server)
set @json_input=JSON_MODIFY(@json_input,'$.dbname_or_list','default')
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table','#tmp_result')
set @json_input=JSON_MODIFY(@json_input,'$.include_remote_info',1)

exec @return=[up_call_sqlfunction] @the_sql=@the_sql,@json_input=@json_input,@error_msg=@error_msg out
if @return=0
	merge into dblist as t using (select * from #tmp_result) as s
	   on (t.servername=s.[server name] and t.dbname=s.dbname)
	   when matched then update set t.last_update=getdate(),t.dbname=s.dbname,t.servername=s.[server name]						
	   when not matched by target then insert ([servername],[dbname],last_update)
							   values (s.[server name],s.dbname,getdate())
	   when not matched by SOURCE and t.servername in (select [server name] from #tmp_result) then delete;
else
   print @error_msg
return 0


GO


SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
create or ALTER   proc [dbo].[up_upsert_server]
@servername varchar(128)=null
,@delete bit=null  --default 0
,@islive bit=null  --default 1
,@ip_or_dns varchar(400)=null -- default @servername
,@port_number int=null
,@username varchar(128)=null --default ''
,@pwd varchar(128)=null --default ''
,@db_provider varchar(128)=null -- default 'MSSQL'
,@odbc_driver varchar(128)=null -- default ''
,@connection_options varchar(4000)=null --default ''
,@notes nvarchar(4000)=null --default ''
as
declare @last_update datetime=getdate()
declare @server_list table (servername varchar(128),islive bit,IP_or_DNS varchar(500),port_number varchar(10),username varchar(128),pwd varchar(128),db_provider varchar(50),odbc_driver varchar(100),connection_options varchar(500),notes nvarchar(4000))

if isnull(@servername,'')=''
   begin
      select * from serverlist order by id
      return 0
   end    
if isnull(@delete,0)=1
   begin
       delete serverlist where servername=@servername
	   select isnull(@servername,'') +' is deleted from serverlist!'  as return_msg
       return 0
   end

insert @server_list (servername,islive,ip_or_dns,port_number,username,pwd,db_provider,odbc_driver,connection_options,notes)
	values (@servername,@islive,@ip_or_dns,@port_number,@username,@pwd,@db_provider,@odbc_driver,@connection_options,@notes)

merge serverlist as t using (select *,@last_update as last_update from @server_list) as s
on (t.servername=s.[servername])
	   when matched then update set t.last_update=s.last_update,
		t.islive=case when s.islive is null then t.islive else s.islive end,
		t.ip_or_dns=case when s.ip_or_dns is null then t.ip_or_dns else s.ip_or_dns end,
		t.port_number=case when s.port_number is null then t.port_number else s.port_number end,
		t.username=case when s.username is null then t.username else s.username end,
		t.db_provider=case when s.db_provider is null then t.db_provider else s.db_provider end,
		t.odbc_driver=case when s.odbc_driver is null then t.odbc_driver else s.odbc_driver end,
		t.connection_options=case when s.connection_options is null then t.connection_options else s.connection_options end,
		t.notes=case when s.notes is null then t.notes else s.notes end
	   when not matched by target then insert (servername,islive,ip_or_dns,port_number,username,pwd,db_provider,odbc_driver,connection_options,last_update,notes)
							   values (s.servername,
							   case when s.islive is null then 1 else s.islive end,
							   case when s.ip_or_dns is null then s.servername else s.ip_or_dns end,
							   case when s.port_number is null then 1433 else s.port_number end,
							   case when s.username is null then '' else s.username end,
							   case when s.pwd is null then '' else s.pwd end,
							   case when s.db_provider is null then '' else s.db_provider end,
							   case when s.odbc_driver is null then '' else s.odbc_driver end,
							   case when s.connection_options is null then '' else s.connection_options end,
							   case when s.notes is null then N'' else s.notes end,
							   s.last_update);
select * from serverlist where servername=@servername;	
GO	
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



 CREATE OR ALTER       procedure [dbo].[up_refresh_instances]
 @remote_server varchar(4000)='*'
as

declare @json_data varchar(max)='{}',@json_para varchar(max)='{}',@errormsg varchar(4000),
@DBName nvarchar(4000)='master',@ExitCode smallint=0 , @Error_MSG nvarchar(max)='' 
declare @return int,@return_json nvarchar(max),@the_sql nvarchar(max),@json_input nvarchar(max)=N'{}',@json_return nvarchar(max)=N'{}'
declare @db_instance_property nvarchar(max)

set nocount on
if object_id('tempdb..#tmp_result') is not null
     drop table #tmp_result
create table #tmp_result (run_id uniqueidentifier)
set @the_sql=N'refresh_instance'
set @json_input=JSON_MODIFY(@json_input,'$.servername_or_list',@remote_server)
set @json_input=JSON_MODIFY(@json_input,'$.dbname_or_list','default')
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table','#tmp_result')
set @json_input=JSON_MODIFY(@json_input,'$.include_remote_info',1)

exec @return=[up_call_sqlfunction] @the_sql=@the_sql,@json_input=@json_input,@error_msg=@error_msg out

if @return=0 or @@ROWCOUNT>0
	begin
		SELECT servername,
			(
				SELECT listeners,dbs_used_gb,defaultdatapath,defaultlogpath,defaultbackuppath,db_instance_version,[certificates],charset,collation
				FROM #tmp_result s2 WHERE s2.[server name] = s1.servername FOR JSON PATH,WITHOUT_ARRAY_WRAPPER
			) AS db_instance_property into #tmp_db_instance_property
		FROM serverlist s1 GROUP BY servername;
		SELECT servername,
			(
				SELECT host,os_free_gb,cpu_count,physical_memory_gb,os_version
				FROM #tmp_result s2
				WHERE s2.[server name] = s1.servername
				FOR JSON PATH,WITHOUT_ARRAY_WRAPPER
			) AS os_property into #tmp_os_property
		FROM serverlist s1 GROUP BY servername;
		merge into serverlist as t using (select r.*,db.db_instance_property,os.os_property 
			from #tmp_result r,#tmp_db_instance_property db,#tmp_os_property os where r.[server name]=db.servername and db.servername=os.servername) as s
		   on (t.servername=s.[server name])
		   when matched then update set t.last_update=getdate(),t.nodelist=s.nodelist,
				t.Last_reboot=s.server_start_time,t.db_instance_property=s.db_instance_property,t.os_property=s.os_property								   
		   when not matched by SOURCE and t.servername in (select [server name] from #tmp_result) then delete;
    end
else
   print @error_msg
return 0

GO
delete sql_functions where fn_name='refresh_instance'
insert sql_functions (db_provider,fn_name,TheSQL) values('MSSQL','refresh_instance',
N'create table #tmp_storage_info (dbs_used_GB smallmoney,os_free_GB smallmoney)
if serverproperty(''EngineEdition'')>=8 
   insert #tmp_storage_info select top 1 storage_space_used_mb/1024.00, (reserved_storage_mb-storage_space_used_mb)/1024.00 from master.sys.server_resource_stats order by start_time desc
else
   begin
		SELECT distinct volume_mount_point,convert(money,(total_bytes-available_bytes)/1024/1024/1024.00) as dbs_used_GB, convert(money,available_bytes/1024/1024/1024.00) as os_free_GB into #tmp1
		   FROM sys.master_files (nolock) AS f  CROSS APPLY sys.dm_os_volume_stats(f.database_id, f.file_id);  
	  	insert #tmp_storage_info select sum(dbs_used_GB) as dbs_used_GB,sum(os_free_GB) as os_free_GB from #tmp1
   end
declare @certificates varchar(max)=(select name,expiry_date,convert(varchar(100),thumbprint,2) as thumbprint from master.sys.certificates where name not like ''##%'' for json path) 
declare @isprimary tinyint=(SELECT case when role=1 then 1 else 0 end FROM sys.dm_hadr_availability_replica_states ars JOIN sys.availability_groups ag ON ars.group_id = ag.group_id AND ars.is_local = 1) 
declare @nodelist varchar(max)=''''
select @nodelist=@nodelist+member_name+'','' from sys.dm_hadr_cluster_members where member_type=0 and SERVERPROPERTY(''IsHadrEnabled'')=1
if @@ROWCOUNT>0
   set @nodelist=left(@nodelist,len(@nodelist)-1)
else
   set @nodelist=null
select HOST_NAME() as Host,dbs_used_GB,os_free_GB,cpu_count,sqlserver_start_time as server_start_time,convert(int,physical_memory_kb/1024/1024) as physical_memory_GB,convert(varchar(500),SERVERPROPERTY(''InstanceDefaultDataPath'')) as DefaultDataPath,convert(varchar(500),SERVERPROPERTY(''InstanceDefaultLogPath'')) as DefaultLogPath,convert(varchar(500),SERVERPROPERTY(''InstanceDefaultBackupPath'')) as DefaultBackupPath,
windows_release as os_version,@@version as db_instance_version,@certificates as [certificates], @nodelist as nodelist, (select top 1 dns_name,port from sys.availability_group_listeners for json path,WITHOUT_ARRAY_WRAPPER) as listeners,convert(nvarchar(500),COLLATIONPROPERTY(convert(nvarchar(500),SERVERPROPERTY(''Collation'')), ''CodePage'')) as [charset],convert(nvarchar(500),SERVERPROPERTY(''Collation'')) as [collation],isnull(@isprimary,0) as isprimary from sys.dm_os_windows_info os,sys.dm_os_sys_info dbsys, #tmp_storage_info s
')

insert sql_functions (db_provider,fn_name,TheSQL) values('MySQL','refresh_instance',
N'SELECT @@hostname as Host,
    sum((data_length + index_length) / 1024 / 1024/1024) AS dbs_used_GB,
	null as os_free_GB,
	null as cpu_count,
	null as server_start_time,
	null as physical_memory_GB,
	@@datadir as DefaultDataPath,
	@@datadir as DefaultLogPath,
	null as DefaultBackupPath,
	@@version_compile_os as os_version,
	(SELECT VERSION()) AS db_instance_version,
	N''{}'' as certificates,
	null as nodelist,
	null as listeners,
    @@character_set_server AS charset,
    @@collation_server AS collation,
	1 as isprimary
FROM information_schema.tables')
insert sql_functions (db_provider,fn_name,TheSQL) values('PostgreSQL','refresh_instance',
N'SELECT 
    '''' AS host,
    COALESCE(SUM(pg_database_size(datname)) / 1024.0 / 1024.0 / 1024.0,0) AS dbs_used_gb,
    0 AS os_free_gb,
    0 AS cpu_count,
    pg_postmaster_start_time() AS server_start_time,
    0 AS physical_memory_gb,
    (SELECT COALESCE(setting,'''') FROM pg_settings WHERE name = ''data_directory'') AS defaultdatapath,
    (SELECT COALESCE(setting,'''') FROM pg_settings WHERE name = ''log_directory'') AS defaultlogpath,
    '''' AS defaultbackuppath,
    '''' AS os_version,
    version() AS db_instance_version,
    ''{}'' AS certificates,
    '''' AS nodelist,
    '''' AS listeners,
    (SELECT COALESCE(setting,'''') FROM pg_settings WHERE name = ''server_encoding'') AS charset,
    (SELECT COALESCE(setting,'''') FROM pg_settings WHERE name = ''lc_collate'') AS collation,
	1 as isprimary
FROM pg_database
WHERE datname NOT IN (''template0'', ''template1'');')

GO


DELETE sql_functions WHERE fn_name='sp_WhoIsActive' AND db_provider='MSSQL'
INSERT sql_functions (FN_NAME,db_provider,TheSQL) VALUES ('sp_WhoIsActive','MSSQL',
'
/*********************************************************************************************
Who Is Active? v12.00 (2021-11-10)
(C) 2007-2021, Adam Machanic

Feedback: https://github.com/amachanic/sp_whoisactive/issues
Releases: https://github.com/amachanic/sp_whoisactive/releases
Docs: http://whoisactive.com

License:
    https://github.com/amachanic/sp_whoisactive/blob/master/LICENSE
*********************************************************************************************/
-- CREATE OR ALTER     PROC [dbo].[sp_WhoIsActive]
DECLARE
--~
    --Filters--Both inclusive and exclusive
    --Set either filter to '''' to disable
    --Valid filter types are: session, program, database, login, and host
    --Session is a session ID, and either 0 or '''' can be used to indicate "all" sessions
    --All other filter types support % or _ as wildcards
    @filter sysname = '''',
    @filter_type VARCHAR(10) = ''session'',
    @not_filter sysname = '''',
    @not_filter_type VARCHAR(10) = ''session'',

    --Retrieve data about the calling session?
    @show_own_spid BIT = 0,

    --Retrieve data about system sessions?
    @show_system_spids BIT = 0,

    --Controls how sleeping SPIDs are handled, based on the idea of levels of interest
    --0 does not pull any sleeping SPIDs
    --1 pulls only those sleeping SPIDs that also have an open transaction
    --2 pulls all sleeping SPIDs
    @show_sleeping_spids TINYINT = 1,

    --If 1, gets the full stored procedure or running batch, when available
    --If 0, gets only the actual statement that is currently running in the batch or procedure
    @get_full_inner_text BIT = 0,

    --Get associated query plans for running tasks, if available
    --If @get_plans = 1, gets the plan based on the request''s statement offset
    --If @get_plans = 2, gets the entire plan based on the request''s plan_handle
    @get_plans TINYINT = 0,

    --Get the associated outer ad hoc query or stored procedure call, if available
    @get_outer_command BIT = 0,

    --Enables pulling transaction log write info, transaction duration, and the
    --implicit_transaction identification column
    @get_transaction_info BIT = 0,

    --Get information on active tasks, based on three interest levels
    --Level 0 does not pull any task-related information
    --Level 1 is a lightweight mode that pulls the top non-CXPACKET wait, giving preference to blockers
    --Level 2 pulls all available task-based metrics, including:
    --number of active tasks, current wait stats, physical I/O, context switches, and blocker information
    @get_task_info TINYINT = 1,

    --Gets associated locks for each request, aggregated in an XML format
    @get_locks BIT = 0,

    --Get average time for past runs of an active query
    --(based on the combination of plan handle, sql handle, and offset)
    @get_avg_time BIT = 0,

    --Get additional non-performance-related information about the session or request
    --text_size, language, date_format, date_first, quoted_identifier, arithabort, ansi_null_dflt_on,
    --ansi_defaults, ansi_warnings, ansi_padding, ansi_nulls, concat_null_yields_null,
    --transaction_isolation_level, lock_timeout, deadlock_priority, row_count, command_type
    --
    --If a SQL Agent job is running, an subnode called agent_info will be populated with some or all of
    --the following: job_id, job_name, step_id, step_name, msdb_query_error (in the event of an error)
    --
    --If @get_task_info is set to 2 and a lock wait is detected, a subnode called block_info will be
    --populated with some or all of the following: lock_type, database_name, object_id, file_id, hobt_id,
    --applock_hash, metadata_resource, metadata_class_id, object_name, schema_name
    @get_additional_info BIT = 0,

    --Get additional information related to workspace memory
    --requested_memory, granted_memory, max_used_memory, and memory_info.
    --
    --Not available for SQL Server 2005.
    @get_memory_info BIT = 0,

    --Walk the blocking chain and count the number of
    --total SPIDs blocked all the way down by a given session
    --Also enables task_info Level 1, if @get_task_info is set to 0
    @find_block_leaders BIT = 1,

    --Pull deltas on various metrics
    --Interval in seconds to wait before doing the second data pull
    @delta_interval TINYINT = 15,

    --List of desired output columns, in desired order
    --Note that the final output will be the intersection of all enabled features and all
    --columns in the list. Therefore, only columns associated with enabled features will
    --actually appear in the output. Likewise, removing columns from this list may effectively
    --disable features, even if they are turned on
    --
    --Each element in this list must be one of the valid output column names. Names must be
    --delimited by square brackets. White space, formatting, and additional characters are
    --allowed, as long as the list contains exact matches of delimited valid column names.
    @output_column_list VARCHAR(8000) = ''[dd%][session_id][sql_text][sql_command][login_name][wait_info][tasks][tran_log%][cpu%][temp%][block%][reads%][writes%][context%][physical%][query_plan][locks][%]'',

    --Column(s) by which to sort output, optionally with sort directions.
        --Valid column choices:
        --session_id, physical_io, reads, physical_reads, writes, tempdb_allocations,
        --tempdb_current, CPU, context_switches, used_memory, physical_io_delta, reads_delta,
        --physical_reads_delta, writes_delta, tempdb_allocations_delta, tempdb_current_delta,
        --CPU_delta, context_switches_delta, used_memory_delta, tasks, tran_start_time,
        --open_tran_count, blocking_session_id, blocked_session_count, percent_complete,
        --host_name, login_name, database_name, start_time, login_time, program_name
        --
        --Note that column names in the list must be bracket-delimited. Commas and/or white
        --space are not required.
    @sort_order VARCHAR(500) = ''[start_time] ASC'',

    --Formats some of the output columns in a more "human readable" form
    --0 disables outfput format
    --1 formats the output for variable-width fonts
    --2 formats the output for fixed-width fonts
    @format_output TINYINT = 1,

    --If set to a non-blank value, the script will attempt to insert into the specified
    --destination table. Please note that the script will not verify that the table exists,
    --or that it has the correct schema, before doing the insert.
    --Table can be specified in one, two, or three-part format
    @destination_table VARCHAR(4000) = '''',

    --If set to 1, no data collection will happen and no result set will be returned; instead,
    --a CREATE TABLE statement will be returned via the @schema parameter, which will match
    --the schema of the result set that would be returned by using the same collection of the
    --rest of the parameters. The CREATE TABLE statement will have a placeholder token of
    --<table_name> in place of an actual table name.
    @return_schema BIT = 0,
    @schema VARCHAR(MAX) = NULL,

    --Help! What do I do?
    @help BIT = 0
--~

/*
OUTPUT COLUMNS
--------------
Formatted/Non:    [session_id] [smallint] NOT NULL
    Session ID (a.k.a. SPID)

Formatted:        [dd hh:mm:ss.mss] [varchar](15) NULL
Non-Formatted:    <not returned>
    For an active request, time the query has been running
    For a sleeping session, time since the last batch completed

Formatted:        [dd hh:mm:ss.mss (avg)] [varchar](15) NULL
Non-Formatted:    [avg_elapsed_time] [int] NULL
    (Requires @get_avg_time option)
    How much time has the active portion of the query taken in the past, on average?

Formatted:        [physical_io] [varchar](30) NULL
Non-Formatted:    [physical_io] [bigint] NULL
    Shows the number of physical I/Os, for active requests

Formatted:        [reads] [varchar](30) NULL
Non-Formatted:    [reads] [bigint] NULL
    For an active request, number of reads done for the current query
    For a sleeping session, total number of reads done over the lifetime of the session

Formatted:        [physical_reads] [varchar](30) NULL
Non-Formatted:    [physical_reads] [bigint] NULL
    For an active request, number of physical reads done for the current query
    For a sleeping session, total number of physical reads done over the lifetime of the session

Formatted:        [writes] [varchar](30) NULL
Non-Formatted:    [writes] [bigint] NULL
    For an active request, number of writes done for the current query
    For a sleeping session, total number of writes done over the lifetime of the session

Formatted:        [tempdb_allocations] [varchar](30) NULL
Non-Formatted:    [tempdb_allocations] [bigint] NULL
    For an active request, number of TempDB writes done for the current query
    For a sleeping session, total number of TempDB writes done over the lifetime of the session

Formatted:        [tempdb_current] [varchar](30) NULL
Non-Formatted:    [tempdb_current] [bigint] NULL
    For an active request, number of TempDB pages currently allocated for the query
    For a sleeping session, number of TempDB pages currently allocated for the session

Formatted:        [CPU] [varchar](30) NULL
Non-Formatted:    [CPU] [bigint] NULL
    For an active request, total CPU time consumed by the current query
    For a sleeping session, total CPU time consumed over the lifetime of the session

Formatted:        [context_switches] [varchar](30) NULL
Non-Formatted:    [context_switches] [bigint] NULL
    Shows the number of context switches, for active requests

Formatted:        [used_memory] [varchar](30) NOT NULL
Non-Formatted:    [used_memory] [bigint] NOT NULL
    For an active request, total memory consumption for the current query
    For a sleeping session, total current memory consumption

Formatted:        [max_used_memory] [varchar](30) NULL
Non-Formatted:    [max_used_memory] [bigint] NULL
    (Requires @get_memory_info = 1)
    For an active request, the maximum amount of memory that has been used during
    processing up to the point of observation for the current query

Formatted:        [requested_memory] [varchar](30) NULL
Non-Formatted:    [requested_memory] [bigint] NULL
    (Requires @get_memory_info = 1)
    For an active request, the amount of memory requested by the query processor
    for hash, sort, and parallelism operations

Formatted:        [granted_memory] [varchar](30) NULL
Non-Formatted:    [granted_memory] [bigint] NULL
    (Requires @get_memory_info = 1)
    For an active request, the amount of memory granted to the query processor
    for hash, sort, and parallelism operations

Formatted:        [physical_io_delta] [varchar](30) NULL
Non-Formatted:    [physical_io_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of physical I/Os reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [reads_delta] [varchar](30) NULL
Non-Formatted:    [reads_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of reads reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [physical_reads_delta] [varchar](30) NULL
Non-Formatted:    [physical_reads_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of physical reads reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [writes_delta] [varchar](30) NULL
Non-Formatted:    [writes_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of writes reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [tempdb_allocations_delta] [varchar](30) NULL
Non-Formatted:    [tempdb_allocations_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of TempDB writes reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [tempdb_current_delta] [varchar](30) NULL
Non-Formatted:    [tempdb_current_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the number of allocated TempDB pages reported on the first and second
    collections. If the request started after the first collection, the value will be NULL

Formatted:        [CPU_delta] [varchar](30) NULL
Non-Formatted:    [CPU_delta] [int] NULL
    (Requires @delta_interval option)
    Difference between the CPU time reported on the first and second collections.
    If the request started after the first collection, the value will be NULL

Formatted:        [context_switches_delta] [varchar](30) NULL
Non-Formatted:    [context_switches_delta] [bigint] NULL
    (Requires @delta_interval option)
    Difference between the context switches count reported on the first and second collections
    If the request started after the first collection, the value will be NULL

Formatted:        [used_memory_delta] [varchar](30) NULL
Non-Formatted:    [used_memory_delta] [bigint] NULL
    Difference between the memory usage reported on the first and second collections
    If the request started after the first collection, the value will be NULL

Formatted:        [max_used_memory_delta] [varchar](30) NULL
Non-Formatted:    [max_used_memory_delta] [bigint] NULL
    Difference between the max memory usage reported on the first and second collections
    If the request started after the first collection, the value will be NULL

Formatted:        [tasks] [varchar](30) NULL
Non-Formatted:    [tasks] [smallint] NULL
    Number of worker tasks currently allocated, for active requests

Formatted/Non:    [status] [varchar](30) NOT NULL
    Activity status for the session (running, sleeping, etc)

Formatted/Non:    [wait_info] [nvarchar](4000) NULL
    Aggregates wait information, in the following format:
        (Ax: Bms/Cms/Dms)E
    A is the number of waiting tasks currently waiting on resource type E. B/C/D are wait
    times, in milliseconds. If only one thread is waiting, its wait time will be shown as B.
    If two tasks are waiting, each of their wait times will be shown (B/C). If three or more
    tasks are waiting, the minimum, average, and maximum wait times will be shown (B/C/D).
    If wait type E is a page latch wait and the page is of a "special" type (e.g. PFS, GAM, SGAM),
    the page type will be identified.
    If wait type E is CXPACKET, CXCONSUMER, CXSYNC_PORT, or CXSYNC_CONSUMER the nodeId from the
    query plan will be identified

Formatted/Non:    [locks] [xml] NULL
    (Requires @get_locks option)
    Aggregates lock information, in XML format.
    The lock XML includes the lock mode, locked object, and aggregates the number of requests.
    Attempts are made to identify locked objects by name

Formatted/Non:    [tran_start_time] [datetime] NULL
    (Requires @get_transaction_info option)
    Date and time that the first transaction opened by a session caused a transaction log
    write to occur.

Formatted/Non:    [tran_log_writes] [nvarchar](4000) NULL
    (Requires @get_transaction_info option)
    Aggregates transaction log write information, in the following format:
    A:wB (C kB)
    A is a database that has been touched by an active transaction
    B is the number of log writes that have been made in the database as a result of the transaction
    C is the number of log kilobytes consumed by the log records

Formatted/Non:    [implicit_tran] [nvarchar](3) NULL
    (Requires @get_transaction_info option)
    For active read-write transactions, returns on "ON" the transaction has been started as a result
    of the session using the implicit_transactions option, or "OFF" otherwise.

Formatted:        [open_tran_count] [varchar](30) NULL
Non-Formatted:    [open_tran_count] [smallint] NULL
    Shows the number of open transactions the session has open

Formatted:        [sql_command] [xml] NULL
Non-Formatted:    [sql_command] [nvarchar](max) NULL
    (Requires @get_outer_command option)
    Shows the "outer" SQL command, i.e. the text of the batch or RPC sent to the server,
    if available

Formatted:        [sql_text] [xml] NULL
Non-Formatted:    [sql_text] [nvarchar](max) NULL
    Shows the SQL text for active requests or the last statement executed
    for sleeping sessions, if available in either case.
    If @get_full_inner_text option is set, shows the full text of the batch.
    Otherwise, shows only the active statement within the batch.
    If the query text is locked, a special timeout message will be sent, in the following format:
        <timeout_exceeded />
    If an error occurs, an error message will be sent, in the following format:
        <error message="message" />

Formatted/Non:    [query_plan] [xml] NULL
    (Requires @get_plans option)
    Shows the query plan for the request, if available.
    If the plan is locked, a special timeout message will be sent, in the following format:
        <timeout_exceeded />
    If an error occurs, an error message will be sent, in the following format:
        <error message="message" />

Formatted/Non:    [blocking_session_id] [smallint] NULL
    When applicable, shows the blocking SPID

Formatted:        [blocked_session_count] [varchar](30) NULL
Non-Formatted:    [blocked_session_count] [smallint] NULL
    (Requires @find_block_leaders option)
    The total number of SPIDs blocked by this session,
    all the way down the blocking chain.

Formatted:        [percent_complete] [varchar](30) NULL
Non-Formatted:    [percent_complete] [real] NULL
    When applicable, shows the percent complete (e.g. for backups, restores, and some rollbacks)

Formatted/Non:    [host_name] [sysname] NOT NULL
    Shows the host name for the connection

Formatted/Non:    [login_name] [sysname] NOT NULL
    Shows the login name for the connection

Formatted/Non:    [database_name] [sysname] NULL
    Shows the connected database

Formatted/Non:    [program_name] [sysname] NULL
    Shows the reported program/application name

Formatted/Non:    [additional_info] [xml] NULL
    (Requires @get_additional_info option)
    Returns additional non-performance-related session/request information
    If the script finds a SQL Agent job running, the name of the job and job step will be reported
    If @get_task_info = 2 and the script finds a lock wait, the locked object will be reported

Formatted/Non:    [start_time] [datetime] NOT NULL
    For active requests, shows the time the request started
    For sleeping sessions, shows the time the last batch completed

Formatted/Non:    [login_time] [datetime] NOT NULL
    Shows the time that the session connected

Formatted/Non:    [request_id] [int] NULL
    For active requests, shows the request_id
    Should be 0 unless MARS is being used

Formatted/Non:    [collection_time] [datetime] NOT NULL
    Time that this script''s final SELECT ran

Formatted/Non:    [memory_info] [xml] NULL
    (Requires @get_memory_info)
    For active queries that require workspace memory, returns information on memory grants,
    resource semaphores, and the resource governor settings that are impacting the allocation.
*/

BEGIN;
    SET NOCOUNT ON;
    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;
    SET QUOTED_IDENTIFIER ON;
    SET ANSI_PADDING ON;
    SET CONCAT_NULL_YIELDS_NULL ON;
    SET ANSI_WARNINGS ON;
    SET NUMERIC_ROUNDABORT OFF;
    SET ARITHABORT ON;
	declare @cpu_usage tinyint=0

	SELECT TOP(1) @cpu_usage= SQLProcessUtilization FROM (SELECT record.value(''(./Record/@id)[1]'', ''int'') AS record_id,
		record.value(''(./Record/SchedulerMonitorEvent/SystemHealth/ProcessUtilization)[1]'',''int'') AS [SQLProcessUtilization]
		FROM (SELECT CONVERT(xml, record) AS [record] FROM sys.dm_os_ring_buffers WHERE ring_buffer_type = N''RING_BUFFER_SCHEDULER_MONITOR'' AND record LIKE ''%<SystemHealth>%'') AS x
		) AS y ORDER BY record_id DESC;

    IF
        @filter IS NULL
        OR @filter_type IS NULL
        OR @not_filter IS NULL
        OR @not_filter_type IS NULL
        OR @show_own_spid IS NULL
        OR @show_system_spids IS NULL
        OR @show_sleeping_spids IS NULL
        OR @get_full_inner_text IS NULL
        OR @get_plans IS NULL
        OR @get_outer_command IS NULL
        OR @get_transaction_info IS NULL
        OR @get_task_info IS NULL
        OR @get_locks IS NULL
        OR @get_avg_time IS NULL
        OR @get_additional_info IS NULL
        OR @find_block_leaders IS NULL
        OR @delta_interval IS NULL
        OR @format_output IS NULL
        OR @output_column_list IS NULL
        OR @sort_order IS NULL
        OR @return_schema IS NULL
        OR @destination_table IS NULL
        OR @help IS NULL
    BEGIN;
        RAISERROR(''Input parameters cannot be NULL'', 16, 1);
        RETURN;
    END;
   
    IF @filter_type NOT IN (''session'', ''program'', ''database'', ''login'', ''host'')
    BEGIN;
        RAISERROR(''Valid filter types are: session, program, database, login, host'', 16, 1);
        RETURN;
    END;
   
    IF @filter_type = ''session'' AND @filter LIKE ''%[^0123456789]%''
    BEGIN;
        RAISERROR(''Session filters must be valid integers'', 16, 1);
        RETURN;
    END;
   
    IF @not_filter_type NOT IN (''session'', ''program'', ''database'', ''login'', ''host'')
    BEGIN;
        RAISERROR(''Valid filter types are: session, program, database, login, host'', 16, 1);
        RETURN;
    END;
   
    IF @not_filter_type = ''session'' AND @not_filter LIKE ''%[^0123456789]%''
    BEGIN;
        RAISERROR(''Session filters must be valid integers'', 16, 1);
        RETURN;
    END;
   
    IF @show_sleeping_spids NOT IN (0, 1, 2)
    BEGIN;
        RAISERROR(''Valid values for @show_sleeping_spids are: 0, 1, or 2'', 16, 1);
        RETURN;
    END;
   
    IF @get_plans NOT IN (0, 1, 2)
    BEGIN;
        RAISERROR(''Valid values for @get_plans are: 0, 1, or 2'', 16, 1);
        RETURN;
    END;

    IF @get_task_info NOT IN (0, 1, 2)
    BEGIN;
        RAISERROR(''Valid values for @get_task_info are: 0, 1, or 2'', 16, 1);
        RETURN;
    END;

    IF @format_output NOT IN (0, 1, 2)
    BEGIN;
        RAISERROR(''Valid values for @format_output are: 0, 1, or 2'', 16, 1);
        RETURN;
    END;

    IF @get_memory_info = 1 AND NOT EXISTS (SELECT * FROM sys.all_objects WHERE name = ''resource_governor_resource_pools'')
    BEGIN;
        RAISERROR(''@get_memory_info is not available for SQL Server 2005.'', 16, 1);
        RETURN;
    END;

    IF @help = 1
    BEGIN;
        DECLARE
            @header VARCHAR(MAX),
            @params VARCHAR(MAX),
            @outputs VARCHAR(MAX);

        SELECT
            @header =
                REPLACE
                (
                    REPLACE
                    (
                        CONVERT
                        (
                            VARCHAR(MAX),
                            SUBSTRING
                            (
                                t.text,
                                CHARINDEX(''/'' + REPLICATE(''*'', 93), t.text) + 94,
                                CHARINDEX(REPLICATE(''*'', 93) + ''/'', t.text) - (CHARINDEX(''/'' + REPLICATE(''*'', 93), t.text) + 94)
                            )
                        ),
                        CHAR(13)+CHAR(10),
                        CHAR(13)
                    ),
                    ''    '',
                    ''''
                ),
            @params =
                CHAR(13) +
                    REPLACE
                    (
                        REPLACE
                        (
                            CONVERT
                            (
                                VARCHAR(MAX),
                                SUBSTRING
                                (
                                    t.text,
                                    CHARINDEX(''--~'', t.text) + 5,
                                    CHARINDEX(''--~'', t.text, CHARINDEX(''--~'', t.text) + 5) - (CHARINDEX(''--~'', t.text) + 5)
                                )
                            ),
                            CHAR(13)+CHAR(10),
                            CHAR(13)
                        ),
                        ''    '',
                        ''''
                    ),
                @outputs =
                    CHAR(13) +
                        REPLACE
                        (
                            REPLACE
                            (
                                REPLACE
                                (
                                    CONVERT
                                    (
                                        VARCHAR(MAX),
                                        SUBSTRING
                                        (
                                            t.text,
                                            CHARINDEX(''OUTPUT COLUMNS''+CHAR(13)+CHAR(10)+''--------------'', t.text) + 32,
                                            CHARINDEX(''*/'', t.text, CHARINDEX(''OUTPUT COLUMNS''+CHAR(13)+CHAR(10)+''--------------'', t.text) + 32) - (CHARINDEX(''OUTPUT COLUMNS''+CHAR(13)+CHAR(10)+''--------------'', t.text) + 32)
                                        )
                                    ),
                                    ''    '',
                                    CHAR(255)
                                ),
                                CHAR(13)+CHAR(10),
                                CHAR(13)
                            ),
                            ''    '',
                            ''''
                        ) +
                        CHAR(13)
        FROM sys.dm_exec_requests AS r
        CROSS APPLY sys.dm_exec_sql_text(r.sql_handle) AS t
        WHERE
            r.session_id = @@SPID;

        WITH
        a0 AS
        (SELECT 1 AS n UNION ALL SELECT 1),
        a1 AS
        (SELECT 1 AS n FROM a0 AS a CROSS JOIN a0 AS b),
        a2 AS
        (SELECT 1 AS n FROM a1 AS a CROSS JOIN a1 AS b),
        a3 AS
        (SELECT 1 AS n FROM a2 AS a CROSS JOIN a2 AS b),
        a4 AS
        (SELECT 1 AS n FROM a3 AS a CROSS JOIN a3 AS b),
        numbers AS
        (
            SELECT TOP(LEN(@header) - 1)
                ROW_NUMBER() OVER
                (
                    ORDER BY (SELECT NULL)
                ) AS number
            FROM a4
            ORDER BY
                number
        )
        SELECT
            RTRIM(LTRIM(
                SUBSTRING
                (
                    @header,
                    number + 1,
                    CHARINDEX(CHAR(13), @header, number + 1) - number - 1
                )
            )) AS [------header---------------------------------------------------------------------------------------------------------------]
        FROM numbers
        WHERE
            SUBSTRING(@header, number, 1) = CHAR(13);

        WITH
        a0 AS
        (SELECT 1 AS n UNION ALL SELECT 1),
        a1 AS
        (SELECT 1 AS n FROM a0 AS a CROSS JOIN a0 AS b),
        a2 AS
        (SELECT 1 AS n FROM a1 AS a CROSS JOIN a1 AS b),
        a3 AS
        (SELECT 1 AS n FROM a2 AS a CROSS JOIN a2 AS b),
        a4 AS
        (SELECT 1 AS n FROM a3 AS a CROSS JOIN a3 AS b),
        numbers AS
        (
            SELECT TOP(LEN(@params) - 1)
                ROW_NUMBER() OVER
                (
                    ORDER BY (SELECT NULL)
                ) AS number
            FROM a4
            ORDER BY
                number
        ),
        tokens AS
        (
            SELECT
                RTRIM(LTRIM(
                    SUBSTRING
                    (
                        @params,
                        number + 1,
                        CHARINDEX(CHAR(13), @params, number + 1) - number - 1
                    )
                )) AS token,
                number,
                CASE
                    WHEN SUBSTRING(@params, number + 1, 1) = CHAR(13) THEN number
                    ELSE COALESCE(NULLIF(CHARINDEX('','' + CHAR(13) + CHAR(13), @params, number), 0), LEN(@params))
                END AS param_group,
                ROW_NUMBER() OVER
                (
                    PARTITION BY
                        CHARINDEX('','' + CHAR(13) + CHAR(13), @params, number),
                        SUBSTRING(@params, number+1, 1)
                    ORDER BY
                        number
                ) AS group_order
            FROM numbers
            WHERE
                SUBSTRING(@params, number, 1) = CHAR(13)
        ),
        parsed_tokens AS
        (
            SELECT
                MIN
                (
                    CASE
                        WHEN token LIKE ''@%'' THEN token
                        ELSE NULL
                    END
                ) AS parameter,
                MIN
                (
                    CASE
                        WHEN token LIKE ''--%'' THEN RIGHT(token, LEN(token) - 2)
                        ELSE NULL
                    END
                ) AS description,
                param_group,
                group_order
            FROM tokens
            WHERE
                NOT
                (
                    token = ''''
                    AND group_order > 1
                )
            GROUP BY
                param_group,
                group_order
        )
        SELECT
            CASE
                WHEN description IS NULL AND parameter IS NULL THEN ''-------------------------------------------------------------------------''
                WHEN param_group = MAX(param_group) OVER() THEN parameter
                ELSE COALESCE(LEFT(parameter, LEN(parameter) - 1), '''')
            END AS [------parameter----------------------------------------------------------],
            CASE
                WHEN description IS NULL AND parameter IS NULL THEN ''----------------------------------------------------------------------------------------------------------------------''
                ELSE COALESCE(description, '''')
            END AS [------description-----------------------------------------------------------------------------------------------------]
        FROM parsed_tokens
        ORDER BY
            param_group,
            group_order;
       
        WITH
        a0 AS
        (SELECT 1 AS n UNION ALL SELECT 1),
        a1 AS
        (SELECT 1 AS n FROM a0 AS a CROSS JOIN a0 AS b),
        a2 AS
        (SELECT 1 AS n FROM a1 AS a CROSS JOIN a1 AS b),
        a3 AS
        (SELECT 1 AS n FROM a2 AS a CROSS JOIN a2 AS b),
        a4 AS
        (SELECT 1 AS n FROM a3 AS a CROSS JOIN a3 AS b),
        numbers AS
        (
            SELECT TOP(LEN(@outputs) - 1)
                ROW_NUMBER() OVER
                (
                    ORDER BY (SELECT NULL)
                ) AS number
            FROM a4
            ORDER BY
                number
        ),
        tokens AS
        (
            SELECT
                RTRIM(LTRIM(
                    SUBSTRING
                    (
                        @outputs,
                        number + 1,
                        CASE
                            WHEN
                                COALESCE(NULLIF(CHARINDEX(CHAR(13) + ''Formatted'', @outputs, number + 1), 0), LEN(@outputs)) <
                                    COALESCE(NULLIF(CHARINDEX(CHAR(13) + CHAR(255) COLLATE Latin1_General_Bin2, @outputs, number + 1), 0), LEN(@outputs))
                                THEN COALESCE(NULLIF(CHARINDEX(CHAR(13) + ''Formatted'', @outputs, number + 1), 0), LEN(@outputs)) - number - 1
                            ELSE
                                COALESCE(NULLIF(CHARINDEX(CHAR(13) + CHAR(255) COLLATE Latin1_General_Bin2, @outputs, number + 1), 0), LEN(@outputs)) - number - 1
                        END
                    )
                )) AS token,
                number,
                COALESCE(NULLIF(CHARINDEX(CHAR(13) + ''Formatted'', @outputs, number + 1), 0), LEN(@outputs)) AS output_group,
                ROW_NUMBER() OVER
                (
                    PARTITION BY
                        COALESCE(NULLIF(CHARINDEX(CHAR(13) + ''Formatted'', @outputs, number + 1), 0), LEN(@outputs))
                    ORDER BY
                        number
                ) AS output_group_order
            FROM numbers
            WHERE
                SUBSTRING(@outputs, number, 10) = CHAR(13) + ''Formatted''
                OR SUBSTRING(@outputs, number, 2) = CHAR(13) + CHAR(255) COLLATE Latin1_General_Bin2
        ),
        output_tokens AS
        (
            SELECT
                *,
                CASE output_group_order
                    WHEN 2 THEN MAX(CASE output_group_order WHEN 1 THEN token ELSE NULL END) OVER (PARTITION BY output_group)
                    ELSE ''''
                END COLLATE Latin1_General_Bin2 AS column_info
            FROM tokens
        )
        SELECT
            CASE output_group_order
                WHEN 1 THEN ''-----------------------------------''
                WHEN 2 THEN
                    CASE
                        WHEN CHARINDEX(''Formatted/Non:'', column_info) = 1 THEN
                            SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info)+1, CHARINDEX('']'', column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info)+2) - CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info))
                        ELSE
                            SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info)+2, CHARINDEX('']'', column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info)+2) - CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info)-1)
                    END
                ELSE ''''
            END AS formatted_column_name,
            CASE output_group_order
                WHEN 1 THEN ''-----------------------------------''
                WHEN 2 THEN
                    CASE
                        WHEN CHARINDEX(''Formatted/Non:'', column_info) = 1 THEN
                            SUBSTRING(column_info, CHARINDEX('']'', column_info)+2, LEN(column_info))
                        ELSE
                            SUBSTRING(column_info, CHARINDEX('']'', column_info)+2, CHARINDEX(''Non-Formatted:'', column_info, CHARINDEX('']'', column_info)+2) - CHARINDEX('']'', column_info)-3)
                    END
                ELSE ''''
            END AS formatted_column_type,
            CASE output_group_order
                WHEN 1 THEN ''---------------------------------------''
                WHEN 2 THEN
                    CASE
                        WHEN CHARINDEX(''Formatted/Non:'', column_info) = 1 THEN ''''
                        ELSE
                            CASE
                                WHEN SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1, 1) = ''<'' THEN
                                    SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1, CHARINDEX(''>'', column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1) - CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info)))
                                ELSE
                                    SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1, CHARINDEX('']'', column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1) - CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info)))
                            END
                    END
                ELSE ''''
            END AS unformatted_column_name,
            CASE output_group_order
                WHEN 1 THEN ''---------------------------------------''
                WHEN 2 THEN
                    CASE
                        WHEN CHARINDEX(''Formatted/Non:'', column_info) = 1 THEN ''''
                        ELSE
                            CASE
                                WHEN SUBSTRING(column_info, CHARINDEX(CHAR(255) COLLATE Latin1_General_Bin2, column_info, CHARINDEX(''Non-Formatted:'', column_info))+1, 1) = ''<'' THEN ''''
                                ELSE
                                    SUBSTRING(column_info, CHARINDEX('']'', column_info, CHARINDEX(''Non-Formatted:'', column_info))+2, CHARINDEX(''Non-Formatted:'', column_info, CHARINDEX('']'', column_info)+2) - CHARINDEX('']'', column_info)-3)
                            END
                    END
                ELSE ''''
            END AS unformatted_column_type,
            CASE output_group_order
                WHEN 1 THEN ''----------------------------------------------------------------------------------------------------------------------''
                ELSE REPLACE(token, CHAR(255) COLLATE Latin1_General_Bin2, '''')
            END AS [------description-----------------------------------------------------------------------------------------------------]
        FROM output_tokens
        WHERE
            NOT
            (
                output_group_order = 1
                AND output_group = LEN(@outputs)
            )
        ORDER BY
            output_group,
            CASE output_group_order
                WHEN 1 THEN 99
                ELSE output_group_order
            END;

        RETURN;
    END;

    WITH
    a0 AS
    (SELECT 1 AS n UNION ALL SELECT 1),
    a1 AS
    (SELECT 1 AS n FROM a0 AS a CROSS JOIN a0 AS b),
    a2 AS
    (SELECT 1 AS n FROM a1 AS a CROSS JOIN a1 AS b),
    a3 AS
    (SELECT 1 AS n FROM a2 AS a CROSS JOIN a2 AS b),
    a4 AS
    (SELECT 1 AS n FROM a3 AS a CROSS JOIN a3 AS b),
    numbers AS
    (
        SELECT TOP(LEN(@output_column_list))
            ROW_NUMBER() OVER
            (
                ORDER BY (SELECT NULL)
            ) AS number
        FROM a4
        ORDER BY
            number
    ),
    tokens AS
    (
        SELECT
            ''|['' +
                SUBSTRING
                (
                    @output_column_list,
                    number + 1,
                    CHARINDEX('']'', @output_column_list, number) - number - 1
                ) + ''|]'' AS token,
            number
        FROM numbers
        WHERE
            SUBSTRING(@output_column_list, number, 1) = ''[''
    ),
    ordered_columns AS
    (
        SELECT
            x.column_name,
            ROW_NUMBER() OVER
            (
                PARTITION BY
                    x.column_name
                ORDER BY
                    tokens.number,
                    x.default_order
            ) AS r,
            ROW_NUMBER() OVER
            (
                ORDER BY
                    tokens.number,
                    x.default_order
            ) AS s
        FROM tokens
        JOIN
        (
            SELECT ''[session_id]'' AS column_name, 1 AS default_order
            UNION ALL
            SELECT ''[dd hh:mm:ss.mss]'', 2
            WHERE
                @format_output IN (1, 2)
            UNION ALL
            SELECT ''[dd hh:mm:ss.mss (avg)]'', 3
            WHERE
                @format_output IN (1, 2)
                AND @get_avg_time = 1
            UNION ALL
            SELECT ''[avg_elapsed_time]'', 4
            WHERE
                @format_output = 0
                AND @get_avg_time = 1
            UNION ALL
            SELECT ''[physical_io]'', 5
            WHERE
                @get_task_info = 2
            UNION ALL
            SELECT ''[reads]'', 6
            UNION ALL
            SELECT ''[physical_reads]'', 7
            UNION ALL
            SELECT ''[writes]'', 8
            UNION ALL
            SELECT ''[tempdb_allocations]'', 9
            UNION ALL
            SELECT ''[tempdb_current]'', 10
            UNION ALL
            SELECT ''[CPU]'', 11
            UNION ALL
            SELECT ''[context_switches]'', 12
            WHERE
                @get_task_info = 2
            UNION ALL
            SELECT ''[used_memory]'', 13
            UNION ALL
            SELECT ''[max_used_memory]'', 14
            WHERE
                @get_memory_info = 1
            UNION ALL
            SELECT ''[requested_memory]'', 15
            WHERE
                @get_memory_info = 1
            UNION ALL
            SELECT ''[granted_memory]'', 16
            WHERE
                @get_memory_info = 1
            UNION ALL
            SELECT ''[physical_io_delta]'', 17
            WHERE
                @delta_interval > 0   
                AND @get_task_info = 2
            UNION ALL
            SELECT ''[reads_delta]'', 18
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[physical_reads_delta]'', 19
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[writes_delta]'', 20
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[tempdb_allocations_delta]'', 21
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[tempdb_current_delta]'', 22
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[CPU_delta]'', 23
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[context_switches_delta]'', 24
            WHERE
                @delta_interval > 0
                AND @get_task_info = 2
            UNION ALL
            SELECT ''[used_memory_delta]'', 25
            WHERE
                @delta_interval > 0
            UNION ALL
            SELECT ''[max_used_memory_delta]'', 26
            WHERE
                @delta_interval > 0
                AND @get_memory_info = 1
            UNION ALL
            SELECT ''[tasks]'', 27
            WHERE
                @get_task_info = 2
            UNION ALL
            SELECT ''[status]'', 28
            UNION ALL
            SELECT ''[wait_info]'', 29
            WHERE
                @get_task_info > 0
                OR @find_block_leaders = 1
            UNION ALL
            SELECT ''[locks]'', 30
            WHERE
                @get_locks = 1
            UNION ALL
            SELECT ''[tran_start_time]'', 31
            WHERE
                @get_transaction_info = 1
            UNION ALL
            SELECT ''[tran_log_writes]'', 32
            WHERE
                @get_transaction_info = 1
            UNION ALL
            SELECT ''[implicit_tran]'', 33
            WHERE
                @get_transaction_info = 1
            UNION ALL
            SELECT ''[open_tran_count]'', 34
            UNION ALL
            SELECT ''[sql_command]'', 35
            WHERE
                @get_outer_command = 1
            UNION ALL
            SELECT ''[sql_text]'', 36
            UNION ALL
            SELECT ''[query_plan]'', 37
            WHERE
                @get_plans >= 1
            UNION ALL
            SELECT ''[blocking_session_id]'', 38
            WHERE
                @get_task_info > 0
                OR @find_block_leaders = 1
            UNION ALL
            SELECT ''[blocked_session_count]'', 39
            WHERE
                @find_block_leaders = 1
            UNION ALL
            SELECT ''[percent_complete]'', 40
            UNION ALL
            SELECT ''[host_name]'', 41
            UNION ALL
            SELECT ''[login_name]'', 42
            UNION ALL
            SELECT ''[database_name]'', 43
            UNION ALL
            SELECT ''[program_name]'', 44
            UNION ALL
            SELECT ''[additional_info]'', 45
            WHERE
                @get_additional_info = 1
            UNION ALL
            SELECT ''[memory_info]'', 46
            WHERE
                @get_memory_info = 1
            UNION ALL
            SELECT ''[start_time]'', 47
            UNION ALL
            SELECT ''[login_time]'', 48
            UNION ALL
            SELECT ''[request_id]'', 49
            UNION ALL
            SELECT ''[collection_time]'', 50
        ) AS x ON
            x.column_name LIKE token ESCAPE ''|''
    )
    SELECT
        @output_column_list =
            STUFF
            (
                (
                    SELECT
                        '','' + column_name as [text()]
                    FROM ordered_columns
                    WHERE
                        r = 1
                    ORDER BY
                        s
                    FOR XML
                        PATH('''')
                ),
                1,
                1,
                ''''
            );
   
    IF COALESCE(RTRIM(@output_column_list), '''') = ''''
    BEGIN;
        RAISERROR(''No valid column matches found in @output_column_list or no columns remain due to selected options.'', 16, 1);
        RETURN;
    END;
   
    IF @destination_table <> ''''
    BEGIN;
        SET @destination_table =
            --database
            COALESCE(QUOTENAME(PARSENAME(@destination_table, 3)) + ''.'', '''') +
            --schema
            COALESCE(QUOTENAME(PARSENAME(@destination_table, 2)) + ''.'', '''') +
            --table
            COALESCE(QUOTENAME(PARSENAME(@destination_table, 1)), '''');
           
        IF COALESCE(RTRIM(@destination_table), '''') = ''''
        BEGIN;
            RAISERROR(''Destination table not properly formatted.'', 16, 1);
            RETURN;
        END;
    END;

    WITH
    a0 AS
    (SELECT 1 AS n UNION ALL SELECT 1),
    a1 AS
    (SELECT 1 AS n FROM a0 AS a CROSS JOIN a0 AS b),
    a2 AS
    (SELECT 1 AS n FROM a1 AS a CROSS JOIN a1 AS b),
    a3 AS
    (SELECT 1 AS n FROM a2 AS a CROSS JOIN a2 AS b),
    a4 AS
    (SELECT 1 AS n FROM a3 AS a CROSS JOIN a3 AS b),
    numbers AS
    (
        SELECT TOP(LEN(@sort_order))
            ROW_NUMBER() OVER
            (
                ORDER BY (SELECT NULL)
            ) AS number
        FROM a4
        ORDER BY
            number
    ),
    tokens AS
    (
        SELECT
            ''|['' +
                SUBSTRING
                (
                    @sort_order,
                    number + 1,
                    CHARINDEX('']'', @sort_order, number) - number - 1
                ) + ''|]'' AS token,
            SUBSTRING
            (
                @sort_order,
                CHARINDEX('']'', @sort_order, number) + 1,
                COALESCE(NULLIF(CHARINDEX(''['', @sort_order, CHARINDEX('']'', @sort_order, number)), 0), LEN(@sort_order)) - CHARINDEX('']'', @sort_order, number)
            ) AS next_chunk,
            number
        FROM numbers
        WHERE
            SUBSTRING(@sort_order, number, 1) = ''[''
    ),
    ordered_columns AS
    (
        SELECT
            x.column_name +
                CASE
                    WHEN LOWER(tokens.next_chunk) LIKE ''%asc%'' THEN '' ASC''
                    WHEN LOWER(tokens.next_chunk) LIKE ''%desc%'' THEN '' DESC''
                    ELSE ''''
                END AS column_name,
            ROW_NUMBER() OVER
            (
                PARTITION BY
                    x.column_name
                ORDER BY
                    tokens.number
            ) AS r,
            tokens.number
        FROM tokens
        JOIN
        (
            SELECT ''[session_id]'' AS column_name
            UNION ALL
            SELECT ''[physical_io]''
            UNION ALL
            SELECT ''[reads]''
            UNION ALL
            SELECT ''[physical_reads]''
            UNION ALL
            SELECT ''[writes]''
            UNION ALL
            SELECT ''[tempdb_allocations]''
            UNION ALL
            SELECT ''[tempdb_current]''
            UNION ALL
            SELECT ''[CPU]''
            UNION ALL
            SELECT ''[context_switches]''
            UNION ALL
            SELECT ''[used_memory]''
            UNION ALL
            SELECT ''[max_used_memory]''
            UNION ALL
            SELECT ''[requested_memory]''
            UNION ALL
            SELECT ''[granted_memory]''
            UNION ALL
            SELECT ''[physical_io_delta]''
            UNION ALL
            SELECT ''[reads_delta]''
            UNION ALL
            SELECT ''[physical_reads_delta]''
            UNION ALL
            SELECT ''[writes_delta]''
            UNION ALL
            SELECT ''[tempdb_allocations_delta]''
            UNION ALL
            SELECT ''[tempdb_current_delta]''
            UNION ALL
            SELECT ''[CPU_delta]''
            UNION ALL
            SELECT ''[context_switches_delta]''
            UNION ALL
            SELECT ''[used_memory_delta]''
            UNION ALL
            SELECT ''[max_used_memory_delta]''
            UNION ALL
            SELECT ''[tasks]''
            UNION ALL
            SELECT ''[tran_start_time]''
            UNION ALL
            SELECT ''[open_tran_count]''
            UNION ALL
            SELECT ''[blocking_session_id]''
            UNION ALL
            SELECT ''[blocked_session_count]''
            UNION ALL
            SELECT ''[percent_complete]''
            UNION ALL
            SELECT ''[host_name]''
            UNION ALL
            SELECT ''[login_name]''
            UNION ALL
            SELECT ''[database_name]''
            UNION ALL
            SELECT ''[start_time]''
            UNION ALL
            SELECT ''[login_time]''
            UNION ALL
            SELECT ''[program_name]''
        ) AS x ON
            x.column_name LIKE token ESCAPE ''|''
    )
    SELECT
        @sort_order = COALESCE(z.sort_order, '''')
    FROM
    (
        SELECT
            STUFF
            (
                (
                    SELECT
                        '','' + column_name as [text()]
                    FROM ordered_columns
                    WHERE
                        r = 1
                    ORDER BY
                        number
                    FOR XML
                        PATH('''')
                ),
                1,
                1,
                ''''
            ) AS sort_order
    ) AS z;

    CREATE TABLE #sessions
    (
        recursion SMALLINT NOT NULL,
        session_id SMALLINT NOT NULL,
        request_id INT NOT NULL,
        session_number INT NOT NULL,
        elapsed_time INT NOT NULL,
        avg_elapsed_time INT NULL,
        physical_io BIGINT NULL,
        reads BIGINT NULL,
        physical_reads BIGINT NULL,
        writes BIGINT NULL,
        tempdb_allocations BIGINT NULL,
        tempdb_current BIGINT NULL,
        CPU BIGINT NULL,
        thread_CPU_snapshot BIGINT NULL,
        context_switches BIGINT NULL,
        used_memory BIGINT NOT NULL,
        max_used_memory BIGINT NULL,
        requested_memory BIGINT NULL,
        granted_memory BIGINT NULL,
        tasks SMALLINT NULL,
        status VARCHAR(30) NOT NULL,
        wait_info NVARCHAR(4000) NULL,
        locks XML NULL,
        transaction_id BIGINT NULL,
        tran_start_time DATETIME NULL,
        tran_log_writes NVARCHAR(4000) NULL,
        implicit_tran NVARCHAR(3) NULL,
        open_tran_count SMALLINT NULL,
        sql_command XML NULL,
        sql_handle VARBINARY(64) NULL,
        statement_start_offset INT NULL,
        statement_end_offset INT NULL,
        sql_text XML NULL,
        plan_handle VARBINARY(64) NULL,
        query_plan XML NULL,
        blocking_session_id SMALLINT NULL,
        blocked_session_count SMALLINT NULL,
        percent_complete REAL NULL,
        host_name sysname NULL,
        login_name sysname NOT NULL,
        database_name sysname NULL,
        program_name sysname NULL,
        additional_info XML NULL,
        memory_info XML NULL,
        start_time DATETIME NOT NULL,
        login_time DATETIME NULL,
        last_request_start_time DATETIME NULL,
        PRIMARY KEY CLUSTERED (session_id, request_id, recursion) WITH (IGNORE_DUP_KEY = ON),
        UNIQUE NONCLUSTERED (transaction_id, session_id, request_id, recursion) WITH (IGNORE_DUP_KEY = ON)
    );

    IF @return_schema = 0
    BEGIN;
        --Disable unnecessary autostats on the table
        CREATE STATISTICS s_session_id ON #sessions (session_id)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_request_id ON #sessions (request_id)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_transaction_id ON #sessions (transaction_id)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_session_number ON #sessions (session_number)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_status ON #sessions (status)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_start_time ON #sessions (start_time)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_last_request_start_time ON #sessions (last_request_start_time)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;
        CREATE STATISTICS s_recursion ON #sessions (recursion)
        WITH SAMPLE 0 ROWS, NORECOMPUTE;

        DECLARE @recursion SMALLINT;
        SET @recursion =
            CASE @delta_interval
                WHEN 0 THEN 1
                ELSE -1
            END;

        DECLARE @first_collection_ms_ticks BIGINT;
        DECLARE @last_collection_start DATETIME;
        DECLARE @sys_info BIT;
        SET @sys_info = ISNULL(CONVERT(BIT, SIGN(OBJECT_ID(''sys.dm_os_sys_info''))), 0);

        --Used for the delta pull
        REDO:;
       
        IF
            @get_locks = 1
            AND @recursion = 1
            AND @output_column_list LIKE ''%|[locks|]%'' ESCAPE ''|''
        BEGIN;
            SELECT
                y.resource_type,
                y.database_name,
                y.object_id,
                y.file_id,
                y.page_type,
                y.hobt_id,
                y.allocation_unit_id,
                y.index_id,
                y.schema_id,
                y.principal_id,
                y.request_mode,
                y.request_status,
                y.session_id,
                y.resource_description,
                y.request_count,
                s.request_id,
                s.start_time,
                CONVERT(sysname, NULL) AS object_name,
                CONVERT(sysname, NULL) AS index_name,
                CONVERT(sysname, NULL) AS schema_name,
                CONVERT(sysname, NULL) AS principal_name,
                CONVERT(NVARCHAR(2048), NULL) AS query_error
            INTO #locks
            FROM
            (
                SELECT
                    sp.spid AS session_id,
                    CASE sp.status
                        WHEN ''sleeping'' THEN CONVERT(INT, 0)
                        ELSE sp.request_id
                    END AS request_id,
                    CASE sp.status
                        WHEN ''sleeping'' THEN sp.last_batch
                        ELSE COALESCE(req.start_time, sp.last_batch)
                    END AS start_time,
                    sp.dbid
                FROM sys.sysprocesses AS sp
                OUTER APPLY
                (
                    SELECT TOP(1)
                        CASE
                            WHEN
                            (
                                sp.hostprocess > ''''
                                OR r.total_elapsed_time < 0
                            ) THEN
                                r.start_time
                            ELSE
                                DATEADD
                                (
                                    ms,
                                    1000 * (DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())) / 500) - DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())),
                                    DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())
                                )
                        END AS start_time
                    FROM sys.dm_exec_requests AS r
                    WHERE
                        r.session_id = sp.spid
                        AND r.request_id = sp.request_id
                ) AS req
                WHERE
                    --Process inclusive filter
                    1 =
                        CASE
                            WHEN @filter <> '''' THEN
                                CASE @filter_type
                                    WHEN ''session'' THEN
                                        CASE
                                            WHEN
                                                CONVERT(SMALLINT, @filter) = 0
                                                OR sp.spid = CONVERT(SMALLINT, @filter)
                                                    THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''program'' THEN
                                        CASE
                                            WHEN sp.program_name LIKE @filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''login'' THEN
                                        CASE
                                            WHEN sp.loginame LIKE @filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''host'' THEN
                                        CASE
                                            WHEN sp.hostname LIKE @filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''database'' THEN
                                        CASE
                                            WHEN DB_NAME(sp.dbid) LIKE @filter THEN 1
                                            ELSE 0
                                        END
                                    ELSE 0
                                END
                            ELSE 1
                        END
                    --Process exclusive filter
                    AND 0 =
                        CASE
                            WHEN @not_filter <> '''' THEN
                                CASE @not_filter_type
                                    WHEN ''session'' THEN
                                        CASE
                                            WHEN sp.spid = CONVERT(SMALLINT, @not_filter) THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''program'' THEN
                                        CASE
                                            WHEN sp.program_name LIKE @not_filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''login'' THEN
                                        CASE
                                            WHEN sp.loginame LIKE @not_filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''host'' THEN
                                        CASE
                                            WHEN sp.hostname LIKE @not_filter THEN 1
                                            ELSE 0
                                        END
                                    WHEN ''database'' THEN
                                        CASE
                                            WHEN DB_NAME(sp.dbid) LIKE @not_filter THEN 1
                                            ELSE 0
                                        END
                                    ELSE 0
                                END
                            ELSE 0
                        END
                    AND
                    (
                        @show_own_spid = 1
                        OR sp.spid <> @@SPID
                    )
                    AND
                    (
                        @show_system_spids = 1
                        OR sp.hostprocess > ''''
                    )
                    AND sp.ecid = 0
            ) AS s
            INNER HASH JOIN
            (
                SELECT
                    x.resource_type,
                    x.database_name,
                    x.object_id,
                    x.file_id,
                    CASE
                        WHEN x.page_no = 1 OR x.page_no % 8088 = 0 THEN ''PFS''
                        WHEN x.page_no = 2 OR x.page_no % 511232 = 0 THEN ''GAM''
                        WHEN x.page_no = 3 OR (x.page_no - 1) % 511232 = 0 THEN ''SGAM''
                        WHEN x.page_no = 6 OR (x.page_no - 6) % 511232 = 0 THEN ''DCM''
                        WHEN x.page_no = 7 OR (x.page_no - 7) % 511232 = 0 THEN ''BCM''
                        WHEN x.page_no IS NOT NULL THEN ''*''
                        ELSE NULL
                    END AS page_type,
                    x.hobt_id,
                    x.allocation_unit_id,
                    x.index_id,
                    x.schema_id,
                    x.principal_id,
                    x.request_mode,
                    x.request_status,
                    x.session_id,
                    x.request_id,
                    CASE
                        WHEN COALESCE(x.object_id, x.file_id, x.hobt_id, x.allocation_unit_id, x.index_id, x.schema_id, x.principal_id) IS NULL THEN NULLIF(resource_description, '''')
                        ELSE NULL
                    END AS resource_description,
                    COUNT(*) AS request_count
                FROM
                (
                    SELECT
                        tl.resource_type +
                            CASE
                                WHEN tl.resource_subtype = '''' THEN ''''
                                ELSE ''.'' + tl.resource_subtype
                            END AS resource_type,
                        COALESCE(DB_NAME(tl.resource_database_id), N''(null)'') AS database_name,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN tl.resource_type = ''OBJECT'' THEN tl.resource_associated_entity_id
                                WHEN tl.resource_description LIKE ''%object_id = %'' THEN
                                    (
                                        SUBSTRING
                                        (
                                            tl.resource_description,
                                            (CHARINDEX(''object_id = '', tl.resource_description) + 12),
                                            COALESCE
                                            (
                                                NULLIF
                                                (
                                                    CHARINDEX('','', tl.resource_description, CHARINDEX(''object_id = '', tl.resource_description) + 12),
                                                    0
                                                ),
                                                DATALENGTH(tl.resource_description)+1
                                            ) - (CHARINDEX(''object_id = '', tl.resource_description) + 12)
                                        )
                                    )
                                ELSE NULL
                            END
                        ) AS object_id,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN tl.resource_type = ''FILE'' THEN CONVERT(INT, tl.resource_description)
                                WHEN tl.resource_type IN (''PAGE'', ''EXTENT'', ''RID'') THEN LEFT(tl.resource_description, CHARINDEX('':'', tl.resource_description)-1)
                                ELSE NULL
                            END
                        ) AS file_id,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN tl.resource_type IN (''PAGE'', ''EXTENT'', ''RID'') THEN
                                    SUBSTRING
                                    (
                                        tl.resource_description,
                                        CHARINDEX('':'', tl.resource_description) + 1,
                                        COALESCE
                                        (
                                            NULLIF
                                            (
                                                CHARINDEX('':'', tl.resource_description, CHARINDEX('':'', tl.resource_description) + 1),
                                                0
                                            ),
                                            DATALENGTH(tl.resource_description)+1
                                        ) - (CHARINDEX('':'', tl.resource_description) + 1)
                                    )
                                ELSE NULL
                            END
                        ) AS page_no,
                        CASE
                            WHEN tl.resource_type IN (''PAGE'', ''KEY'', ''RID'', ''HOBT'') THEN tl.resource_associated_entity_id
                            ELSE NULL
                        END AS hobt_id,
                        CASE
                            WHEN tl.resource_type = ''ALLOCATION_UNIT'' THEN tl.resource_associated_entity_id
                            ELSE NULL
                        END AS allocation_unit_id,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN
                                    /*TODO: Deal with server principals*/
                                    tl.resource_subtype <> ''SERVER_PRINCIPAL''
                                    AND tl.resource_description LIKE ''%index_id or stats_id = %'' THEN
                                    (
                                        SUBSTRING
                                        (
                                            tl.resource_description,
                                            (CHARINDEX(''index_id or stats_id = '', tl.resource_description) + 23),
                                            COALESCE
                                            (
                                                NULLIF
                                                (
                                                    CHARINDEX('','', tl.resource_description, CHARINDEX(''index_id or stats_id = '', tl.resource_description) + 23),
                                                    0
                                                ),
                                                DATALENGTH(tl.resource_description)+1
                                            ) - (CHARINDEX(''index_id or stats_id = '', tl.resource_description) + 23)
                                        )
                                    )
                                ELSE NULL
                            END
                        ) AS index_id,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN tl.resource_description LIKE ''%schema_id = %'' THEN
                                    (
                                        SUBSTRING
                                        (
                                            tl.resource_description,
                                            (CHARINDEX(''schema_id = '', tl.resource_description) + 12),
                                            COALESCE
                                            (
                                                NULLIF
                                                (
                                                    CHARINDEX('','', tl.resource_description, CHARINDEX(''schema_id = '', tl.resource_description) + 12),
                                                    0
                                                ),
                                                DATALENGTH(tl.resource_description)+1
                                            ) - (CHARINDEX(''schema_id = '', tl.resource_description) + 12)
                                        )
                                    )
                                ELSE NULL
                            END
                        ) AS schema_id,
                        CONVERT
                        (
                            INT,
                            CASE
                                WHEN tl.resource_description LIKE ''%principal_id = %'' THEN
                                    (
                                        SUBSTRING
                                        (
                                            tl.resource_description,
                                            (CHARINDEX(''principal_id = '', tl.resource_description) + 15),
                                            COALESCE
                                            (
                                                NULLIF
                                                (
                                                    CHARINDEX('','', tl.resource_description, CHARINDEX(''principal_id = '', tl.resource_description) + 15),
                                                    0
                                                ),
                                                DATALENGTH(tl.resource_description)+1
                                            ) - (CHARINDEX(''principal_id = '', tl.resource_description) + 15)
                                        )
                                    )
                                ELSE NULL
                            END
                        ) AS principal_id,
                        tl.request_mode,
                        tl.request_status,
                        tl.request_session_id AS session_id,
                        tl.request_request_id AS request_id,

                        /*TODO: Applocks, other resource_descriptions*/
                        RTRIM(tl.resource_description) AS resource_description,
                        tl.resource_associated_entity_id
                        /*********************************************/
                    FROM
                    (
                        SELECT
                            request_session_id,
                            CONVERT(VARCHAR(120), resource_type) COLLATE Latin1_General_Bin2 AS resource_type,
                            CONVERT(VARCHAR(120), resource_subtype) COLLATE Latin1_General_Bin2 AS resource_subtype,
                            resource_database_id,
                            CONVERT(VARCHAR(512), resource_description) COLLATE Latin1_General_Bin2 AS resource_description,
                            resource_associated_entity_id,
                            CONVERT(VARCHAR(120), request_mode) COLLATE Latin1_General_Bin2 AS request_mode,
                            CONVERT(VARCHAR(120), request_status) COLLATE Latin1_General_Bin2 AS request_status,
                            request_request_id
                        FROM sys.dm_tran_locks
                    ) AS tl
                ) AS x
                GROUP BY
                    x.resource_type,
                    x.database_name,
                    x.object_id,
                    x.file_id,
                    CASE
                        WHEN x.page_no = 1 OR x.page_no % 8088 = 0 THEN ''PFS''
                        WHEN x.page_no = 2 OR x.page_no % 511232 = 0 THEN ''GAM''
                        WHEN x.page_no = 3 OR (x.page_no - 1) % 511232 = 0 THEN ''SGAM''
                        WHEN x.page_no = 6 OR (x.page_no - 6) % 511232 = 0 THEN ''DCM''
                        WHEN x.page_no = 7 OR (x.page_no - 7) % 511232 = 0 THEN ''BCM''
                        WHEN x.page_no IS NOT NULL THEN ''*''
                        ELSE NULL
                    END,
                    x.hobt_id,
                    x.allocation_unit_id,
                    x.index_id,
                    x.schema_id,
                    x.principal_id,
                    x.request_mode,
                    x.request_status,
                    x.session_id,
                    x.request_id,
                    CASE
                        WHEN COALESCE(x.object_id, x.file_id, x.hobt_id, x.allocation_unit_id, x.index_id, x.schema_id, x.principal_id) IS NULL THEN NULLIF(resource_description, '''')
                        ELSE NULL
                    END
            ) AS y ON
                y.session_id = s.session_id
                AND y.request_id = s.request_id
            OPTION (HASH GROUP);

            --Disable unnecessary autostats on the table
            CREATE STATISTICS s_database_name ON #locks (database_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_object_id ON #locks (object_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_hobt_id ON #locks (hobt_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_allocation_unit_id ON #locks (allocation_unit_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_index_id ON #locks (index_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_schema_id ON #locks (schema_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_principal_id ON #locks (principal_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_request_id ON #locks (request_id)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_start_time ON #locks (start_time)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_resource_type ON #locks (resource_type)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_object_name ON #locks (object_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_schema_name ON #locks (schema_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_page_type ON #locks (page_type)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_request_mode ON #locks (request_mode)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_request_status ON #locks (request_status)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_resource_description ON #locks (resource_description)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_index_name ON #locks (index_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_principal_name ON #locks (principal_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
        END;
       
        DECLARE
            @sql VARCHAR(MAX),
            @sql_n NVARCHAR(MAX),
            @core_session_join VARCHAR(MAX);

        SET @core_session_join =
                ''@sessions AS sp
                LEFT OUTER LOOP JOIN sys.dm_exec_sessions AS s ON
                    s.session_id = sp.session_id
                    AND s.login_time = sp.login_time
                LEFT OUTER LOOP JOIN sys.dm_exec_requests AS r ON
                    sp.status <> ''''sleeping''''
                    AND r.session_id = sp.session_id
                    AND r.request_id = sp.request_id
                    AND
                    (
                        (
                            s.is_user_process = 0
                            AND sp.is_user_process = 0
                        )
                        OR
                        (
                            r.start_time = s.last_request_start_time
                            AND s.last_request_end_time <= sp.last_request_end_time
                        )
                    ) '';

        SET @sql =
            CONVERT(VARCHAR(MAX), '''') +
            ''DECLARE @blocker BIT;
            SET @blocker = 0;
            DECLARE @i INT;
            SET @i = 2147483647;

            DECLARE @sessions TABLE
            (
                session_id SMALLINT NOT NULL,
                request_id INT NOT NULL,
                login_time DATETIME,
                last_request_end_time DATETIME,
                status VARCHAR(30),
                statement_start_offset INT,
                statement_end_offset INT,
                sql_handle BINARY(20),
                host_name NVARCHAR(128),
                login_name NVARCHAR(128),
                program_name NVARCHAR(128),
                database_id SMALLINT,
                memory_usage INT,
                open_tran_count SMALLINT,
                '' +
                CASE
                    WHEN
                    (
                        @get_task_info <> 0
                        OR @find_block_leaders = 1
                    ) THEN
                        ''wait_type NVARCHAR(32),
                        wait_resource NVARCHAR(256),
                        wait_time BIGINT,
                        ''
                    ELSE
                        ''''
                END +
                ''blocked SMALLINT,
                is_user_process BIT,
                cmd VARCHAR(32),
                PRIMARY KEY CLUSTERED (session_id, request_id) WITH (IGNORE_DUP_KEY = ON)
            );

            DECLARE @blockers TABLE
            (
                session_id INT NOT NULL PRIMARY KEY WITH (IGNORE_DUP_KEY = ON)
            );

            BLOCKERS:;

            INSERT @sessions
            (
                session_id,
                request_id,
                login_time,
                last_request_end_time,
                status,
                statement_start_offset,
                statement_end_offset,
                sql_handle,
                host_name,
                login_name,
                program_name,
                database_id,
                memory_usage,
                open_tran_count,
                '' +
                CASE
                    WHEN
                    (
                        @get_task_info <> 0
                        OR @find_block_leaders = 1
                    ) THEN
                        ''wait_type,
                        wait_resource,
                        wait_time,
                        ''
                    ELSE
                        ''''
                END +
                ''blocked,
                is_user_process,
                cmd
            )
            SELECT TOP(@i)
                spy.session_id,
                spy.request_id,
                spy.login_time,
                spy.last_request_end_time,
                spy.status,
                spy.statement_start_offset,
                spy.statement_end_offset,
                spy.sql_handle,
                spy.host_name,
                spy.login_name,
                spy.program_name,
                spy.database_id,
                spy.memory_usage,
                spy.open_tran_count,
                '' +
                CASE
                    WHEN
                    (
                        @get_task_info <> 0
                        OR @find_block_leaders = 1
                    ) THEN
                        ''spy.wait_type,
                        CASE
                            WHEN
                                spy.wait_type LIKE N''''PAGE%LATCH_%''''
                                OR spy.wait_type IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''')
                                OR spy.wait_type LIKE N''''LATCH[_]%''''
                                OR spy.wait_type = N''''OLEDB'''' THEN
                                    spy.wait_resource
                            ELSE
                                NULL
                        END AS wait_resource,
                        spy.wait_time,
                        ''
                    ELSE
                        ''''
                END +
                ''spy.blocked,
                spy.is_user_process,
                spy.cmd
            FROM
            (
                SELECT TOP(@i)
                    spx.*,
                    '' +
                    CASE
                        WHEN
                        (
                            @get_task_info <> 0
                            OR @find_block_leaders = 1
                        ) THEN
                            ''ROW_NUMBER() OVER
                            (
                                PARTITION BY
                                    spx.session_id,
                                    spx.request_id
                                ORDER BY
                                    CASE
                                        WHEN spx.wait_type LIKE N''''LCK[_]%'''' THEN
                                            1
                                        ELSE
                                            99
                                    END,
                                    spx.wait_time DESC,
                                    spx.blocked DESC
                            ) AS r
                            ''
                        ELSE
                            ''1 AS r
                            ''
                    END +
                ''FROM
                (
                    SELECT TOP(@i)
                        sp0.session_id,
                        sp0.request_id,
                        sp0.login_time,
                        sp0.last_request_end_time,
                        LOWER(sp0.status) AS status,
                        CASE
                            WHEN sp0.cmd = ''''CREATE INDEX'''' THEN
                                0
                            ELSE
                                sp0.stmt_start
                        END AS statement_start_offset,
                        CASE
                            WHEN sp0.cmd = N''''CREATE INDEX'''' THEN
                                -1
                            ELSE
                                COALESCE(NULLIF(sp0.stmt_end, 0), -1)
                        END AS statement_end_offset,
                        sp0.sql_handle,
                        sp0.host_name,
                        sp0.login_name,
                        sp0.program_name,
                        sp0.database_id,
                        sp0.memory_usage,
                        sp0.open_tran_count,
                        '' +
                        CASE
                            WHEN
                            (
                                @get_task_info <> 0
                                OR @find_block_leaders = 1
                            ) THEN
                                ''CASE
                                    WHEN sp0.wait_time > 0 AND sp0.wait_type NOT IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''') THEN
                                        sp0.wait_type
                                    ELSE
                                        NULL
                                END AS wait_type,
                                CASE
                                    WHEN sp0.wait_time > 0 AND sp0.wait_type NOT IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''') THEN
                                        sp0.wait_resource
                                    ELSE
                                        NULL
                                END AS wait_resource,
                                CASE
                                    WHEN sp0.wait_type NOT IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''') THEN
                                        sp0.wait_time
                                    ELSE
                                        0
                                END AS wait_time,
                                ''
                            ELSE
                                ''''
                        END +
                        ''sp0.blocked,
                        sp0.is_user_process,
                        sp0.cmd
                    FROM
                    (
                        SELECT TOP(@i)
                            sp1.session_id,
                            sp1.request_id,
                            sp1.login_time,
                            sp1.last_request_end_time,
                            sp1.status,
                            sp1.cmd,
                            sp1.stmt_start,
                            sp1.stmt_end,
                            MAX(NULLIF(sp1.sql_handle, 0x00)) OVER (PARTITION BY sp1.session_id, sp1.request_id) AS sql_handle,
                            sp1.host_name,
                            MAX(sp1.login_name) OVER (PARTITION BY sp1.session_id, sp1.request_id) AS login_name,
                            sp1.program_name,
                            sp1.database_id,
                            MAX(sp1.memory_usage)  OVER (PARTITION BY sp1.session_id, sp1.request_id) AS memory_usage,
                            MAX(sp1.open_tran_count)  OVER (PARTITION BY sp1.session_id, sp1.request_id) AS open_tran_count,
                            sp1.wait_type,
                            sp1.wait_resource,
                            sp1.wait_time,
                            sp1.blocked,
                            sp1.hostprocess,
                            sp1.is_user_process
                        FROM
                        (
                            SELECT TOP(@i)
                                sp2.spid AS session_id,
                                v2.request_id,
                                MAX(sp2.login_time) AS login_time,
                                MAX(sp2.last_batch) AS last_request_end_time,
                                MAX(CONVERT(VARCHAR(30), RTRIM(sp2.status)) COLLATE Latin1_General_Bin2) AS status,
                                MAX(CONVERT(VARCHAR(32), RTRIM(sp2.cmd)) COLLATE Latin1_General_Bin2) AS cmd,
                                MAX(sp2.stmt_start) AS stmt_start,
                                MAX(sp2.stmt_end) AS stmt_end,
                                MAX(sp2.sql_handle) AS sql_handle,
                                MAX(CONVERT(sysname, RTRIM(sp2.hostname)) COLLATE SQL_Latin1_General_CP1_CI_AS) AS host_name,
                                MAX(CONVERT(sysname, RTRIM(sp2.loginame)) COLLATE SQL_Latin1_General_CP1_CI_AS) AS login_name,
                                MAX
                                (
                                    CASE
                                        WHEN blk.queue_id IS NOT NULL THEN
                                            N''''Service Broker
                                                database_id: '''' + CONVERT(NVARCHAR, blk.database_id) +
                                                N'''' queue_id: '''' + CONVERT(NVARCHAR, blk.queue_id)
                                        ELSE
                                            CONVERT
                                            (
                                                sysname,
                                                RTRIM(sp2.program_name)
                                            )
                                    END COLLATE SQL_Latin1_General_CP1_CI_AS
                                ) AS program_name,
                                MAX(sp2.dbid) AS database_id,
                                MAX(sp2.memusage) AS memory_usage,
                                MAX(sp2.open_tran) AS open_tran_count,
                                RTRIM(sp2.lastwaittype) AS wait_type,
                                v2.wait_resource,
                                MAX(sp2.waittime) AS wait_time,
                                COALESCE(NULLIF(sp2.blocked, sp2.spid), 0) AS blocked,
                                MAX
                                (
                                    CASE
                                        WHEN blk.session_id = sp2.spid THEN
                                            ''''blocker''''
                                        ELSE
                                            RTRIM(sp2.hostprocess)
                                    END
                                ) AS hostprocess,
                                CONVERT
                                (
                                    BIT,
                                    MAX
                                    (
                                        CASE
                                            WHEN sp2.hostprocess > '''''''' THEN
                                                1
                                            ELSE
                                                0
                                        END
                                    )
                                ) AS is_user_process
                            FROM
                            (
                                SELECT TOP(@i)
                                    session_id,
                                    CONVERT(INT, NULL) AS queue_id,
                                    CONVERT(INT, NULL) AS database_id
                                FROM @blockers

                                UNION ALL

                                SELECT TOP(@i)
                                    CONVERT(SMALLINT, 0),
                                    CONVERT(INT, NULL) AS queue_id,
                                    CONVERT(INT, NULL) AS database_id
                                WHERE
                                    @blocker = 0

                                UNION ALL

                                SELECT TOP(@i)
                                    CONVERT(SMALLINT, spid),
                                    queue_id,
                                    database_id
                                FROM sys.dm_broker_activated_tasks
                                WHERE
                                    @blocker = 0
                            ) AS blk
                            INNER JOIN sys.sysprocesses AS sp2 ON
                                sp2.spid = blk.session_id
                                OR
                                (
                                    blk.session_id = 0
                                    AND @blocker = 0
                                )
                            CROSS APPLY
                            (
                                SELECT
                                    CASE sp2.status
                                        WHEN ''''sleeping'''' THEN
                                            CONVERT(INT, 0)
                                        ELSE
                                            sp2.request_id
                                    END AS request_id,
                                    RTRIM
                                    (
                                        LEFT
                                        (
                                            sp2.waitresource COLLATE Latin1_General_Bin2,
                                            ISNULL(NULLIF(CHARINDEX('''' (LATCH '''', sp2.waitresource COLLATE Latin1_General_Bin2) - 1, -1), 256)
                                        )
                                    ) AS wait_resource
                            ) AS v2
                            '' +
                            CASE
                                WHEN
                                (
                                    @get_task_info = 0
                                    AND @find_block_leaders = 0
                                ) THEN
                                    ''WHERE
                                        sp2.ecid = 0
                                    ''
                                ELSE
                                    ''''
                            END +
                            ''GROUP BY
                                sp2.spid,
                                v2.request_id,
                                RTRIM(sp2.lastwaittype),
                                v2.wait_resource,
                                COALESCE(NULLIF(sp2.blocked, sp2.spid), 0)
                        ) AS sp1
                    ) AS sp0
                    WHERE
                        @blocker = 1
                        OR
                        (1=1
                        '' +
                            --inclusive filter
                            CASE
                                WHEN @filter <> '''' THEN
                                    CASE @filter_type
                                        WHEN ''session'' THEN
                                            CASE
                                                WHEN CONVERT(SMALLINT, @filter) <> 0 THEN
                                                    ''AND sp0.session_id = CONVERT(SMALLINT, @filter)
                                                    ''
                                                ELSE
                                                    ''''
                                            END
                                        WHEN ''program'' THEN
                                            ''AND sp0.program_name LIKE @filter
                                            ''
                                        WHEN ''login'' THEN
                                            ''AND sp0.login_name LIKE @filter
                                            ''
                                        WHEN ''host'' THEN
                                            ''AND sp0.host_name LIKE @filter
                                            ''
                                        WHEN ''database'' THEN
                                            ''AND DB_NAME(sp0.database_id) LIKE @filter
                                            ''
                                        ELSE
                                            ''''
                                    END
                                ELSE
                                    ''''
                            END +
                            --exclusive filter
                            CASE
                                WHEN @not_filter <> '''' THEN
                                    CASE @not_filter_type
                                        WHEN ''session'' THEN
                                            CASE
                                                WHEN CONVERT(SMALLINT, @not_filter) <> 0 THEN
                                                    ''AND sp0.session_id <> CONVERT(SMALLINT, @not_filter)
                                                    ''
                                                ELSE
                                                    ''''
                                            END
                                        WHEN ''program'' THEN
                                            ''AND sp0.program_name NOT LIKE @not_filter
                                            ''
                                        WHEN ''login'' THEN
                                            ''AND sp0.login_name NOT LIKE @not_filter
                                            ''
                                        WHEN ''host'' THEN
                                            ''AND sp0.host_name NOT LIKE @not_filter
                                            ''
                                        WHEN ''database'' THEN
                                            ''AND DB_NAME(sp0.database_id) NOT LIKE @not_filter
                                            ''
                                        ELSE
                                            ''''
                                    END
                                ELSE
                                    ''''
                            END +
                            CASE @show_own_spid
                                WHEN 1 THEN
                                    ''''
                                ELSE
                                    ''AND sp0.session_id <> @@spid
                                    ''
                            END +
                            CASE
                                WHEN @show_system_spids = 0 THEN
                                    ''AND sp0.hostprocess > ''''''''
                                    ''
                                ELSE
                                    ''''
                            END +
                            CASE @show_sleeping_spids
                                WHEN 0 THEN
                                    ''AND sp0.status <> ''''sleeping''''
                                    ''
                                WHEN 1 THEN
                                    ''AND
                                    (
                                        sp0.status <> ''''sleeping''''
                                        OR sp0.open_tran_count > 0
                                    )
                                    ''
                                ELSE
                                    ''''
                            END +
                        '')
                ) AS spx
            ) AS spy
            WHERE
                spy.r = 1;
            '' +
            CASE @recursion
                WHEN 1 THEN
                    ''IF @@ROWCOUNT > 0
                    BEGIN;
                        INSERT @blockers
                        (
                            session_id
                        )
                        SELECT TOP(@i)
                            blocked
                        FROM @sessions
                        WHERE
                            NULLIF(blocked, 0) IS NOT NULL

                        EXCEPT

                        SELECT TOP(@i)
                            session_id
                        FROM @sessions;
                        '' +

                        CASE
                            WHEN
                            (
                                @get_task_info > 0
                                OR @find_block_leaders = 1
                            ) THEN
                                ''IF @@ROWCOUNT > 0
                                BEGIN;
                                    SET @blocker = 1;
                                    GOTO BLOCKERS;
                                END;
                                ''
                            ELSE
                                ''''
                        END +
                    ''END;
                    ''
                ELSE
                    ''''
            END +
            ''SELECT TOP(@i)
                @recursion AS recursion,
                x.session_id,
                x.request_id,
                DENSE_RANK() OVER
                (
                    ORDER BY
                        x.session_id
                ) AS session_number,
                '' +
                CASE
                    WHEN @output_column_list LIKE ''%|[dd hh:mm:ss.mss|]%'' ESCAPE ''|'' THEN
                        ''x.elapsed_time ''
                    ELSE
                        ''0 ''
                END +
                    ''AS elapsed_time,
                    '' +
                CASE
                    WHEN
                        (
                            @output_column_list LIKE ''%|[dd hh:mm:ss.mss (avg)|]%'' ESCAPE ''|'' OR
                            @output_column_list LIKE ''%|[avg_elapsed_time|]%'' ESCAPE ''|''
                        )
                        AND @recursion = 1
                            THEN
                                ''x.avg_elapsed_time / 1000 ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS avg_elapsed_time,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[physical_io|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[physical_io_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.physical_io ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS physical_io,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[reads|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[reads_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.reads ''
                    ELSE
                        ''0 ''
                END +
                    ''AS reads,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[physical_reads|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[physical_reads_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.physical_reads ''
                    ELSE
                        ''0 ''
                END +
                    ''AS physical_reads,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[writes|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[writes_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.writes ''
                    ELSE
                        ''0 ''
                END +
                    ''AS writes,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[tempdb_allocations|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[tempdb_allocations_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.tempdb_allocations ''
                    ELSE
                        ''0 ''
                END +
                    ''AS tempdb_allocations,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[tempdb_current|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[tempdb_current_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.tempdb_current ''
                    ELSE
                        ''0 ''
                END +
                    ''AS tempdb_current,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[CPU|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[CPU_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.CPU ''
                    ELSE
                        ''0 ''
                END +
                    ''AS CPU,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[CPU_delta|]%'' ESCAPE ''|''
                        AND @get_task_info = 2
                        AND @sys_info = 1
                            THEN
                                ''x.thread_CPU_snapshot ''
                    ELSE
                        ''0 ''
                END +
                    ''AS thread_CPU_snapshot,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[context_switches|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[context_switches_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.context_switches ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS context_switches,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[used_memory|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[used_memory_delta|]%'' ESCAPE ''|''
                            THEN
                                CASE
                                    WHEN @get_memory_info = 1 THEN
                                        ''COALESCE(x.mg_used_memory_kb / 8, x.used_memory) ''
                                    ELSE
                                        ''x.used_memory ''
                                END
                    ELSE
                        ''0 ''
                END +
                    ''AS used_memory,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[max_used_memory|]%'' ESCAPE ''|''
                        OR @output_column_list LIKE ''%|[max_used_memory_delta|]%'' ESCAPE ''|''
                            THEN
                                ''x.max_used_memory_kb / 8 ''
                    ELSE
                        ''0 ''
                END +
                    ''AS max_used_memory,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[requested_memory|]%'' ESCAPE ''|''
                            THEN
                                ''x.requested_memory_kb / 8 ''
                    ELSE
                        ''0 ''
                END +
                    ''AS requested_memory,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[granted_memory|]%'' ESCAPE ''|''
                            THEN
                                ''x.mg_granted_memory_kb / 8 ''
                    ELSE
                        ''0 ''
                END +
                    ''AS granted_memory,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[tasks|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.tasks ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS tasks,
                    '' +
                CASE
                    WHEN
                        (
                            @output_column_list LIKE ''%|[status|]%'' ESCAPE ''|''
                            OR @output_column_list LIKE ''%|[sql_command|]%'' ESCAPE ''|''
                        )
                        AND @recursion = 1
                            THEN
                                ''x.status ''
                    ELSE
                        '''''''''' ''
                END +
                    ''AS status,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[wait_info|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                CASE @get_task_info
                                    WHEN 2 THEN
                                        ''COALESCE(x.task_wait_info, x.sys_wait_info) ''
                                    ELSE
                                        ''x.sys_wait_info ''
                                END
                    ELSE
                        ''NULL ''
                END +
                    ''AS wait_info,
                    '' +
                CASE
                    WHEN
                        (
                            @output_column_list LIKE ''%|[tran_start_time|]%'' ESCAPE ''|''
                            OR @output_column_list LIKE ''%|[tran_log_writes|]%'' ESCAPE ''|''
                        )
                        AND @recursion = 1
                            THEN
                                ''x.transaction_id ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS transaction_id,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[open_tran_count|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.open_tran_count ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS open_tran_count,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[sql_text|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.sql_handle ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS sql_handle,
                    '' +
                CASE
                    WHEN
                        (
                            @output_column_list LIKE ''%|[sql_text|]%'' ESCAPE ''|''
                            OR @output_column_list LIKE ''%|[query_plan|]%'' ESCAPE ''|''
                        )
                        AND @recursion = 1
                            THEN
                                ''x.statement_start_offset ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS statement_start_offset,
                    '' +
                CASE
                    WHEN
                        (
                            @output_column_list LIKE ''%|[sql_text|]%'' ESCAPE ''|''
                            OR @output_column_list LIKE ''%|[query_plan|]%'' ESCAPE ''|''
                        )
                        AND @recursion = 1
                            THEN
                                ''x.statement_end_offset ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS statement_end_offset,
                    '' +
                ''NULL AS sql_text,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[query_plan|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.plan_handle ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS plan_handle,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[blocking_session_id|]%'' ESCAPE ''|'' OR @find_block_leaders = 1
                        AND @recursion = 1
                            THEN
                                ''NULLIF(x.blocking_session_id, 0) ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS blocking_session_id,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[percent_complete|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.percent_complete ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS percent_complete,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[host_name|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.host_name ''
                    ELSE
                        '''''''''' ''
                END +
                    ''AS host_name,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[login_name|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.login_name ''
                    ELSE
                        '''''''''' ''
                END +
                    ''AS login_name,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[database_name|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''DB_NAME(x.database_id) ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS database_name,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[program_name|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.program_name ''
                    ELSE
                        '''''''''' ''
                END +
                    ''AS program_name,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[additional_info|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''(
                                    SELECT TOP(@i)
                                        x.text_size,
                                        x.language,
                                        x.date_format,
                                        x.date_first,
                                        CASE x.quoted_identifier
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS quoted_identifier,
                                        CASE x.arithabort
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS arithabort,
                                        CASE x.ansi_null_dflt_on
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS ansi_null_dflt_on,
                                        CASE x.ansi_defaults
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS ansi_defaults,
                                        CASE x.ansi_warnings
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS ansi_warnings,
                                        CASE x.ansi_padding
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS ansi_padding,
                                        CASE ansi_nulls
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS ansi_nulls,
                                        CASE x.concat_null_yields_null
                                            WHEN 0 THEN ''''OFF''''
                                            WHEN 1 THEN ''''ON''''
                                        END AS concat_null_yields_null,
                                        CASE x.transaction_isolation_level
                                            WHEN 0 THEN ''''Unspecified''''
                                            WHEN 1 THEN ''''ReadUncomitted''''
                                            WHEN 2 THEN ''''ReadCommitted''''
                                            WHEN 3 THEN ''''Repeatable''''
                                            WHEN 4 THEN ''''Serializable''''
                                            WHEN 5 THEN ''''Snapshot''''
                                        END AS transaction_isolation_level,
                                        x.lock_timeout,
                                        x.deadlock_priority,
                                        x.row_count,
                                        x.command_type,
                                        '' +
                                        CASE
                                            WHEN OBJECT_ID(''master.dbo.fn_varbintohexstr'') IS NOT NULL THEN
                                                ''master.dbo.fn_varbintohexstr(x.sql_handle) AS sql_handle,
                                                master.dbo.fn_varbintohexstr(x.plan_handle) AS plan_handle,''
                                            ELSE
                                                ''CONVERT(VARCHAR(256), x.sql_handle, 1) AS sql_handle,
                                                CONVERT(VARCHAR(256), x.plan_handle, 1) AS plan_handle,''
                                        END +
                                        ''
                                        x.statement_start_offset,
                                        x.statement_end_offset,
                                        '' +
                                        CASE
                                            WHEN @output_column_list LIKE ''%|[program_name|]%'' ESCAPE ''|'' THEN
                                                ''(
                                                    SELECT TOP(1)
                                                        CONVERT(uniqueidentifier, CONVERT(XML, '''''''').value(''''xs:hexBinary( substring(sql:column("agent_info.job_id_string"), 0) )'''', ''''binary(16)'''')) AS job_id,
                                                        agent_info.step_id,
                                                        (
                                                            SELECT TOP(1)
                                                                NULL
                                                            FOR XML
                                                                PATH(''''job_name''''),
                                                                TYPE
                                                        ),
                                                        (
                                                            SELECT TOP(1)
                                                                NULL
                                                            FOR XML
                                                                PATH(''''step_name''''),
                                                                TYPE
                                                        )
                                                    FROM
                                                    (
                                                        SELECT TOP(1)
                                                            SUBSTRING(x.program_name, CHARINDEX(''''0x'''', x.program_name) + 2, 32) AS job_id_string,
                                                            SUBSTRING(x.program_name, CHARINDEX('''': Step '''', x.program_name) + 7, CHARINDEX('''')'''', x.program_name, CHARINDEX('''': Step '''', x.program_name)) - (CHARINDEX('''': Step '''', x.program_name) + 7)) AS step_id
                                                        WHERE
                                                            x.program_name LIKE N''''SQLAgent - TSQL JobStep (Job 0x%''''
                                                    ) AS agent_info
                                                    FOR XML
                                                        PATH(''''agent_job_info''''),
                                                        TYPE
                                                ),
                                                ''
                                            ELSE ''''
                                        END +
                                        CASE
                                            WHEN @get_task_info = 2 THEN
                                                ''CONVERT(XML, x.block_info) AS block_info,
                                                ''
                                            ELSE
                                                ''''
                                        END + ''
                                        x.host_process_id,
                                        x.group_id,
                                        x.original_login_name,
                                        '' +
                                        CASE
                                            WHEN OBJECT_ID(''master.dbo.fn_varbintohexstr'') IS NOT NULL THEN
                                                ''master.dbo.fn_varbintohexstr(x.context_info) AS context_info''
                                            ELSE
                                                ''CONVERT(VARCHAR(256), x.context_info, 1) AS context_info''
                                        END + ''
                                    FOR XML
                                        PATH(''''additional_info''''),
                                        TYPE
                                ) ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS additional_info,
                    '' +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[memory_info|]%'' ESCAPE ''|''
                        AND @get_memory_info = 1 THEN''
                        (
                            SELECT TOP(@i)
                            (
                                SELECT TOP(@i)   
                                    x.request_time,
                                    x.grant_time,
                                    x.wait_time_ms,
                                    x.requested_memory_kb,   
                                    x.mg_granted_memory_kb AS granted_memory_kb,
                                    x.mg_used_memory_kb AS used_memory_kb,
                                    x.max_used_memory_kb,
                                    x.ideal_memory_kb,   
                                    x.required_memory_kb,
                                    x.queue_id,
                                    x.wait_order,
                                    x.is_next_candidate,
                                    x.dop,
                                    CAST(x.query_cost AS NUMERIC(38, 4)) AS query_cost
                                FOR XML
                                    PATH(''''memory_grant''''),
                                    TYPE
                            ),
                            (
                                SELECT TOP(@i)
                                    x.timeout_error_count,
                                    x.target_memory_kb,
                                    x.max_target_memory_kb,
                                    x.total_memory_kb,
                                    x.available_memory_kb,
                                    x.rs_granted_memory_kb AS granted_memory_kb,
                                    x.rs_used_memory_kb AS used_memory_kb,
                                    x.grantee_count,
                                    x.waiter_count
                                FOR XML
                                    PATH(''''resource_semaphore''''),
                                    TYPE
                            ),
                            (
                                SELECT TOP(@i)   
                                    x.wg_name AS name,
                                    x.request_max_memory_grant_percent,
                                    x.request_max_cpu_time_sec,
                                    x.request_memory_grant_timeout_sec,
                                    x.max_dop
                                FOR XML
                                    PATH(''''workload_group''''),
                                    TYPE
                            ),
                            (
                                SELECT TOP(@i)   
                                    x.rp_name AS name,
                                    x.min_memory_percent,
                                    x.max_memory_percent,
                                    x.min_cpu_percent,
                                    x.max_cpu_percent
                                FOR XML
                                    PATH(''''resource_pool''''),
                                    TYPE
                            )
                            WHERE
                                x.request_time IS NOT NULL
                            FOR XML
                                PATH(''''memory_info''''),
                                TYPE
                        )               
                    ''
                    ELSE
                        ''NULL ''
                END + ''AS memory_info,
                x.start_time,
                ''
                +
                CASE
                    WHEN
                        @output_column_list LIKE ''%|[login_time|]%'' ESCAPE ''|''
                        AND @recursion = 1
                            THEN
                                ''x.login_time ''
                    ELSE
                        ''NULL ''
                END +
                    ''AS login_time,
                x.last_request_start_time
            FROM
            (
                SELECT TOP(@i)
                    y.*,
                    CASE
                        WHEN DATEDIFF(hour, y.start_time, GETDATE()) > 576 THEN
                            DATEDIFF(second, GETDATE(), y.start_time)
                        ELSE DATEDIFF(ms, y.start_time, GETDATE())
                    END AS elapsed_time,
                    COALESCE(tempdb_info.tempdb_allocations, 0) AS tempdb_allocations,
                    COALESCE
                    (
                        CASE
                            WHEN tempdb_info.tempdb_current < 0 THEN 0
                            ELSE tempdb_info.tempdb_current
                        END,
                        0
                    ) AS tempdb_current,
                    '' +
                    CASE
                        WHEN
                            (
                                @get_task_info <> 0
                                OR @find_block_leaders = 1
                            ) THEN
                                ''N''''('''' + CONVERT(NVARCHAR, y.wait_duration_ms) + N''''ms)'''' +
                                    y.wait_type +
                                        CASE
                                            WHEN y.wait_type LIKE N''''PAGE%LATCH_%'''' THEN
                                                N'''':'''' +
                                                COALESCE(DB_NAME(CONVERT(INT, LEFT(y.resource_description, CHARINDEX(N'''':'''', y.resource_description) - 1))), N''''(null)'''') +
                                                N'''':'''' +
                                                SUBSTRING(y.resource_description, CHARINDEX(N'''':'''', y.resource_description) + 1, LEN(y.resource_description) - CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - CHARINDEX(N'''':'''', y.resource_description)) +
                                                N''''('''' +
                                                    CASE
                                                        WHEN
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) = 1 OR
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) % 8088 = 0
                                                                THEN
                                                                    N''''PFS''''
                                                        WHEN
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) = 2 OR
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) % 511232 = 0
                                                                THEN
                                                                    N''''GAM''''
                                                        WHEN
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) = 3 OR
                                                            (CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) - 1) % 511232 = 0
                                                                THEN
                                                                    N''''SGAM''''
                                                        WHEN
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) = 6 OR
                                                            (CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) - 6) % 511232 = 0
                                                                THEN
                                                                    N''''DCM''''
                                                        WHEN
                                                            CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) = 7 OR
                                                            (CONVERT(INT, RIGHT(y.resource_description, CHARINDEX(N'''':'''', REVERSE(y.resource_description)) - 1)) - 7) % 511232 = 0
                                                                THEN
                                                                    N''''BCM''''
                                                        ELSE
                                                            N''''*''''
                                                    END +
                                                N'''')''''
                                            WHEN y.wait_type IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''') THEN
                                                N'''':'''' +
                                                    SUBSTRING
                                                    (
                                                        y.resource_description,
                                                        CHARINDEX(N''''nodeId'''', y.resource_description) + 7,
                                                        CASE
                                                            WHEN CHARINDEX(N'''' '''', y.resource_description, CHARINDEX(N''''nodeId'''', y.resource_description)) > 0
                                                            THEN CHARINDEX(N'''' '''', y.resource_description, CHARINDEX(N''''nodeId'''', y.resource_description) + 7) - 7 - CHARINDEX(N''''nodeId'''', y.resource_description)
                                                            ELSE 4
                                                        END
                                                    )
                                            WHEN y.wait_type LIKE N''''LATCH[_]%'''' THEN
                                                N'''' ['''' + LEFT(y.resource_description, COALESCE(NULLIF(CHARINDEX(N'''' '''', y.resource_description), 0), LEN(y.resource_description) + 1) - 1) + N'''']''''
                                            WHEN
                                                y.wait_type = N''''OLEDB''''
                                                AND y.resource_description LIKE N''''%(SPID=%)'''' THEN
                                                    N''''['''' + LEFT(y.resource_description, CHARINDEX(N''''(SPID='''', y.resource_description) - 2) +
                                                        N'''':'''' + SUBSTRING(y.resource_description, CHARINDEX(N''''(SPID='''', y.resource_description) + 6, CHARINDEX(N'''')'''', y.resource_description, (CHARINDEX(N''''(SPID='''', y.resource_description) + 6)) - (CHARINDEX(N''''(SPID='''', y.resource_description) + 6)) + '''']''''
                                            ELSE
                                                N''''''''
                                        END COLLATE Latin1_General_Bin2 AS sys_wait_info,
                                        ''
                            ELSE
                                ''''
                        END +
                        CASE
                            WHEN @get_task_info = 2 THEN
                                ''tasks.physical_io,
                                tasks.context_switches,
                                tasks.tasks,
                                tasks.block_info,
                                tasks.wait_info AS task_wait_info,
                                tasks.thread_CPU_snapshot,
                                ''
                            ELSE
                                ''''
                    END +
                    CASE
                        WHEN NOT (@get_avg_time = 1 AND @recursion = 1) THEN
                            ''CONVERT(INT, NULL) ''
                        ELSE
                            ''qs.total_elapsed_time / qs.execution_count ''
                    END +
                        ''AS avg_elapsed_time
                FROM
                (
                    SELECT TOP(@i)
                        sp.session_id,
                        sp.request_id,
                        COALESCE(r.logical_reads, s.logical_reads) AS reads,
                        COALESCE(r.reads, s.reads) AS physical_reads,
                        COALESCE(r.writes, s.writes) AS writes,
                        COALESCE(r.CPU_time, s.CPU_time) AS CPU,
                        '' +
                        CASE
                            WHEN @get_memory_info = 1 THEN
                                ''sp.memory_usage AS used_memory,
                                mg.used_memory_kb AS mg_used_memory_kb,
                                mg.max_used_memory_kb,
                                mg.request_time,
                                mg.grant_time,
                                mg.wait_time_ms,
                                mg.requested_memory_kb,
                                mg.granted_memory_kb AS mg_granted_memory_kb,
                                mg.required_memory_kb,
                                mg.ideal_memory_kb,
                                mg.dop AS dop,
                                mg.query_cost AS query_cost,
                                mg.queue_id AS queue_id,
                                mg.wait_order AS wait_order,
                                mg.is_next_candidate,
                                rs.target_memory_kb,
                                rs.max_target_memory_kb,
                                rs.total_memory_kb,
                                rs.available_memory_kb,
                                rs.granted_memory_kb AS rs_granted_memory_kb,
                                rs.used_memory_kb AS rs_used_memory_kb,
                                rs.grantee_count,
                                rs.waiter_count,
                                rs.timeout_error_count,
                                wg.name AS wg_name,
                                wg.request_max_memory_grant_percent,
                                wg.request_max_cpu_time_sec,
                                wg.request_memory_grant_timeout_sec,
                                wg.max_dop,
                                rp.name AS rp_name,
                                rp.min_memory_percent,
                                rp.max_memory_percent,
                                rp.min_cpu_percent,
                                rp.max_cpu_percent,
                                ''
                            ELSE
                                ''sp.memory_usage + COALESCE(r.granted_query_memory, 0) AS used_memory,
                                ''
                        END +
                        ''LOWER(sp.status) AS status,
                        COALESCE(r.sql_handle, sp.sql_handle) AS sql_handle,
                        COALESCE(r.statement_start_offset, sp.statement_start_offset) AS statement_start_offset,
                        COALESCE(r.statement_end_offset, sp.statement_end_offset) AS statement_end_offset,
                        '' +
                        CASE
                            WHEN
                            (
                                @get_task_info <> 0
                                OR @find_block_leaders = 1
                            ) THEN
                                ''sp.wait_type COLLATE Latin1_General_Bin2 AS wait_type,
                                sp.wait_resource COLLATE Latin1_General_Bin2 AS resource_description,
                                sp.wait_time AS wait_duration_ms,
                                ''
                            ELSE
                                ''''
                        END +
                        ''NULLIF(sp.blocked, 0) AS blocking_session_id,
                        r.plan_handle,
                        NULLIF(r.percent_complete, 0) AS percent_complete,
                        sp.host_name,
                        sp.login_name,
                        sp.program_name,
                        s.host_process_id,
                        COALESCE(r.text_size, s.text_size) AS text_size,
                        COALESCE(r.language, s.language) AS language,
                        COALESCE(r.date_format, s.date_format) AS date_format,
                        COALESCE(r.date_first, s.date_first) AS date_first,
                        COALESCE(r.quoted_identifier, s.quoted_identifier) AS quoted_identifier,
                        COALESCE(r.arithabort, s.arithabort) AS arithabort,
                        COALESCE(r.ansi_null_dflt_on, s.ansi_null_dflt_on) AS ansi_null_dflt_on,
                        COALESCE(r.ansi_defaults, s.ansi_defaults) AS ansi_defaults,
                        COALESCE(r.ansi_warnings, s.ansi_warnings) AS ansi_warnings,
                        COALESCE(r.ansi_padding, s.ansi_padding) AS ansi_padding,
                        COALESCE(r.ansi_nulls, s.ansi_nulls) AS ansi_nulls,
                        COALESCE(r.concat_null_yields_null, s.concat_null_yields_null) AS concat_null_yields_null,
                        COALESCE(r.transaction_isolation_level, s.transaction_isolation_level) AS transaction_isolation_level,
                        COALESCE(r.lock_timeout, s.lock_timeout) AS lock_timeout,
                        COALESCE(r.deadlock_priority, s.deadlock_priority) AS deadlock_priority,
                        COALESCE(r.row_count, s.row_count) AS row_count,
                        COALESCE(r.command, sp.cmd) AS command_type,
                        NULLIF(COALESCE(r.context_info, s.context_info), 0x) AS context_info,
                        COALESCE
                        (
                            CASE
                                WHEN
                                (
                                    s.is_user_process = 0
                                    AND r.total_elapsed_time >= 0
                                ) THEN
                                    DATEADD
                                    (
                                        ms,
                                        1000 * (DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())) / 500) - DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())),
                                        DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())
                                    )
                            END,
                            NULLIF(COALESCE(r.start_time, sp.last_request_end_time), CONVERT(DATETIME, ''''19000101'''', 112)),
                            sp.login_time
                        ) AS start_time,
                        sp.login_time,
                        CASE
                            WHEN s.is_user_process = 1 THEN
                                s.last_request_start_time
                            ELSE
                                COALESCE
                                (
                                    DATEADD
                                    (
                                        ms,
                                        1000 * (DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())) / 500) - DATEPART(ms, DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())),
                                        DATEADD(second, -(r.total_elapsed_time / 1000), GETDATE())
                                    ),
                                    s.last_request_start_time
                                )
                        END AS last_request_start_time,
                        r.transaction_id,
                        sp.database_id,
                        sp.open_tran_count,
                        '' +
                        CASE
                            WHEN EXISTS
                            (
                                SELECT
                                    *
                                FROM sys.all_columns AS ac
                                WHERE
                                    ac.object_id = OBJECT_ID(''sys.dm_exec_sessions'')
                                    AND ac.name = ''group_id''
                            )
                                THEN ''s.group_id,''
                            ELSE ''CONVERT(INT, NULL) AS group_id,''
                        END + ''
                        s.original_login_name
                    FROM '' +
                    CASE
                        WHEN @get_memory_info = 1 THEN
                            ''(
                                SELECT TOP(@i)
                                    rp0.*
                                FROM sys.resource_governor_resource_pools AS rp0
                            ) AS rp
                            RIGHT OUTER HASH JOIN
                            (
                                (
                                    SELECT TOP(@i)
                                        wg0.*
                                    FROM sys.resource_governor_workload_groups AS wg0
                                ) AS wg
                                RIGHT OUTER HASH JOIN
                                (
                                    (
                                        SELECT TOP(@i)
                                            rs0.*
                                        FROM sys.dm_exec_query_resource_semaphores AS rs0
                                    ) AS rs
                                    RIGHT OUTER HASH JOIN
                                    (
                                        '' + @core_session_join +
                                        ''LEFT OUTER LOOP JOIN sys.dm_exec_query_memory_grants AS mg ON
                                            sp.session_id = mg.session_id
                                            AND sp.request_id = mg.request_id
                                    ) ON
                                        rs.resource_semaphore_id = mg.resource_semaphore_id
                                        AND rs.pool_id = mg.pool_id
                                ) ON
                                    wg.group_id = s.group_id
                            ) ON
                                rp.pool_id = wg.pool_id ''
                        ELSE @core_session_join
                    END + ''
                ) AS y
                '' +
                CASE
                    WHEN @get_task_info = 2 THEN
                        CONVERT(VARCHAR(MAX), '''') +
                        ''LEFT OUTER HASH JOIN
                        (
                            SELECT TOP(@i)
                                task_nodes.task_node.value(''''(session_id/text())[1]'''', ''''SMALLINT'''') AS session_id,
                                task_nodes.task_node.value(''''(request_id/text())[1]'''', ''''INT'''') AS request_id,
                                task_nodes.task_node.value(''''(physical_io/text())[1]'''', ''''BIGINT'''') AS physical_io,
                                task_nodes.task_node.value(''''(context_switches/text())[1]'''', ''''BIGINT'''') AS context_switches,
                                task_nodes.task_node.value(''''(tasks/text())[1]'''', ''''INT'''') AS tasks,
                                task_nodes.task_node.value(''''(block_info/text())[1]'''', ''''NVARCHAR(4000)'''') AS block_info,
                                task_nodes.task_node.value(''''(waits/text())[1]'''', ''''NVARCHAR(4000)'''') AS wait_info,
                                task_nodes.task_node.value(''''(thread_CPU_snapshot/text())[1]'''', ''''BIGINT'''') AS thread_CPU_snapshot
                            FROM
                            (
                                SELECT TOP(@i)
                                    CONVERT
                                    (
                                        XML,
                                        REPLACE
                                        (
                                            CONVERT(NVARCHAR(MAX), tasks_raw.task_xml_raw) COLLATE Latin1_General_Bin2,
                                            N''''</waits></tasks><tasks><waits>'''',
                                            N'''', ''''
                                        )
                                    ) AS task_xml
                                FROM
                                (
                                    SELECT TOP(@i)
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.session_id
                                            ELSE
                                                NULL
                                        END AS [session_id],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.request_id
                                            ELSE
                                                NULL
                                        END AS [request_id],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.physical_io
                                            ELSE
                                                NULL
                                        END AS [physical_io],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.context_switches
                                            ELSE
                                                NULL
                                        END AS [context_switches],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.thread_CPU_snapshot
                                            ELSE
                                                NULL
                                        END AS [thread_CPU_snapshot],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.tasks
                                            ELSE
                                                NULL
                                        END AS [tasks],
                                        CASE waits.r
                                            WHEN 1 THEN
                                                waits.block_info
                                            ELSE
                                                NULL
                                        END AS [block_info],
                                        REPLACE
                                        (
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                CONVERT
                                                (
                                                    NVARCHAR(MAX),
                                                    N''''('''' +
                                                        CONVERT(NVARCHAR, num_waits) + N''''x: '''' +
                                                        CASE num_waits
                                                            WHEN 1 THEN
                                                                CONVERT(NVARCHAR, min_wait_time) + N''''ms''''
                                                            WHEN 2 THEN
                                                                CASE
                                                                    WHEN min_wait_time <> max_wait_time THEN
                                                                        CONVERT(NVARCHAR, min_wait_time) + N''''/'''' + CONVERT(NVARCHAR, max_wait_time) + N''''ms''''
                                                                    ELSE
                                                                        CONVERT(NVARCHAR, max_wait_time) + N''''ms''''
                                                                END
                                                            ELSE
                                                                CASE
                                                                    WHEN min_wait_time <> max_wait_time THEN
                                                                        CONVERT(NVARCHAR, min_wait_time) + N''''/'''' + CONVERT(NVARCHAR, avg_wait_time) + N''''/'''' + CONVERT(NVARCHAR, max_wait_time) + N''''ms''''
                                                                    ELSE
                                                                        CONVERT(NVARCHAR, max_wait_time) + N''''ms''''
                                                                END
                                                        END +
                                                    N'''')'''' + wait_type COLLATE Latin1_General_Bin2
                                                ),
                                                NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                                NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                                NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                            NCHAR(0),
                                            N''''''''
                                        ) AS [waits]
                                    FROM
                                    (
                                        SELECT TOP(@i)
                                            w1.*,
                                            ROW_NUMBER() OVER
                                            (
                                                PARTITION BY
                                                    w1.session_id,
                                                    w1.request_id
                                                ORDER BY
                                                    w1.block_info DESC,
                                                    w1.num_waits DESC,
                                                    w1.wait_type
                                            ) AS r
                                        FROM
                                        (
                                            SELECT TOP(@i)
                                                task_info.session_id,
                                                task_info.request_id,
                                                task_info.physical_io,
                                                task_info.context_switches,
                                                task_info.thread_CPU_snapshot,
                                                task_info.num_tasks AS tasks,
                                                CASE
                                                    WHEN task_info.runnable_time IS NOT NULL THEN
                                                        ''''RUNNABLE''''
                                                    ELSE
                                                        wt2.wait_type
                                                END AS wait_type,
                                                NULLIF(COUNT(COALESCE(task_info.runnable_time, wt2.waiting_task_address)), 0) AS num_waits,
                                                MIN(COALESCE(task_info.runnable_time, wt2.wait_duration_ms)) AS min_wait_time,
                                                AVG(COALESCE(task_info.runnable_time, wt2.wait_duration_ms)) AS avg_wait_time,
                                                MAX(COALESCE(task_info.runnable_time, wt2.wait_duration_ms)) AS max_wait_time,
                                                MAX(wt2.block_info) AS block_info
                                            FROM
                                            (
                                                SELECT TOP(@i)
                                                    t.session_id,
                                                    t.request_id,
                                                    SUM(CONVERT(BIGINT, t.pending_io_count)) OVER (PARTITION BY t.session_id, t.request_id) AS physical_io,
                                                    SUM(CONVERT(BIGINT, t.context_switches_count)) OVER (PARTITION BY t.session_id, t.request_id) AS context_switches,
                                                    '' +
                                                    CASE
                                                        WHEN
                                                            @output_column_list LIKE ''%|[CPU_delta|]%'' ESCAPE ''|''
                                                            AND @sys_info = 1
                                                            THEN
                                                                ''SUM(tr.usermode_time + tr.kernel_time) OVER (PARTITION BY t.session_id, t.request_id) ''
                                                        ELSE
                                                            ''CONVERT(BIGINT, NULL) ''
                                                    END +
                                                        '' AS thread_CPU_snapshot,
                                                    COUNT(*) OVER (PARTITION BY t.session_id, t.request_id) AS num_tasks,
                                                    t.task_address,
                                                    t.task_state,
                                                    CASE
                                                        WHEN
                                                            t.task_state = ''''RUNNABLE''''
                                                            AND w.runnable_time > 0 THEN
                                                                w.runnable_time
                                                        ELSE
                                                            NULL
                                                    END AS runnable_time
                                                FROM sys.dm_os_tasks AS t
                                                CROSS APPLY
                                                (
                                                    SELECT TOP(1)
                                                        sp2.session_id
                                                    FROM @sessions AS sp2
                                                    WHERE
                                                        sp2.session_id = t.session_id
                                                        AND sp2.request_id = t.request_id
                                                        AND sp2.status <> ''''sleeping''''
                                                ) AS sp20
                                                LEFT OUTER HASH JOIN
                                                (
                                                '' +
                                                    CASE
                                                        WHEN @sys_info = 1 THEN
                                                            ''SELECT TOP(@i)
                                                                (
                                                                    SELECT TOP(@i)
                                                                        ms_ticks
                                                                    FROM sys.dm_os_sys_info
                                                                ) -
                                                                    w0.wait_resumed_ms_ticks AS runnable_time,
                                                                w0.worker_address,
                                                                w0.thread_address,
                                                                w0.task_bound_ms_ticks
                                                            FROM sys.dm_os_workers AS w0
                                                            WHERE
                                                                w0.state = ''''RUNNABLE''''
                                                                OR @first_collection_ms_ticks >= w0.task_bound_ms_ticks''
                                                        ELSE
                                                            ''SELECT
                                                                CONVERT(BIGINT, NULL) AS runnable_time,
                                                                CONVERT(VARBINARY(8), NULL) AS worker_address,
                                                                CONVERT(VARBINARY(8), NULL) AS thread_address,
                                                                CONVERT(BIGINT, NULL) AS task_bound_ms_ticks
                                                            WHERE
                                                                1 = 0''
                                                        END +
                                                ''
                                                ) AS w ON
                                                    w.worker_address = t.worker_address
                                                '' +
                                                CASE
                                                    WHEN
                                                        @output_column_list LIKE ''%|[CPU_delta|]%'' ESCAPE ''|''
                                                        AND @sys_info = 1
                                                        THEN
                                                            ''LEFT OUTER HASH JOIN sys.dm_os_threads AS tr ON
                                                                tr.thread_address = w.thread_address
                                                                AND @first_collection_ms_ticks >= w.task_bound_ms_ticks
                                                            ''
                                                    ELSE
                                                        ''''
                                                END +
                                            '') AS task_info
                                            LEFT OUTER HASH JOIN
                                            (
                                                SELECT TOP(@i)
                                                    wt1.wait_type,
                                                    wt1.waiting_task_address,
                                                    MAX(wt1.wait_duration_ms) AS wait_duration_ms,
                                                    MAX(wt1.block_info) AS block_info
                                                FROM
                                                (
                                                    SELECT DISTINCT TOP(@i)
                                                        wt.wait_type +
                                                            CASE
                                                                WHEN wt.wait_type LIKE N''''PAGE%LATCH_%'''' THEN
                                                                    '''':'''' +
                                                                    COALESCE(DB_NAME(CONVERT(INT, LEFT(wt.resource_description, CHARINDEX(N'''':'''', wt.resource_description) - 1))), N''''(null)'''') +
                                                                    N'''':'''' +
                                                                    SUBSTRING(wt.resource_description, CHARINDEX(N'''':'''', wt.resource_description) + 1, LEN(wt.resource_description) - CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - CHARINDEX(N'''':'''', wt.resource_description)) +
                                                                    N''''('''' +
                                                                        CASE
                                                                            WHEN
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) = 1 OR
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) % 8088 = 0
                                                                                    THEN
                                                                                        N''''PFS''''
                                                                            WHEN
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) = 2 OR
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) % 511232 = 0
                                                                                    THEN
                                                                                        N''''GAM''''
                                                                            WHEN
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) = 3 OR
                                                                                (CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) - 1) % 511232 = 0
                                                                                    THEN
                                                                                        N''''SGAM''''
                                                                            WHEN
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) = 6 OR
                                                                                (CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) - 6) % 511232 = 0
                                                                                    THEN
                                                                                        N''''DCM''''
                                                                            WHEN
                                                                                CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) = 7 OR
                                                                                (CONVERT(INT, RIGHT(wt.resource_description, CHARINDEX(N'''':'''', REVERSE(wt.resource_description)) - 1)) - 7) % 511232 = 0
                                                                                    THEN
                                                                                        N''''BCM''''
                                                                            ELSE
                                                                                N''''*''''
                                                                        END +
                                                                    N'''')''''
                                                                WHEN wt.wait_type IN (N''''CXPACKET'''', N''''CXCONSUMER'''', N''''CXSYNC_PORT'''', N''''CXSYNC_CONSUMER'''') THEN
                                                                    N'''':'''' +
                                                                        SUBSTRING
                                                                        (
                                                                            wt.resource_description,
                                                                            CHARINDEX(N''''nodeId'''', wt.resource_description) + 7,
                                                                            CASE
                                                                                WHEN CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''nodeId'''', wt.resource_description)) > 0
                                                                                 THEN CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''nodeId'''', wt.resource_description) + 7) - 7 - CHARINDEX(N''''nodeId'''', wt.resource_description)
                                                                                ELSE 4
                                                                            END
                                                                        )
                                                                WHEN wt.wait_type LIKE N''''LATCH[_]%'''' THEN
                                                                    N'''' ['''' + LEFT(wt.resource_description, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description), 0), LEN(wt.resource_description) + 1) - 1) + N'''']''''
                                                                ELSE
                                                                    N''''''''
                                                            END COLLATE Latin1_General_Bin2 AS wait_type,
                                                        CASE
                                                            WHEN
                                                            (
                                                                wt.blocking_session_id IS NOT NULL
                                                                AND wt.wait_type LIKE N''''LCK[_]%''''
                                                            ) THEN
                                                                (
                                                                    SELECT TOP(@i)
                                                                        x.lock_type,
                                                                        REPLACE
                                                                        (
                                                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                                                DB_NAME
                                                                                (
                                                                                    CONVERT
                                                                                    (
                                                                                        INT,
                                                                                        SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''dbid='''', wt.resource_description), 0) + 5, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''dbid='''', wt.resource_description) + 5), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''dbid='''', wt.resource_description) - 5)
                                                                                    )
                                                                                ),
                                                                                NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                                                                NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                                                                NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                                                            NCHAR(0),
                                                                            N''''''''
                                                                        ) AS database_name,
                                                                        CASE x.lock_type
                                                                            WHEN N''''objectlock'''' THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''objid='''', wt.resource_description), 0) + 6, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''objid='''', wt.resource_description) + 6), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''objid='''', wt.resource_description) - 6)
                                                                            ELSE
                                                                                NULL
                                                                        END AS object_id,
                                                                        CASE x.lock_type
                                                                            WHEN N''''filelock'''' THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''fileid='''', wt.resource_description), 0) + 7, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''fileid='''', wt.resource_description) + 7), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''fileid='''', wt.resource_description) - 7)
                                                                            ELSE
                                                                                NULL
                                                                        END AS file_id,
                                                                        CASE
                                                                            WHEN x.lock_type in (N''''pagelock'''', N''''extentlock'''', N''''ridlock'''') THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''associatedObjectId='''', wt.resource_description), 0) + 19, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''associatedObjectId='''', wt.resource_description) + 19), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''associatedObjectId='''', wt.resource_description) - 19)
                                                                            WHEN x.lock_type in (N''''keylock'''', N''''hobtlock'''', N''''allocunitlock'''') THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''hobtid='''', wt.resource_description), 0) + 7, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''hobtid='''', wt.resource_description) + 7), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''hobtid='''', wt.resource_description) - 7)
                                                                            ELSE
                                                                                NULL
                                                                        END AS hobt_id,
                                                                        CASE x.lock_type
                                                                            WHEN N''''applicationlock'''' THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''hash='''', wt.resource_description), 0) + 5, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''hash='''', wt.resource_description) + 5), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''hash='''', wt.resource_description) - 5)
                                                                            ELSE
                                                                                NULL
                                                                        END AS applock_hash,
                                                                        CASE x.lock_type
                                                                            WHEN N''''metadatalock'''' THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''subresource='''', wt.resource_description), 0) + 12, COALESCE(NULLIF(CHARINDEX(N'''' '''', wt.resource_description, CHARINDEX(N''''subresource='''', wt.resource_description) + 12), 0), LEN(wt.resource_description) + 1) - CHARINDEX(N''''subresource='''', wt.resource_description) - 12)
                                                                            ELSE
                                                                                NULL
                                                                        END AS metadata_resource,
                                                                        CASE x.lock_type
                                                                            WHEN N''''metadatalock'''' THEN
                                                                                SUBSTRING(wt.resource_description, NULLIF(CHARINDEX(N''''classid='''', wt.resource_description), 0) + 8, COALESCE(NULLIF(CHARINDEX(N'''' dbid='''', wt.resource_description) - CHARINDEX(N''''classid='''', wt.resource_description), 0), LEN(wt.resource_description) + 1) - 8)
                                                                            ELSE
                                                                                NULL
                                                                        END AS metadata_class_id
                                                                    FROM
                                                                    (
                                                                        SELECT TOP(1)
                                                                            LEFT(wt.resource_description, CHARINDEX(N'''' '''', wt.resource_description) - 1) COLLATE Latin1_General_Bin2 AS lock_type
                                                                    ) AS x
                                                                    FOR XML
                                                                        PATH('''''''')
                                                                )
                                                            ELSE NULL
                                                        END AS block_info,
                                                        wt.wait_duration_ms,
                                                        wt.waiting_task_address
                                                    FROM
                                                    (
                                                        SELECT TOP(@i)
                                                            wt0.wait_type COLLATE Latin1_General_Bin2 AS wait_type,
                                                            LEFT
                                                            (
                                                                p.resource_description,
                                                                ISNULL(NULLIF(CHARINDEX('''' (LATCH '''', p.resource_description) - 1, -1), 256)
                                                            ) AS resource_description,
                                                            wt0.wait_duration_ms,
                                                            wt0.waiting_task_address,
                                                            CASE
                                                                WHEN wt0.blocking_session_id = p.blocked THEN
                                                                    wt0.blocking_session_id
                                                                ELSE
                                                                    NULL
                                                            END AS blocking_session_id
                                                        FROM sys.dm_os_waiting_tasks AS wt0
                                                        CROSS APPLY
                                                        (
                                                            SELECT TOP(1)
                                                                s0.blocked,
                                                                wt0.resource_description COLLATE Latin1_General_Bin2 AS resource_description
                                                            FROM @sessions AS s0
                                                            WHERE
                                                                s0.session_id = wt0.session_id
                                                                AND COALESCE(s0.wait_type, N'''''''') <> N''''OLEDB''''
                                                                AND wt0.wait_type <> N''''OLEDB''''
                                                        ) AS p
                                                    ) AS wt
                                                ) AS wt1
                                                GROUP BY
                                                    wt1.wait_type,
                                                    wt1.waiting_task_address
                                            ) AS wt2 ON
                                                wt2.waiting_task_address = task_info.task_address
                                                AND wt2.wait_duration_ms > 0
                                                AND task_info.runnable_time IS NULL
                                            GROUP BY
                                                task_info.session_id,
                                                task_info.request_id,
                                                task_info.physical_io,
                                                task_info.context_switches,
                                                task_info.thread_CPU_snapshot,
                                                task_info.num_tasks,
                                                CASE
                                                    WHEN task_info.runnable_time IS NOT NULL THEN
                                                        ''''RUNNABLE''''
                                                    ELSE
                                                        wt2.wait_type
                                                END
                                        ) AS w1
                                    ) AS waits
                                    ORDER BY
                                        waits.session_id,
                                        waits.request_id,
                                        waits.r
                                    FOR XML
                                        PATH(N''''tasks''''),
                                        TYPE
                                ) AS tasks_raw (task_xml_raw)
                            ) AS tasks_final
                            CROSS APPLY tasks_final.task_xml.nodes(N''''/tasks'''') AS task_nodes (task_node)
                            WHERE
                                task_nodes.task_node.exist(N''''session_id'''') = 1
                        ) AS tasks ON
                            tasks.session_id = y.session_id
                            AND tasks.request_id = y.request_id
                        ''
                    ELSE
                        ''''
                END +
                ''LEFT OUTER HASH JOIN
                (
                    SELECT TOP(@i)
                        t_info.session_id,
                        COALESCE(t_info.request_id, -1) AS request_id,
                        SUM(t_info.tempdb_allocations) AS tempdb_allocations,
                        SUM(t_info.tempdb_current) AS tempdb_current
                    FROM
                    (
                        SELECT TOP(@i)
                            tsu.session_id,
                            tsu.request_id,
                            tsu.user_objects_alloc_page_count +
                                tsu.internal_objects_alloc_page_count AS tempdb_allocations,
                            tsu.user_objects_alloc_page_count +
                                tsu.internal_objects_alloc_page_count -
                                tsu.user_objects_dealloc_page_count -
                                tsu.internal_objects_dealloc_page_count AS tempdb_current
                        FROM sys.dm_db_task_space_usage AS tsu
                        CROSS APPLY
                        (
                            SELECT TOP(1)
                                s0.session_id
                            FROM @sessions AS s0
                            WHERE
                                s0.session_id = tsu.session_id
                        ) AS p

                        UNION ALL

                        SELECT TOP(@i)
                            ssu.session_id,
                            NULL AS request_id,
                            ssu.user_objects_alloc_page_count +
                                ssu.internal_objects_alloc_page_count AS tempdb_allocations,
                            ssu.user_objects_alloc_page_count +
                                ssu.internal_objects_alloc_page_count -
                                ssu.user_objects_dealloc_page_count -
                                ssu.internal_objects_dealloc_page_count AS tempdb_current
                        FROM sys.dm_db_session_space_usage AS ssu
                        CROSS APPLY
                        (
                            SELECT TOP(1)
                                s0.session_id
                            FROM @sessions AS s0
                            WHERE
                                s0.session_id = ssu.session_id
                        ) AS p
                    ) AS t_info
                    GROUP BY
                        t_info.session_id,
                        COALESCE(t_info.request_id, -1)
                ) AS tempdb_info ON
                    tempdb_info.session_id = y.session_id
                    AND tempdb_info.request_id =
                        CASE
                            WHEN y.status = N''''sleeping'''' THEN
                                -1
                            ELSE
                                y.request_id
                        END
                '' +
                CASE
                    WHEN
                        NOT
                        (
                            @get_avg_time = 1
                            AND @recursion = 1
                        ) THEN
                            ''''
                    ELSE
                        ''LEFT OUTER HASH JOIN
                        (
                            SELECT TOP(@i)
                                *
                            FROM sys.dm_exec_query_stats
                        ) AS qs ON
                            qs.sql_handle = y.sql_handle
                            AND qs.plan_handle = y.plan_handle
                            AND qs.statement_start_offset = y.statement_start_offset
                            AND qs.statement_end_offset = y.statement_end_offset
                        ''
                END +
            '') AS x
            OPTION (KEEPFIXED PLAN, OPTIMIZE FOR (@i = 1)); '';

        SET @sql_n = CONVERT(NVARCHAR(MAX), @sql);

        SET @last_collection_start = GETDATE();

        IF
            @recursion = -1
            AND @sys_info = 1
        BEGIN;
            SELECT
                @first_collection_ms_ticks = ms_ticks
            FROM sys.dm_os_sys_info;
        END;

        INSERT #sessions
        (
            recursion,
            session_id,
            request_id,
            session_number,
            elapsed_time,
            avg_elapsed_time,
            physical_io,
            reads,
            physical_reads,
            writes,
            tempdb_allocations,
            tempdb_current,
            CPU,
            thread_CPU_snapshot,
            context_switches,
            used_memory,
            max_used_memory,
            requested_memory,
            granted_memory,
            tasks,
            status,
            wait_info,
            transaction_id,
            open_tran_count,
            sql_handle,
            statement_start_offset,
            statement_end_offset,       
            sql_text,
            plan_handle,
            blocking_session_id,
            percent_complete,
            host_name,
            login_name,
            database_name,
            program_name,
            additional_info,
            memory_info,
            start_time,
            login_time,
            last_request_start_time
        )
        EXEC sp_executesql
            @sql_n,
            N''@recursion SMALLINT, @filter sysname, @not_filter sysname, @first_collection_ms_ticks BIGINT'',
            @recursion, @filter, @not_filter, @first_collection_ms_ticks;

        --Collect transaction information?
        IF
            @recursion = 1
            AND
            (
                @output_column_list LIKE ''%|[tran_start_time|]%'' ESCAPE ''|''
                OR @output_column_list LIKE ''%|[tran_log_writes|]%'' ESCAPE ''|''
                OR @output_column_list LIKE ''%|[implicit_tran|]%'' ESCAPE ''|''
            )
        BEGIN;   
            DECLARE @i INT;
            SET @i = 2147483647;

            UPDATE s
            SET
                tran_start_time =
                    CONVERT
                    (
                        DATETIME,
                        LEFT
                        (
                            x.trans_info,
                            NULLIF(CHARINDEX(NCHAR(254) COLLATE Latin1_General_Bin2, x.trans_info) - 1, -1)
                        ),
                        121
                    ),
                tran_log_writes =
                    RIGHT
                    (
                        x.trans_info,
                        LEN(x.trans_info) - CHARINDEX(NCHAR(254) COLLATE Latin1_General_Bin2, x.trans_info)
                    ),
                implicit_tran =
                    CASE
                        WHEN x.implicit_tran = 1 THEN ''ON''
                        ELSE ''OFF''
                    END
            FROM
            (
                SELECT TOP(@i)
                    trans_nodes.trans_node.value(''(session_id/text())[1]'', ''SMALLINT'') AS session_id,
                    COALESCE(trans_nodes.trans_node.value(''(request_id/text())[1]'', ''INT''), 0) AS request_id,
                    trans_nodes.trans_node.value(''(implicit_tran/text())[1]'', ''INT'') AS implicit_tran,
                    trans_nodes.trans_node.value(''(trans_info/text())[1]'', ''NVARCHAR(4000)'') AS trans_info
                FROM
                (
                    SELECT TOP(@i)
                        CONVERT
                        (
                            XML,
                            REPLACE
                            (
                                CONVERT(NVARCHAR(MAX), trans_raw.trans_xml_raw) COLLATE Latin1_General_Bin2,
                                N''</trans_info></trans><trans><trans_info>'', N''''
                            )
                        )
                    FROM
                    (
                        SELECT TOP(@i)
                            CASE u_trans.r
                                WHEN 1 THEN u_trans.session_id
                                ELSE NULL
                            END AS [session_id],
                            CASE u_trans.r
                                WHEN 1 THEN u_trans.request_id
                                ELSE NULL
                            END AS [request_id],
                            u_trans.implicit_tran AS [implicit_tran],
                            CONVERT
                            (
                                NVARCHAR(MAX),
                                CASE
                                    WHEN u_trans.database_id IS NOT NULL THEN
                                        CASE u_trans.r
                                            WHEN 1 THEN COALESCE(CONVERT(NVARCHAR, u_trans.transaction_start_time, 121) + NCHAR(254), N'''')
                                            ELSE N''''
                                        END +
                                            REPLACE
                                            (
                                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                    CONVERT(VARCHAR(128), COALESCE(DB_NAME(u_trans.database_id), N''(null)'')),
                                                    NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                                    NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                                    NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                                                NCHAR(0),
                                                N''?''
                                            ) +
                                            N'': '' +
                                        CONVERT(NVARCHAR, u_trans.log_record_count) + N'' ('' + CONVERT(NVARCHAR, u_trans.log_kb_used) + N'' kB)'' +
                                        N'',''
                                    ELSE
                                        N''N/A,''
                                END COLLATE Latin1_General_Bin2
                            ) AS [trans_info]
                        FROM
                        (
                            SELECT TOP(@i)
                                trans.*,
                                ROW_NUMBER() OVER
                                (
                                    PARTITION BY
                                        trans.session_id,
                                        trans.request_id
                                    ORDER BY
                                        trans.transaction_start_time DESC
                                ) AS r
                            FROM
                            (
                                SELECT TOP(@i)
                                    session_tran_map.session_id,
                                    session_tran_map.request_id,
                                    s_tran.database_id,
                                    COALESCE(SUM(s_tran.database_transaction_log_record_count), 0) AS log_record_count,
                                    COALESCE(SUM(s_tran.database_transaction_log_bytes_used), 0) / 1024 AS log_kb_used,
                                    MIN(s_tran.database_transaction_begin_time) AS transaction_start_time,
                                    MAX
                                    (
                                        CASE
                                            WHEN a_tran.name = ''implicit_transaction'' THEN 1
                                            ELSE 0
                                        END
                                    ) AS implicit_tran
                                FROM
                                (
                                    SELECT TOP(@i)
                                        *
                                    FROM sys.dm_tran_active_transactions
                                    WHERE
                                        transaction_begin_time <= @last_collection_start
                                ) AS a_tran
                                INNER HASH JOIN
                                (
                                    SELECT TOP(@i)
                                        *
                                    FROM sys.dm_tran_database_transactions
                                    WHERE
                                        database_id < 32767
                                ) AS s_tran ON
                                    s_tran.transaction_id = a_tran.transaction_id
                                LEFT OUTER HASH JOIN
                                (
                                    SELECT TOP(@i)
                                        *
                                    FROM sys.dm_tran_session_transactions
                                ) AS tst ON
                                    s_tran.transaction_id = tst.transaction_id
                                CROSS APPLY
                                (
                                    SELECT TOP(1)
                                        s3.session_id,
                                        s3.request_id
                                    FROM
                                    (
                                        SELECT TOP(1)
                                            s1.session_id,
                                            s1.request_id
                                        FROM #sessions AS s1
                                        WHERE
                                            s1.transaction_id = s_tran.transaction_id
                                            AND s1.recursion = 1
                                           
                                        UNION ALL
                                   
                                        SELECT TOP(1)
                                            s2.session_id,
                                            s2.request_id
                                        FROM #sessions AS s2
                                        WHERE
                                            s2.session_id = tst.session_id
                                            AND s2.recursion = 1
                                    ) AS s3
                                    ORDER BY
                                        s3.request_id
                                ) AS session_tran_map
                                GROUP BY
                                    session_tran_map.session_id,
                                    session_tran_map.request_id,
                                    s_tran.database_id
                            ) AS trans
                        ) AS u_trans
                        FOR XML
                            PATH(''trans''),
                            TYPE
                    ) AS trans_raw (trans_xml_raw)
                ) AS trans_final (trans_xml)
                CROSS APPLY trans_final.trans_xml.nodes(''/trans'') AS trans_nodes (trans_node)
            ) AS x
            INNER HASH JOIN #sessions AS s ON
                s.session_id = x.session_id
                AND s.request_id = x.request_id
            OPTION (OPTIMIZE FOR (@i = 1));
        END;

        --Variables for text and plan collection
        DECLARE   
            @session_id SMALLINT,
            @request_id INT,
            @sql_handle VARBINARY(64),
            @plan_handle VARBINARY(64),
            @statement_start_offset INT,
            @statement_end_offset INT,
            @start_time DATETIME,
            @database_name sysname;

        IF
            @recursion = 1
            AND @output_column_list LIKE ''%|[sql_text|]%'' ESCAPE ''|''
        BEGIN;
            DECLARE sql_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT
                    session_id,
                    request_id,
                    sql_handle,
                    statement_start_offset,
                    statement_end_offset
                FROM #sessions
                WHERE
                    recursion = 1
                    AND sql_handle IS NOT NULL
            OPTION (KEEPFIXED PLAN);

            OPEN sql_cursor;

            FETCH NEXT FROM sql_cursor
            INTO
                @session_id,
                @request_id,
                @sql_handle,
                @statement_start_offset,
                @statement_end_offset;

            --Wait up to 5 ms for the SQL text, then give up
            SET LOCK_TIMEOUT 5;

            WHILE @@FETCH_STATUS = 0
            BEGIN;
                BEGIN TRY;
                    UPDATE s
                    SET
                        s.sql_text =
                        (
                            SELECT
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        N''--'' + NCHAR(13) + NCHAR(10) +
                                        CASE
                                            WHEN @get_full_inner_text = 1 THEN est.text
                                            WHEN LEN(est.text) < (@statement_end_offset / 2) + 1 THEN est.text
                                            WHEN SUBSTRING(est.text, (@statement_start_offset/2), 2) LIKE N''[a-zA-Z0-9][a-zA-Z0-9]'' THEN est.text
                                            ELSE
                                                CASE
                                                    WHEN @statement_start_offset > 0 THEN
                                                        SUBSTRING
                                                        (
                                                            est.text,
                                                            ((@statement_start_offset/2) + 1),
                                                            (
                                                                CASE
                                                                    WHEN @statement_end_offset = -1 THEN 2147483647
                                                                    ELSE ((@statement_end_offset - @statement_start_offset)/2) + 1
                                                                END
                                                            )
                                                        )
                                                    ELSE RTRIM(LTRIM(est.text))
                                                END
                                        END +
                                        NCHAR(13) + NCHAR(10) + N''--'' COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                        NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                        NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                                    NCHAR(0),
                                    N''''
                                ) AS [processing-instruction(query)]
                            FOR XML
                                PATH(''''),
                                TYPE
                        ),
                        s.statement_start_offset =
                            CASE
                                WHEN LEN(est.text) < (@statement_end_offset / 2) + 1 THEN 0
                                WHEN SUBSTRING(CONVERT(VARCHAR(MAX), est.text), (@statement_start_offset/2), 2) LIKE ''[a-zA-Z0-9][a-zA-Z0-9]'' THEN 0
                                ELSE @statement_start_offset
                            END,
                        s.statement_end_offset =
                            CASE
                                WHEN LEN(est.text) < (@statement_end_offset / 2) + 1 THEN -1
                                WHEN SUBSTRING(CONVERT(VARCHAR(MAX), est.text), (@statement_start_offset/2), 2) LIKE ''[a-zA-Z0-9][a-zA-Z0-9]'' THEN -1
                                ELSE @statement_end_offset
                            END
                    FROM
                        #sessions AS s,
                        (
                            SELECT TOP(1)
                                text
                            FROM
                            (
                                SELECT
                                    text,
                                    0 AS row_num
                                FROM sys.dm_exec_sql_text(@sql_handle)
                               
                                UNION ALL
                               
                                SELECT
                                    NULL,
                                    1 AS row_num
                            ) AS est0
                            ORDER BY
                                row_num
                        ) AS est
                    WHERE
                        s.session_id = @session_id
                        AND s.request_id = @request_id
                        AND s.recursion = 1
                    OPTION (KEEPFIXED PLAN);
                END TRY
                BEGIN CATCH;
                    UPDATE s
                    SET
                        s.sql_text =
                            CASE ERROR_NUMBER()
                                WHEN 1222 THEN ''<timeout_exceeded />''
                                ELSE ''<error message="'' + ERROR_MESSAGE() + ''" />''
                            END
                    FROM #sessions AS s
                    WHERE
                        s.session_id = @session_id
                        AND s.request_id = @request_id
                        AND s.recursion = 1
                    OPTION (KEEPFIXED PLAN);
                END CATCH;

                FETCH NEXT FROM sql_cursor
                INTO
                    @session_id,
                    @request_id,
                    @sql_handle,
                    @statement_start_offset,
                    @statement_end_offset;
            END;

            --Return this to the default
            SET LOCK_TIMEOUT -1;

            CLOSE sql_cursor;
            DEALLOCATE sql_cursor;
        END;

        IF
            @get_outer_command = 1
            AND @recursion = 1
            AND @output_column_list LIKE ''%|[sql_command|]%'' ESCAPE ''|''
        BEGIN;
            DECLARE @buffer_results TABLE
            (
                EventType VARCHAR(30),
                Parameters INT,
                EventInfo NVARCHAR(4000),
                start_time DATETIME,
                session_number INT IDENTITY(1,1) NOT NULL PRIMARY KEY
            );

            DECLARE buffer_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT
                    session_id,
                    MAX(start_time) AS start_time
                FROM #sessions
                WHERE
                    recursion = 1
                GROUP BY
                    session_id
                ORDER BY
                    session_id
                OPTION (KEEPFIXED PLAN);

            OPEN buffer_cursor;

            FETCH NEXT FROM buffer_cursor
            INTO
                @session_id,
                @start_time;

            WHILE @@FETCH_STATUS = 0
            BEGIN;
                BEGIN TRY;
                    --In SQL Server 2008, DBCC INPUTBUFFER will throw
                    --an exception if the session no longer exists
                    INSERT @buffer_results
                    (
                        EventType,
                        Parameters,
                        EventInfo
                    )
                    EXEC sp_executesql
                        N''DBCC INPUTBUFFER(@session_id) WITH NO_INFOMSGS;'',
                        N''@session_id SMALLINT'',
                        @session_id;

                    UPDATE br
                    SET
                        br.start_time = @start_time
                    FROM @buffer_results AS br
                    WHERE
                        br.session_number =
                        (
                            SELECT MAX(br2.session_number)
                            FROM @buffer_results br2
                        );
                END TRY
                BEGIN CATCH
                END CATCH;

                FETCH NEXT FROM buffer_cursor
                INTO
                    @session_id,
                    @start_time;
            END;

            UPDATE s
            SET
                sql_command =
                (
                    SELECT
                        REPLACE
                        (
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                CONVERT
                                (
                                    NVARCHAR(MAX),
                                    N''--'' + NCHAR(13) + NCHAR(10) + br.EventInfo + NCHAR(13) + NCHAR(10) + N''--'' COLLATE Latin1_General_Bin2
                                ),
                                NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                            NCHAR(0),
                            N''''
                        ) AS [processing-instruction(query)]
                    FROM @buffer_results AS br
                    WHERE
                        br.session_number = s.session_number
                        AND br.start_time = s.start_time
                        AND
                        (
                            (
                                s.start_time = s.last_request_start_time
                                AND EXISTS
                                (
                                    SELECT *
                                    FROM sys.dm_exec_requests r2
                                    WHERE
                                        r2.session_id = s.session_id
                                        AND r2.request_id = s.request_id
                                        AND r2.start_time = s.start_time
                                )
                            )
                            OR
                            (
                                s.request_id = 0
                                AND EXISTS
                                (
                                    SELECT *
                                    FROM sys.dm_exec_sessions s2
                                    WHERE
                                        s2.session_id = s.session_id
                                        AND s2.last_request_start_time = s.last_request_start_time
                                )
                            )
                        )
                    FOR XML
                        PATH(''''),
                        TYPE
                )
            FROM #sessions AS s
            WHERE
                recursion = 1
            OPTION (KEEPFIXED PLAN);

            CLOSE buffer_cursor;
            DEALLOCATE buffer_cursor;
        END;

        IF
            @get_plans >= 1
            AND @recursion = 1
            AND @output_column_list LIKE ''%|[query_plan|]%'' ESCAPE ''|''
        BEGIN;
            DECLARE @live_plan BIT;
            SET @live_plan = ISNULL(CONVERT(BIT, SIGN(OBJECT_ID(''sys.dm_exec_query_statistics_xml''))), 0)

            DECLARE plan_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT
                    session_id,
                    request_id,
                    plan_handle,
                    statement_start_offset,
                    statement_end_offset
                FROM #sessions
                WHERE
                    recursion = 1
                    AND plan_handle IS NOT NULL
            OPTION (KEEPFIXED PLAN);

            OPEN plan_cursor;

            FETCH NEXT FROM plan_cursor
            INTO
                @session_id,
                @request_id,
                @plan_handle,
                @statement_start_offset,
                @statement_end_offset;

            --Wait up to 5 ms for a query plan, then give up
            SET LOCK_TIMEOUT 5;

            WHILE @@FETCH_STATUS = 0
            BEGIN;
                DECLARE @query_plan XML;
                SET @query_plan = NULL;

                IF @live_plan = 1
                BEGIN;
                    BEGIN TRY;
                        SELECT
                            @query_plan = x.query_plan
                        FROM sys.dm_exec_query_statistics_xml(@session_id) AS x;

                        IF
                            @query_plan IS NOT NULL
                            AND EXISTS
                            (
                                SELECT
                                    *
                                FROM sys.dm_exec_requests AS r
                                WHERE
                                    r.session_id = @session_id
                                    AND r.request_id = @request_id
                                    AND r.plan_handle = @plan_handle
                                    AND r.statement_start_offset = @statement_start_offset
                                    AND r.statement_end_offset = @statement_end_offset
                            )
                        BEGIN;
                            UPDATE s
                            SET
                                s.query_plan = @query_plan
                            FROM #sessions AS s
                            WHERE
                                s.session_id = @session_id
                                AND s.request_id = @request_id
                                AND s.recursion = 1
                            OPTION (KEEPFIXED PLAN);
                        END;
                    END TRY
                    BEGIN CATCH;
                        SET @query_plan = NULL;
                    END CATCH;
                END;

                IF @query_plan IS NULL
                BEGIN;
                    BEGIN TRY;
                        UPDATE s
                        SET
                            s.query_plan =
                            (
                                SELECT
                                    CONVERT(xml, query_plan)
                                FROM sys.dm_exec_text_query_plan
                                (
                                    @plan_handle,
                                    CASE @get_plans
                                        WHEN 1 THEN
                                            @statement_start_offset
                                        ELSE
                                            0
                                    END,
                                    CASE @get_plans
                                        WHEN 1 THEN
                                            @statement_end_offset
                                        ELSE
                                            -1
                                    END
                                )
                            )
                        FROM #sessions AS s
                        WHERE
                            s.session_id = @session_id
                            AND s.request_id = @request_id
                            AND s.recursion = 1
                        OPTION (KEEPFIXED PLAN);
                    END TRY
                    BEGIN CATCH;
                        IF ERROR_NUMBER() = 6335
                        BEGIN;
                            UPDATE s
                            SET
                                s.query_plan =
                                (
                                    SELECT
                                        N''--'' + NCHAR(13) + NCHAR(10) +
                                        N''-- Could not render showplan due to XML data type limitations. '' + NCHAR(13) + NCHAR(10) +
                                        N''-- To see the graphical plan save the XML below as a .SQLPLAN file and re-open in SSMS.'' + NCHAR(13) + NCHAR(10) +
                                        N''--'' + NCHAR(13) + NCHAR(10) +
                                            REPLACE(qp.query_plan, N''<RelOp'', NCHAR(13)+NCHAR(10)+N''<RelOp'') +
                                            NCHAR(13) + NCHAR(10) + N''--'' COLLATE Latin1_General_Bin2 AS [processing-instruction(query_plan)]
                                    FROM sys.dm_exec_text_query_plan
                                    (
                                        @plan_handle,
                                        CASE @get_plans
                                            WHEN 1 THEN
                                                @statement_start_offset
                                            ELSE
                                                0
                                        END,
                                        CASE @get_plans
                                            WHEN 1 THEN
                                                @statement_end_offset
                                            ELSE
                                                -1
                                        END
                                    ) AS qp
                                    FOR XML
                                        PATH(''''),
                                        TYPE
                                )
                            FROM #sessions AS s
                            WHERE
                                s.session_id = @session_id
                                AND s.request_id = @request_id
                                AND s.recursion = 1
                            OPTION (KEEPFIXED PLAN);
                        END;
                        ELSE
                        BEGIN;
                            UPDATE s
                            SET
                                s.query_plan =
                                    CASE ERROR_NUMBER()
                                        WHEN 1222 THEN ''<timeout_exceeded />''
                                        ELSE ''<error message="'' + ERROR_MESSAGE() + ''" />''
                                    END
                            FROM #sessions AS s
                            WHERE
                                s.session_id = @session_id
                                AND s.request_id = @request_id
                                AND s.recursion = 1
                            OPTION (KEEPFIXED PLAN);
                        END;
                    END CATCH;
                END;

                FETCH NEXT FROM plan_cursor
                INTO
                    @session_id,
                    @request_id,
                    @plan_handle,
                    @statement_start_offset,
                    @statement_end_offset;
            END;

            --Return this to the default
            SET LOCK_TIMEOUT -1;

            CLOSE plan_cursor;
            DEALLOCATE plan_cursor;
        END;

        IF
            @get_locks = 1
            AND @recursion = 1
            AND @output_column_list LIKE ''%|[locks|]%'' ESCAPE ''|''
        BEGIN;
            DECLARE locks_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT DISTINCT
                    database_name
                FROM #locks
                WHERE
                    EXISTS
                    (
                        SELECT *
                        FROM #sessions AS s
                        WHERE
                            s.session_id = #locks.session_id
                            AND recursion = 1
                    )
                    AND database_name <> ''(null)''
                OPTION (KEEPFIXED PLAN);

            OPEN locks_cursor;

            FETCH NEXT FROM locks_cursor
            INTO
                @database_name;

            WHILE @@FETCH_STATUS = 0
            BEGIN;
                BEGIN TRY;
                    SET @sql_n = CONVERT(NVARCHAR(MAX), N'''') + N''
                        UPDATE l
                        SET
                            object_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        o.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                ),
                            index_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        i.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                ),
                            schema_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        s.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                ),
                            principal_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        dp.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                )
                        FROM #locks AS l
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.allocation_units AS au ON
                            au.allocation_unit_id = l.allocation_unit_id
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.partitions AS p ON
                            p.hobt_id =
                                COALESCE
                                (
                                    l.hobt_id,
                                    CASE
                                        WHEN au.type IN (1, 3) THEN au.container_id
                                        ELSE NULL
                                    END
                                )
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.partitions AS p1 ON
                            l.hobt_id IS NULL
                            AND au.type = 2
                            AND p1.partition_id = au.container_id
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.objects AS o ON
                            o.object_id = COALESCE(l.object_id, p.object_id, p1.object_id)
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.indexes AS i ON
                            i.object_id = COALESCE(l.object_id, p.object_id, p1.object_id)
                            AND i.index_id = COALESCE(l.index_id, p.index_id, p1.index_id)
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.schemas AS s ON
                            s.schema_id = COALESCE(l.schema_id, o.schema_id)
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.database_principals AS dp ON
                            dp.principal_id = l.principal_id
                        WHERE
                            l.database_name = @database_name
                        OPTION (KEEPFIXED PLAN); '';

                    EXEC sp_executesql
                        @sql_n,
                        N''@database_name sysname'',
                        @database_name;
                END TRY
                BEGIN CATCH;
                    UPDATE #locks
                    SET
                        query_error =
                            REPLACE
                            (
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    CONVERT
                                    (
                                        NVARCHAR(MAX),
                                        ERROR_MESSAGE() COLLATE Latin1_General_Bin2
                                    ),
                                    NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                    NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                    NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                                NCHAR(0),
                                N''''
                            )
                    WHERE
                        database_name = @database_name
                    OPTION (KEEPFIXED PLAN);
                END CATCH;

                FETCH NEXT FROM locks_cursor
                INTO
                    @database_name;
            END;

            CLOSE locks_cursor;
            DEALLOCATE locks_cursor;

            CREATE CLUSTERED INDEX IX_SRD ON #locks (session_id, request_id, database_name);

            UPDATE s
            SET
                s.locks =
                (
                    SELECT
                        REPLACE
                        (
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                CONVERT
                                (
                                    NVARCHAR(MAX),
                                    l1.database_name COLLATE Latin1_General_Bin2
                                ),
                                NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                            NCHAR(0),
                            N''''
                        ) AS [Database/@name],
                        MIN(l1.query_error) AS [Database/@query_error],
                        (
                            SELECT
                                l2.request_mode AS [Lock/@request_mode],
                                l2.request_status AS [Lock/@request_status],
                                COUNT(*) AS [Lock/@request_count]
                            FROM #locks AS l2
                            WHERE
                                l1.session_id = l2.session_id
                                AND l1.request_id = l2.request_id
                                AND l2.database_name = l1.database_name
                                AND l2.resource_type = ''DATABASE''
                            GROUP BY
                                l2.request_mode,
                                l2.request_status
                            FOR XML
                                PATH(''''),
                                TYPE
                        ) AS [Database/Locks],
                        (
                            SELECT
                                COALESCE(l3.object_name, ''(null)'') AS [Object/@name],
                                l3.schema_name AS [Object/@schema_name],
                                (
                                    SELECT
                                        l4.resource_type AS [Lock/@resource_type],
                                        l4.page_type AS [Lock/@page_type],
                                        l4.index_name AS [Lock/@index_name],
                                        CASE
                                            WHEN l4.object_name IS NULL THEN l4.schema_name
                                            ELSE NULL
                                        END AS [Lock/@schema_name],
                                        l4.principal_name AS [Lock/@principal_name],
                                        REPLACE
                                        (
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                            REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                                l4.resource_description COLLATE Latin1_General_Bin2,
                                                NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                                NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                                NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                                            NCHAR(0),
                                            N''''
                                        ) AS [Lock/@resource_description],
                                        l4.request_mode AS [Lock/@request_mode],
                                        l4.request_status AS [Lock/@request_status],
                                        SUM(l4.request_count) AS [Lock/@request_count]
                                    FROM #locks AS l4
                                    WHERE
                                        l4.session_id = l3.session_id
                                        AND l4.request_id = l3.request_id
                                        AND l3.database_name = l4.database_name
                                        AND COALESCE(l3.object_name, ''(null)'') = COALESCE(l4.object_name, ''(null)'')
                                        AND COALESCE(l3.schema_name, '''') = COALESCE(l4.schema_name, '''')
                                        AND l4.resource_type <> ''DATABASE''
                                    GROUP BY
                                        l4.resource_type,
                                        l4.page_type,
                                        l4.index_name,
                                        CASE
                                            WHEN l4.object_name IS NULL THEN l4.schema_name
                                            ELSE NULL
                                        END,
                                        l4.principal_name,
                                        l4.resource_description,
                                        l4.request_mode,
                                        l4.request_status
                                    FOR XML
                                        PATH(''''),
                                        TYPE
                                ) AS [Object/Locks]
                            FROM #locks AS l3
                            WHERE
                                l3.session_id = l1.session_id
                                AND l3.request_id = l1.request_id
                                AND l3.database_name = l1.database_name
                                AND l3.resource_type <> ''DATABASE''
                            GROUP BY
                                l3.session_id,
                                l3.request_id,
                                l3.database_name,
                                COALESCE(l3.object_name, ''(null)''),
                                l3.schema_name
                            FOR XML
                                PATH(''''),
                                TYPE
                        ) AS [Database/Objects]
                    FROM #locks AS l1
                    WHERE
                        l1.session_id = s.session_id
                        AND l1.request_id = s.request_id
                        AND l1.start_time IN (s.start_time, s.last_request_start_time)
                        AND s.recursion = 1
                    GROUP BY
                        l1.session_id,
                        l1.request_id,
                        l1.database_name
                    FOR XML
                        PATH(''''),
                        TYPE
                )
            FROM #sessions s
            OPTION (KEEPFIXED PLAN);
        END;

        IF
            @find_block_leaders = 1
            AND @recursion = 1
            AND @output_column_list LIKE ''%|[blocked_session_count|]%'' ESCAPE ''|''
        BEGIN;
            WITH
            blockers AS
            (
                SELECT
                    session_id,
                    session_id AS top_level_session_id,
                    CONVERT(VARCHAR(8000), ''.'' + CONVERT(VARCHAR(8000), session_id) + ''.'') AS the_path
                FROM #sessions
                WHERE
                    recursion = 1

                UNION ALL

                SELECT
                    s.session_id,
                    b.top_level_session_id,
                    CONVERT(VARCHAR(8000), b.the_path + CONVERT(VARCHAR(8000), s.session_id) + ''.'') AS the_path
                FROM blockers AS b
                JOIN #sessions AS s ON
                    s.blocking_session_id = b.session_id
                    AND s.recursion = 1
                    AND b.the_path NOT LIKE ''%.'' + CONVERT(VARCHAR(8000), s.session_id) + ''.%'' COLLATE Latin1_General_Bin2
            )
            UPDATE s
            SET
                s.blocked_session_count = x.blocked_session_count
            FROM #sessions AS s
            JOIN
            (
                SELECT
                    b.top_level_session_id AS session_id,
                    COUNT(*) - 1 AS blocked_session_count
                FROM blockers AS b
                GROUP BY
                    b.top_level_session_id
            ) x ON
                s.session_id = x.session_id
            WHERE
                s.recursion = 1;
        END;

        IF
            @get_task_info = 2
            AND @output_column_list LIKE ''%|[additional_info|]%'' ESCAPE ''|''
            AND @recursion = 1
        BEGIN;
            CREATE TABLE #blocked_requests
            (
                session_id SMALLINT NOT NULL,
                request_id INT NOT NULL,
                database_name sysname NOT NULL,
                object_id INT,
                hobt_id BIGINT,
                schema_id INT,
                schema_name sysname NULL,
                object_name sysname NULL,
                query_error NVARCHAR(2048),
                PRIMARY KEY (database_name, session_id, request_id)
            );

            CREATE STATISTICS s_database_name ON #blocked_requests (database_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_schema_name ON #blocked_requests (schema_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_object_name ON #blocked_requests (object_name)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
            CREATE STATISTICS s_query_error ON #blocked_requests (query_error)
            WITH SAMPLE 0 ROWS, NORECOMPUTE;
       
            INSERT #blocked_requests
            (
                session_id,
                request_id,
                database_name,
                object_id,
                hobt_id,
                schema_id
            )
            SELECT
                session_id,
                request_id,
                database_name,
                object_id,
                hobt_id,
                CONVERT(INT, SUBSTRING(schema_node, CHARINDEX('' = '', schema_node) + 3, LEN(schema_node))) AS schema_id
            FROM
            (
                SELECT
                    session_id,
                    request_id,
                    agent_nodes.agent_node.value(''(database_name/text())[1]'', ''sysname'') AS database_name,
                    agent_nodes.agent_node.value(''(object_id/text())[1]'', ''int'') AS object_id,
                    agent_nodes.agent_node.value(''(hobt_id/text())[1]'', ''bigint'') AS hobt_id,
                    agent_nodes.agent_node.value(''(metadata_resource/text()[.="SCHEMA"]/../../metadata_class_id/text())[1]'', ''varchar(100)'') AS schema_node
                FROM #sessions AS s
                CROSS APPLY s.additional_info.nodes(''//block_info'') AS agent_nodes (agent_node)
                WHERE
                    s.recursion = 1
            ) AS t
            WHERE
                t.database_name IS NOT NULL
                AND
                (
                    t.object_id IS NOT NULL
                    OR t.hobt_id IS NOT NULL
                    OR t.schema_node IS NOT NULL
                );
           
            DECLARE blocks_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT DISTINCT
                    database_name
                FROM #blocked_requests;
               
            OPEN blocks_cursor;
           
            FETCH NEXT FROM blocks_cursor
            INTO
                @database_name;
           
            WHILE @@FETCH_STATUS = 0
            BEGIN;
                BEGIN TRY;
                    SET @sql_n =
                        CONVERT(NVARCHAR(MAX), N'''') + N''
                        UPDATE b
                        SET
                            b.schema_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        s.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                ),
                            b.object_name =
                                REPLACE
                                (
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                        o.name COLLATE Latin1_General_Bin2,
                                        NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                        NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                        NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                    NCHAR(0),
                                    N''''''''
                                )
                        FROM #blocked_requests AS b
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.partitions AS p ON
                            p.hobt_id = b.hobt_id
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.objects AS o ON
                            o.object_id = COALESCE(p.object_id, b.object_id)
                        LEFT OUTER JOIN '' + QUOTENAME(@database_name) + N''.sys.schemas AS s ON
                            s.schema_id = COALESCE(o.schema_id, b.schema_id)
                        WHERE
                            b.database_name = @database_name; '';
                   
                    EXEC sp_executesql
                        @sql_n,
                        N''@database_name sysname'',
                        @database_name;
                END TRY
                BEGIN CATCH;
                    UPDATE #blocked_requests
                    SET
                        query_error =
                            REPLACE
                            (
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    CONVERT
                                    (
                                        NVARCHAR(MAX),
                                        ERROR_MESSAGE() COLLATE Latin1_General_Bin2
                                    ),
                                    NCHAR(31),N''?''),NCHAR(30),N''?''),NCHAR(29),N''?''),NCHAR(28),N''?''),NCHAR(27),N''?''),NCHAR(26),N''?''),NCHAR(25),N''?''),NCHAR(24),N''?''),NCHAR(23),N''?''),NCHAR(22),N''?''),
                                    NCHAR(21),N''?''),NCHAR(20),N''?''),NCHAR(19),N''?''),NCHAR(18),N''?''),NCHAR(17),N''?''),NCHAR(16),N''?''),NCHAR(15),N''?''),NCHAR(14),N''?''),NCHAR(12),N''?''),
                                    NCHAR(11),N''?''),NCHAR(8),N''?''),NCHAR(7),N''?''),NCHAR(6),N''?''),NCHAR(5),N''?''),NCHAR(4),N''?''),NCHAR(3),N''?''),NCHAR(2),N''?''),NCHAR(1),N''?''),
                                NCHAR(0),
                                N''''
                            )
                    WHERE
                        database_name = @database_name;
                END CATCH;

                FETCH NEXT FROM blocks_cursor
                INTO
                    @database_name;
            END;
           
            CLOSE blocks_cursor;
            DEALLOCATE blocks_cursor;
           
            UPDATE s
            SET
                additional_info.modify
                (''
                    insert <schema_name>{sql:column("b.schema_name")}</schema_name>
                    as last
                    into (/additional_info/block_info)[1]
                '')
            FROM #sessions AS s
            INNER JOIN #blocked_requests AS b ON
                b.session_id = s.session_id
                AND b.request_id = s.request_id
                AND s.recursion = 1
            WHERE
                b.schema_name IS NOT NULL;

            UPDATE s
            SET
                additional_info.modify
                (''
                    insert <object_name>{sql:column("b.object_name")}</object_name>
                    as last
                    into (/additional_info/block_info)[1]
                '')
            FROM #sessions AS s
            INNER JOIN #blocked_requests AS b ON
                b.session_id = s.session_id
                AND b.request_id = s.request_id
                AND s.recursion = 1
            WHERE
                b.object_name IS NOT NULL;

            UPDATE s
            SET
                additional_info.modify
                (''
                    insert <query_error>{sql:column("b.query_error")}</query_error>
                    as last
                    into (/additional_info/block_info)[1]
                '')
            FROM #sessions AS s
            INNER JOIN #blocked_requests AS b ON
                b.session_id = s.session_id
                AND b.request_id = s.request_id
                AND s.recursion = 1
            WHERE
                b.query_error IS NOT NULL;
        END;

        IF
            @output_column_list LIKE ''%|[program_name|]%'' ESCAPE ''|''
            AND @output_column_list LIKE ''%|[additional_info|]%'' ESCAPE ''|''
            AND @recursion = 1
            AND DB_ID(''msdb'') IS NOT NULL
        BEGIN;
            SET @sql_n =
                N''BEGIN TRY;
                    DECLARE @job_name sysname;
                    SET @job_name = NULL;
                    DECLARE @step_name sysname;
                    SET @step_name = NULL;

                    SELECT
                        @job_name =
                            REPLACE
                            (
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    j.name,
                                    NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                    NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                    NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                NCHAR(0),
                                N''''?''''
                            ),
                        @step_name =
                            REPLACE
                            (
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(
                                    s.step_name,
                                    NCHAR(31),N''''?''''),NCHAR(30),N''''?''''),NCHAR(29),N''''?''''),NCHAR(28),N''''?''''),NCHAR(27),N''''?''''),NCHAR(26),N''''?''''),NCHAR(25),N''''?''''),NCHAR(24),N''''?''''),NCHAR(23),N''''?''''),NCHAR(22),N''''?''''),
                                    NCHAR(21),N''''?''''),NCHAR(20),N''''?''''),NCHAR(19),N''''?''''),NCHAR(18),N''''?''''),NCHAR(17),N''''?''''),NCHAR(16),N''''?''''),NCHAR(15),N''''?''''),NCHAR(14),N''''?''''),NCHAR(12),N''''?''''),
                                    NCHAR(11),N''''?''''),NCHAR(8),N''''?''''),NCHAR(7),N''''?''''),NCHAR(6),N''''?''''),NCHAR(5),N''''?''''),NCHAR(4),N''''?''''),NCHAR(3),N''''?''''),NCHAR(2),N''''?''''),NCHAR(1),N''''?''''),
                                NCHAR(0),
                                N''''?''''
                            )
                    FROM msdb.dbo.sysjobs AS j
                    INNER JOIN msdb.dbo.sysjobsteps AS s ON
                        j.job_id = s.job_id
                    WHERE
                        j.job_id = @job_id
                        AND s.step_id = @step_id;

                    IF @job_name IS NOT NULL
                    BEGIN;
                        UPDATE s
                        SET
                            additional_info.modify
                            (''''
                                insert text{sql:variable("@job_name")}
                                into (/additional_info/agent_job_info/job_name)[1]
                            '''')
                        FROM #sessions AS s
                        WHERE
                            s.session_id = @session_id
                            AND s.recursion = 1
                        OPTION (KEEPFIXED PLAN);
                       
                        UPDATE s
                        SET
                            additional_info.modify
                            (''''
                                insert text{sql:variable("@step_name")}
                                into (/additional_info/agent_job_info/step_name)[1]
                            '''')
                        FROM #sessions AS s
                        WHERE
                            s.session_id = @session_id
                            AND s.recursion = 1
                        OPTION (KEEPFIXED PLAN);
                    END;
                END TRY
                BEGIN CATCH;
                    DECLARE @msdb_error_message NVARCHAR(256);
                    SET @msdb_error_message = ERROR_MESSAGE();
               
                    UPDATE s
                    SET
                        additional_info.modify
                        (''''
                            insert <msdb_query_error>{sql:variable("@msdb_error_message")}</msdb_query_error>
                            as last
                            into (/additional_info/agent_job_info)[1]
                        '''')
                    FROM #sessions AS s
                    WHERE
                        s.session_id = @session_id
                        AND s.recursion = 1
                    OPTION (KEEPFIXED PLAN);
                END CATCH;''

            DECLARE @job_id UNIQUEIDENTIFIER;
            DECLARE @step_id INT;

            DECLARE agent_cursor
            CURSOR LOCAL FAST_FORWARD
            FOR
                SELECT
                    s.session_id,
                    agent_nodes.agent_node.value(''(job_id/text())[1]'', ''uniqueidentifier'') AS job_id,
                    agent_nodes.agent_node.value(''(step_id/text())[1]'', ''int'') AS step_id
                FROM #sessions AS s
                CROSS APPLY s.additional_info.nodes(''//agent_job_info'') AS agent_nodes (agent_node)
                WHERE
                    s.recursion = 1
            OPTION (KEEPFIXED PLAN);
           
            OPEN agent_cursor;

            FETCH NEXT FROM agent_cursor
            INTO
                @session_id,
                @job_id,
                @step_id;

            WHILE @@FETCH_STATUS = 0
            BEGIN;
                EXEC sp_executesql
                    @sql_n,
                    N''@job_id UNIQUEIDENTIFIER, @step_id INT, @session_id SMALLINT'',
                    @job_id, @step_id, @session_id

                FETCH NEXT FROM agent_cursor
                INTO
                    @session_id,
                    @job_id,
                    @step_id;
            END;

            CLOSE agent_cursor;
            DEALLOCATE agent_cursor;
        END;
       
        IF
            @delta_interval > 0
            AND @recursion <> 1
        BEGIN;
            SET @recursion = 1;

            DECLARE @delay_time CHAR(12);
            SET @delay_time = CONVERT(VARCHAR, DATEADD(second, @delta_interval, 0), 114);
            WAITFOR DELAY @delay_time;

            GOTO REDO;
        END;
    END;

    DECLARE
        @num_data_threshold MONEY,
        @num_col_fmt NVARCHAR(MAX),
        @num_delta_col_fmt NVARCHAR(MAX);

    SET @num_data_threshold = 919919919919919;
    SET @num_col_fmt =
        CASE @format_output
            WHEN 1 THEN N''
                CONVERT(VARCHAR, SPACE(MAX(LEN(CONVERT(VARCHAR, [col_name]))) OVER() - LEN(CONVERT(VARCHAR, [col_name]))) + LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN [col_name] > @num_data_threshold THEN @num_data_threshold ELSE [col_name] END), 1), 19)) AS ''
            WHEN 2 THEN N''
                CONVERT(VARCHAR, LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN [col_name] > @num_data_threshold THEN @num_data_threshold ELSE [col_name] END), 1), 19)) AS ''
            ELSE N''''
        END + N''[col_name], '';
    SET @num_delta_col_fmt =
        N''
        CASE
            WHEN
                first_request_start_time = last_request_start_time
                AND num_events = 2
                AND [col_name] >= 0
                    THEN '' +
                    CASE @format_output
                        WHEN 1 THEN N''CONVERT(VARCHAR, SPACE(MAX(LEN(CONVERT(VARCHAR, [col_name]))) OVER() - LEN(CONVERT(VARCHAR, [col_name]))) + LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN [col_name] > @num_data_threshold THEN @num_data_threshold ELSE [col_name] END), 1), 19)) ''
                        WHEN 2 THEN N''CONVERT(VARCHAR, LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN [col_name] > @num_data_threshold THEN @num_data_threshold ELSE [col_name] END), 1), 19)) ''
                        ELSE N''[col_name] ''
                    END + N''
            ELSE NULL
        END AS [col_name], '';

    SET @sql_n = CONVERT(NVARCHAR(MAX), N'''') +
        --Outer column list
        CASE
            WHEN
                @destination_table <> ''''
                AND @return_schema = 0
                    THEN N''INSERT '' + @destination_table + '' ''
            ELSE N''''
        END +
        N''SELECT '' + convert(varchar,@cpu_usage)+'' as cpu_usage,'' +
            @output_column_list + N'' '' +
        CASE @return_schema
            WHEN 1 THEN N''INTO #session_schema ''
            ELSE N''''
        END
        --End outer column list
        +
        --Inner column list
        N''
        FROM
        (
            SELECT
                session_id, '' +
                --[dd hh:mm:ss.mss]
                CASE
                    WHEN @format_output IN (1, 2) THEN
                        N''
                        CASE
                            WHEN elapsed_time < 0 THEN
                                RIGHT
                                (
                                    REPLICATE(''''0'''', max_elapsed_length) + CONVERT(VARCHAR, (-1 * elapsed_time) / 86400),
                                    max_elapsed_length
                                ) +
                                    RIGHT
                                    (
                                        CONVERT(VARCHAR, DATEADD(second, (-1 * elapsed_time), 0), 120),
                                        9
                                    ) +
                                    ''''.000''''
                            ELSE
                                RIGHT
                                (
                                    REPLICATE(''''0'''', max_elapsed_length) + CONVERT(VARCHAR, elapsed_time / 86400000),
                                    max_elapsed_length
                                ) +
                                    RIGHT
                                    (
                                        CONVERT(VARCHAR, DATEADD(second, elapsed_time / 1000, 0), 120),
                                        9
                                    ) +
                                    ''''.'''' +
                                    RIGHT(''''000'''' + CONVERT(VARCHAR, elapsed_time % 1000), 3)
                        END AS [dd hh:mm:ss.mss], ''
                    ELSE
                        N''''
                END +
                --[dd hh:mm:ss.mss (avg)] / avg_elapsed_time
                CASE
                    WHEN  @format_output IN (1, 2) THEN
                        N''
                        RIGHT
                        (
                            ''''00'''' + CONVERT(VARCHAR, avg_elapsed_time / 86400000),
                            2
                        ) +
                            RIGHT
                            (
                                CONVERT(VARCHAR, DATEADD(second, avg_elapsed_time / 1000, 0), 120),
                                9
                            ) +
                            ''''.'''' +
                            RIGHT(''''000'''' + CONVERT(VARCHAR, avg_elapsed_time % 1000), 3) AS [dd hh:mm:ss.mss (avg)], ''
                    ELSE
                        N''avg_elapsed_time, ''
                END +
                REPLACE(@num_col_fmt, N''[col_name]'', N''physical_io'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''reads'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''physical_reads'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''writes'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''tempdb_allocations'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''tempdb_current'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''CPU'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''context_switches'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''used_memory'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''max_used_memory'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''requested_memory'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''granted_memory'') +
                CASE
                    WHEN @output_column_list LIKE ''%|_delta|]%'' ESCAPE ''|'' THEN
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''physical_io_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''reads_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''physical_reads_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''writes_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''tempdb_allocations_delta'') +
                        --this is the only one that can (legitimately) go negative
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''tempdb_current_delta'') +
                        --CPU_delta
                        --leaving this one hardcoded, as there is a bit of different interaction here
                        N''
                        CASE
                            WHEN
                                first_request_start_time = last_request_start_time
                                AND num_events = 2
                                    THEN
                                        CASE
                                            WHEN
                                                thread_CPU_delta > CPU_delta
                                                AND thread_CPU_delta > 0
                                                    THEN '' +
                                                        CASE @format_output
                                                            WHEN 1 THEN N''CONVERT(VARCHAR, SPACE(MAX(LEN(CONVERT(VARCHAR, thread_CPU_delta + CPU_delta))) OVER() - LEN(CONVERT(VARCHAR, thread_CPU_delta))) + LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN thread_CPU_delta > @num_data_threshold THEN @num_data_threshold ELSE thread_CPU_delta END), 1), 19)) ''
                                                            WHEN 2 THEN N''CONVERT(VARCHAR, LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN thread_CPU_delta > @num_data_threshold THEN @num_data_threshold ELSE thread_CPU_delta END), 1), 19)) ''
                                                            ELSE N''thread_CPU_delta ''
                                                        END + N''
                                            WHEN CPU_delta >= 0 THEN '' +
                                                CASE @format_output
                                                    WHEN 1 THEN N''CONVERT(VARCHAR, SPACE(MAX(LEN(CONVERT(VARCHAR, thread_CPU_delta + CPU_delta))) OVER() - LEN(CONVERT(VARCHAR, CPU_delta))) + LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN CPU_delta > @num_data_threshold THEN @num_data_threshold ELSE CPU_delta END), 1), 19)) ''
                                                    WHEN 2 THEN N''CONVERT(VARCHAR, LEFT(CONVERT(CHAR(22), CONVERT(MONEY, CASE WHEN CPU_delta > @num_data_threshold THEN @num_data_threshold ELSE CPU_delta END), 1), 19)) ''
                                                    ELSE N''CPU_delta ''
                                                END + N''
                                            ELSE NULL
                                        END
                            ELSE
                                NULL
                        END AS CPU_delta, '' +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''context_switches_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''used_memory_delta'') +
                        REPLACE(@num_delta_col_fmt, N''[col_name]'', N''max_used_memory_delta'')
                    ELSE N''''
                END + N''
                '' +
                REPLACE(@num_col_fmt, N''[col_name]'', N''tasks'') + N''
                status,
                wait_info,
                locks,
                tran_start_time,
                LEFT(tran_log_writes, LEN(tran_log_writes) - 1) AS tran_log_writes,
                implicit_tran, '' +
                REPLACE(@num_col_fmt, ''[col_name]'', ''open_tran_count'') + N''
                '' +
                --sql_command
                CASE @format_output
                    WHEN 0 THEN N''REPLACE(REPLACE(CONVERT(NVARCHAR(MAX), sql_command), ''''<?query --''''+CHAR(13)+CHAR(10), ''''''''), CHAR(13)+CHAR(10)+''''--?>'''', '''''''') AS ''
                    ELSE N''''
                END + N''sql_command,
                '' +
                --sql_text
                CASE @format_output
                    WHEN 0 THEN N''REPLACE(REPLACE(CONVERT(NVARCHAR(MAX), sql_text), ''''<?query --''''+CHAR(13)+CHAR(10), ''''''''), CHAR(13)+CHAR(10)+''''--?>'''', '''''''') AS ''
                    ELSE N''''
                END + N''sql_text,
                query_plan,
                blocking_session_id, '' +
                REPLACE(@num_col_fmt, N''[col_name]'', N''blocked_session_count'') +
                REPLACE(@num_col_fmt, N''[col_name]'', N''percent_complete'') + N''
                host_name,
                login_name,
                database_name,
                program_name,
                additional_info,
                memory_info,
                start_time,
                login_time,
                CASE
                    WHEN status = N''''sleeping'''' THEN NULL
                    ELSE request_id
                END AS request_id,
                GETDATE() AS collection_time ''
        --End inner column list
        +
        --Derived table and INSERT specification
            N''
            FROM
            (
                SELECT TOP(2147483647)
                    *,
                    CASE
                        MAX
                        (
                            LEN
                            (
                                CONVERT
                                (
                                    VARCHAR,
                                    CASE
                                        WHEN elapsed_time < 0 THEN
                                            (-1 * elapsed_time) / 86400
                                        ELSE
                                            elapsed_time / 86400000
                                    END
                                )
                            )
                        ) OVER ()
                            WHEN 1 THEN 2
                            ELSE
                                MAX
                                (
                                    LEN
                                    (
                                        CONVERT
                                        (
                                            VARCHAR,
                                            CASE
                                                WHEN elapsed_time < 0 THEN
                                                    (-1 * elapsed_time) / 86400
                                                ELSE
                                                    elapsed_time / 86400000
                                            END
                                        )
                                    )
                                ) OVER ()
                    END AS max_elapsed_length, '' +
                    CASE
                        WHEN @output_column_list LIKE ''%|_delta|]%'' ESCAPE ''|'' THEN
                            N''
                            MAX(physical_io * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(physical_io * recursion) OVER (PARTITION BY session_id, request_id) AS physical_io_delta,
                            MAX(reads * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(reads * recursion) OVER (PARTITION BY session_id, request_id) AS reads_delta,
                            MAX(physical_reads * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(physical_reads * recursion) OVER (PARTITION BY session_id, request_id) AS physical_reads_delta,
                            MAX(writes * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(writes * recursion) OVER (PARTITION BY session_id, request_id) AS writes_delta,
                            MAX(tempdb_allocations * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(tempdb_allocations * recursion) OVER (PARTITION BY session_id, request_id) AS tempdb_allocations_delta,
                            MAX(tempdb_current * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(tempdb_current * recursion) OVER (PARTITION BY session_id, request_id) AS tempdb_current_delta,
                            MAX(CPU * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(CPU * recursion) OVER (PARTITION BY session_id, request_id) AS CPU_delta,
                            MAX(thread_CPU_snapshot * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(thread_CPU_snapshot * recursion) OVER (PARTITION BY session_id, request_id) AS thread_CPU_delta,
                            MAX(context_switches * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(context_switches * recursion) OVER (PARTITION BY session_id, request_id) AS context_switches_delta,
                            MAX(used_memory * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(used_memory * recursion) OVER (PARTITION BY session_id, request_id) AS used_memory_delta,
                            MAX(max_used_memory * recursion) OVER (PARTITION BY session_id, request_id) +
                                MIN(max_used_memory * recursion) OVER (PARTITION BY session_id, request_id) AS max_used_memory_delta,
                            MIN(last_request_start_time) OVER (PARTITION BY session_id, request_id) AS first_request_start_time, ''
                        ELSE N''''
                    END + N''
                    COUNT(*) OVER (PARTITION BY session_id, request_id) AS num_events
                FROM #sessions AS s1 '' +
                CASE
                    WHEN @sort_order = '''' THEN N''''
                    ELSE
                        N''
                        ORDER BY '' +
                            CONVERT(NVARCHAR(MAX), @sort_order)
                END +
            N''
            ) AS s
            WHERE
                s.recursion = 1
        ) x
        OPTION (KEEPFIXED PLAN);
        '' +
        CASE @return_schema
            WHEN 1 THEN
                N''
                SET @schema =
                    ''''CREATE TABLE <table_name> ( '''' +
                        STUFF
                        (
                            (
                                SELECT
                                    '''','''' +
                                    QUOTENAME(COLUMN_NAME) + '''' '''' +
                                    DATA_TYPE +
                                    CASE
                                        WHEN DATA_TYPE LIKE ''''%char'''' THEN ''''('''' + COALESCE(NULLIF(CONVERT(VARCHAR, CHARACTER_MAXIMUM_LENGTH), ''''-1''''), ''''max'''') + '''') ''''
                                        ELSE '''' ''''
                                    END +
                                    CASE IS_NULLABLE
                                        WHEN ''''NO'''' THEN ''''NOT ''''
                                        ELSE ''''''''
                                    END + ''''NULL'''' AS [text()]
                                FROM tempdb.INFORMATION_SCHEMA.COLUMNS
                                WHERE
                                    TABLE_NAME = (SELECT name FROM tempdb.sys.objects WHERE object_id = OBJECT_ID(''''tempdb..#session_schema''''))
                                    ORDER BY
                                        ORDINAL_POSITION
                                FOR XML
                                    PATH('''''''')
                            ), +
                            1,
                            1,
                            ''''''''
                        ) +
                    '''');''''; ''
            ELSE N''''
        END;
        --End derived table and INSERT specification

    EXEC sp_executesql
        @sql_n,
        N''@num_data_threshold MONEY, @schema VARCHAR(MAX) OUTPUT'',
        @num_data_threshold, @schema OUTPUT;
END;
')


SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

 CREATE OR ALTER       procedure [dbo].[up_synch_backup_history]
 @remote_servers varchar(8000)='*',@back_days tinyint=7,@keep_days int=180
as

declare @json_input nvarchar(max)='{}',@DBName nvarchar(4000)='master',
    @Error_MSG nvarchar(max), @the_sql nvarchar(max)='',@return int,@failed varchar(10)='failed',@success varchar(10)='success'

set @the_sql='select [backup_set_id],convert(varchar(30),[first_lsn]),convert(varchar(30),[last_lsn]),[backup_start_date],[backup_finish_date],[type],[compressed_backup_size],[database_name],b.server_name,m.[device_type],m.[physical_device_name],m.family_sequence_number from '
set @the_sql=@the_sql+'msdb.dbo.backupset (nolocK) b,msdb.dbo.backupmediafamily (nolocK)  m,sys.databases  (nolocK) d where d.name=b.database_name and d.state_desc=''ONLINE'' and d.recovery_model_desc<>''SIMPLE'''
set @the_sql=@the_sql+' and m.media_set_id=b.media_set_id and m.device_type not in (7) and b.server_name=@@servername and b.backup_finish_date>dateadd(d,0-'+convert(varchar,@back_days)+',getdate())'

set nocount on
if object_id('tempdb..#tmp_result') is not null
     drop table #tmp_result
create table #tmp_result (run_id uniqueidentifier)

set @json_input=JSON_MODIFY(@json_input,'$.servername_or_list',@remote_servers)
set @json_input=JSON_MODIFY(@json_input,'$.dbname_or_list','default')
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table','#tmp_result')
set @json_input=JSON_MODIFY(@json_input,'$.include_remote_info',0)
set @json_input=JSON_MODIFY(@json_input,'$.include_ag_node',1)
set @json_input=JSON_MODIFY(@json_input,'$.exclude_ag_listener',1)
set @json_input=JSON_MODIFY(@json_input,'$.db_types','MSSQL')

exec @return=[up_call_sqlfunction] @the_sql=@the_sql,@json_input=@json_input,@error_msg=@error_msg out
if @return<>0
   begin
		merge backup_history as t using (select * from #tmp_result) as s
		   on t.[server_name]=s.[server_name] and t.[last_lsn]=s.[last_lsn] and t.[database_name]=s.[database_name] and t.type=s.type and t.family_sequence_number=s.family_sequence_number
		when not matched then
		   insert ([backup_set_id],[first_lsn],[last_lsn],[backup_start_date],[backup_finish_date],[type],backup_size_kb,[database_name],[server_name],[device_type],[physical_device_name],family_sequence_number)
			   values (s.[backup_set_id],s.[first_lsn],s.[last_lsn],s.[backup_start_date],s.[backup_finish_date],s.[type],s.[backup_size]/1024,s.[database_name],s.[server_name],s.device_type,s.[physical_device_name],s.family_sequence_number); 
		if @@ROWCOUNT>0
		   delete backup_history where [backup_start_date]<getdate()-@keep_days
   end
return @return
GO
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE OR ALTER   proc [dbo].[up_WhoIsActive_alert]
@remote_servers nvarchar(4000)='*',
@recipient varchar(8000)='dba@example.com;',
@keep_days int=35,
@alert_para varchar(max)='{"alerts":[
{"name":"High_CPU","threshold":85,"counts":2},
{"name":"Active_Requests","threshold":100,"counts":3},
{"name":"Blocks_Minutes","threshold":5,"counts":1}
]}'
as
set nocount on
declare @servercount int=0,@alert_name varchar(200)='DB Perf',@task_step varchar(128),@rerport_error varchar(max)='',@threshold_desc varchar(200)
declare @body nvarchar(max)='',@errormsg nvarchar(max)='',@alert int=0,@fail_count int=0,@alert_sent int=0,@scanned_servers varchar(100)='0',@scanned_dbs varchar(20)
declare @cpu_threshold tinyint,@blocks_minutes smallint,@active_request smallint,@slow_query_minutes smallint=15
declare @return_type varchar(300)='',@remote_server varchar(4000)='{{allservers}}',@the_sql nvarchar(max),@return int,
    @json_input nvarchar(max)=N'{}',@json_sql_para varchar(max)='{}',@rpt_msg varchar(max)='',
@DBName nvarchar(4000)='master',@TimeOut int,@ExitCode smallint=0 , @error_msg nvarchar(max),@Alert_info varchar(200)='',
@cpu_counts smallint,@active_request_counts smallint,@blocks_counts smallint
declare @servername varchar(500),@Instance_CPU varchar(50),@Blocks varchar(50),@active_requests varchar(20)
declare @subject varchar(500),@alert_type varchar(30)='New Alert'
declare @alerts table (alert_name varchar(128),threshold smallint,counts smallint)
declare @current_alerts table (servername varchar(128), alert_name varchar(128),last_counts smallint, counts smallint)

if ISJSON(@alert_para)=0
   begin
       raiserror('@alert_para is not json format.',16,1)    
       return -100
   end
insert @alerts (alert_name,threshold,counts) 
    select JSON_VALUE([value],'$.name'),JSON_VALUE([value],'$.threshold'),JSON_VALUE([value],'$.counts') from openjson(@alert_para,'$.alerts')
insert @current_alerts (servername,alert_name, counts) 
    select distinct s.servername,a.alert_name,0 from serverlist s,@alerts a where s.islive=1 
update c set last_counts=a.counts from @current_alerts c, alert_state a where a.servername=c.servername and a.alert_name=c.alert_name

select @cpu_threshold=case when alert_name='High_CPU' then threshold else @cpu_threshold end,
@cpu_counts=case when alert_name='High_CPU' then counts else @cpu_counts end,
@active_request=case when alert_name='Active_Requests' then threshold else @active_request end,
@active_request_counts=case when alert_name='Active_Requests' then counts else @active_request_counts end,
@blocks_minutes=case when alert_name='Blocks_Minutes' then threshold else @blocks_minutes end,
@blocks_counts=case when alert_name='Blocks_Minutes' then counts else @blocks_counts end  from @alerts 


declare @alert_summary table ([servername] [varchar](128) NOT NULL,Instance_CPU tinyint not null, Blocks int not null, active_requests int not null,dbs int default (0))
declare @alert_list table ([servername] [varchar](128) NOT NULL,[database_name] [nvarchar](128) NULL,[cpu_usage_%] [tinyint] NOT NULL,
Duration varchar(50) not null,[session_id] [smallint] NOT NULL,[login_name] varchar(128),hostname varchar(128),appname varchar(50), [sql_text] xml NULL,[wait_info] [nvarchar](4000) NULL,
[CPU] [varchar](30) NULL,[CPU_delta] [varchar](30) NULL,[blocking_session_id] [smallint] NULL,blocked_session_count int,
[reads] [varchar](30) NULL,[writes] [varchar](30) NULL,[physical_reads] [varchar](30) NULL,[physical_reads_delta] [varchar](30) NULL,runtime_minutes int)

create table #tmp_alert (id int identity,[servername] [varchar](128) NOT NULL,[database_name] [nvarchar](128) NULL,[cpu_usage_%] [tinyint] NOT NULL,
Duration varchar(50) not null,[session_id] [smallint] NOT NULL,[login_name] varchar(128),hostname varchar(128),appname varchar(50), [sql_text] xml NULL,[wait_info] [nvarchar](4000) NULL,
[CPU] [varchar](30) NULL,[CPU_delta] [varchar](30) NULL,[blocking_session_id] [smallint] NULL,blocked_session_count int,
[reads] [varchar](30) NULL,[writes] [varchar](30) NULL,[physical_reads] [varchar](30) NULL,[physical_reads_delta] [varchar](30) NULL,runtime_minutes int,html_content varchar(max))


select @task_step='DB Performance Issues',@threshold_desc='<font color="Red">[CPU usage>'+convert(varchar,@cpu_threshold)+'%] or <font color="DarkOrange">[Active requests>'+convert(varchar,@active_request)+'] or <font color="OrangeRed">[Blocks > '+convert(varchar,@blocks_minutes)+' minutes]'

if object_id('tempdb..#tmp_whoisactive') is not null
     drop table #tmp_whoisactive
create table #tmp_whoisactive (run_id uniqueidentifier)

set @json_input=JSON_MODIFY(@json_input,'$.servername_or_list',@remote_servers)
set @json_input=JSON_MODIFY(@json_input,'$.dbname_or_list','default')
set @json_input=JSON_MODIFY(@json_input,'$.return_temp_table','#tmp_whoisactive')
set @json_input=JSON_MODIFY(@json_input,'$.include_remote_info',1)
set @json_input=JSON_MODIFY(@json_input,'$.include_ag_node',0)
set @json_input=JSON_MODIFY(@json_input,'$.exclude_ag_listener',0)
set @json_input=JSON_MODIFY(@json_input,'$.db_types','MSSQL')
--Call sp_WhoIsActive from https://github.com/amachanic/sp_whoisactive/blob/master/LICENSE
IF EXISTS(SELECT 1 FROM sql_functions WHERE FN_NAME='sp_WhoIsActive' AND db_provider='MSSQL')
   SET @the_sql='sp_WhoIsActive' -- not good for performance, it's better to create this proc on remote server and call it as below
ELSE
	set @the_sql='exec [dbo].[sp_WhoIsActive] @find_block_leaders = 1,@delta_interval = 15'
exec @return=[up_call_sqlfunction] @the_sql=@the_sql,@json_input=@json_input,@error_msg=@error_msg out
if @return<>0
   begin
       	raiserror('Returned Error: %s',16,1, @Error_MSG)
		return @return
   end
IF NOT EXISTS (SELECT 1 FROM tempdb.sys.columns WHERE object_id = OBJECT_ID('tempdb..#tmp_whoisactive') AND name = 'servername')
   BEGIN
		ALTER TABLE #tmp_whoisactive ADD servername VARCHAR(128)
		UPDATE #tmp_whoisactive SET servername=[Server Name]
   END
insert @alert_list ([servername],[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],runtime_minutes)
select [servername],[database_name],[cpu_usage_%],[dd hh:mm:ss.mss],[session_id],login_name,[host_name],left([program_name],50), [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],
datediff(mi,start_time,collection_time) 
    from #tmp_whoisactive where servername not in (@@SERVERNAME) 
	and (
	 [cpu_usage_%]>=@cpu_threshold or
	(blocking_session_id>0 and datediff(ss,[start_time],[collection_time])>=@blocks_minutes*60) or 
	[servername] in (select servername from #tmp_whoisactive group by servername having count(*)>=@active_request)
	) 
if @@ROWCOUNT=0
   begin
       set @body=''
	   update s set counts=0 from alert_state s,@alerts a where a.alert_name=s.alert_name
	   set @servername=''
	   select @servername=@servername+c.servername+':' from @current_alerts c, @alerts a where c.alert_name=a.alert_name and c.last_counts>=a.counts
	   if @@ROWCOUNT>0
	      begin
		     set @alert_type='Reset Alert for '+left(@servername,len(@servername)-1)
			 set @subject='Prod '+@alert_name+'-{Alert_type}-'+format(getdate() AT TIME ZONE 'UTC' at time zone 'US Eastern Standard Time','MM-dd HH:mm EST') 
			 set @subject=replace(@subject,'{Alert_type}',@alert_type)
			 set @body=@body+'<TABLE border="2" frame="hsides" rules="groups" style="font-size: 10pt;width:80pc;" ><CAPTION><FONT style="font-size: 12pt;COLOR:#0000FF">'+@task_step+'--Scanned on '+@scanned_servers+' servers, triggered by ('+@threshold_desc+')</FONT></CAPTION>
						<TH >Server Name</TH>
						<TH >Instance CPU%</TH>
						<TH >Total Blocks</TH>
						<TH>Total Active Requests</TH>'
			 select	@body=@body+'<TR><TD>All Instances</TD><TD style="color:green">No alert is good alert!</TD></TR></TABLE>'		
			 
			 exec msdb..sp_send_dbmail @recipients =@recipient,
						@body_format='html',
						@subject =@subject, 
						@body=@body                
		  end
         return 0
   end
-- process current alert

insert [WhoIsActive] ([servername],[collection_time],[cpu_usage_%],[dd hh:mm:ss.mss],[session_id],[sql_text],[login_name],[wait_info],[CPU],[CPU_delta],[tempdb_allocations],[tempdb_current],[tempdb_allocations_delta],[tempdb_current_delta],[blocking_session_id],blocked_session_count,[reads],[reads_delta],
    [writes],[writes_delta],[physical_reads],[physical_reads_delta],[used_memory],[used_memory_delta]
	,[status],[open_tran_count],[percent_complete],[host_name],[database_name],[program_name],[start_time],[login_time],[request_id])
SELECT [servername],[collection_time],[cpu_usage_%],[dd hh:mm:ss.mss],[session_id],[sql_text],[login_name],[wait_info],[CPU],[CPU_delta],[tempdb_allocations],[tempdb_current],[tempdb_allocations_delta],[tempdb_current_delta],[blocking_session_id],blocked_session_count,[reads],[reads_delta],
    [writes],[writes_delta],[physical_reads],[physical_reads_delta],[used_memory],[used_memory_delta]
	,[status],[open_tran_count],[percent_complete],[host_name],[database_name],[program_name],[start_time],[login_time],[request_id]  
		from #tmp_whoisactive where servername not in (@@SERVERNAME)

delete a from @alert_list a where convert(varchar(max),sql_text) like '%sp_server_diagnostics%'

insert @alert_summary (servername,Instance_CPU,Blocks,active_requests)
		select servername,max([cpu_usage_%]),count(distinct blocking_session_id),count(*) from @alert_list group by servername
        
update a set counts=case when alert_name='High_CPU' and Instance_CPU>@cpu_threshold then 1 
					when alert_name='Blocks_Minutes' and Blocks>0 then 1 
					when alert_name='Active_Requests' and active_requests>@active_request then 1 
					else counts end from @current_alerts a, @alert_summary s where a.servername=s.servername

merge into alert_state as t using (select * from @current_alerts) as s
		on (t.servername=s.servername and t.alert_name=s.alert_name)
	when matched then update set counts=t.counts+case when s.counts=0 then 0-t.counts else 1 end
	when not matched then insert (servername,alert_name,counts) values(s.servername,s.alert_name,isnull(s.counts,0));

select top 1 @servername=servername,@Instance_CPU=Instance_CPU,@Blocks=Blocks,@active_requests=active_requests from @alert_summary
while @@ROWCOUNT=1
  begin
				truncate table #tmp_alert
				set @body=''
				set @Alert_info='-'
				if not exists(select 1 from @current_alerts c, @alerts a where c.alert_name=a.alert_name and c.last_counts>=a.counts and c.servername=@servername)
					and exists(select 1 from alert_state c, @alerts a where c.alert_name=a.alert_name and c.counts>=a.counts and c.servername=@servername)
					set @alert_type='New Alert'
				if exists(select 1 from @current_alerts c, @alerts a where c.alert_name=a.alert_name and c.last_counts>=a.counts and c.servername=@servername)
					and not exists(select 1 from alert_state c, @alerts a where c.alert_name=a.alert_name and c.counts>=a.counts and c.servername=@servername)
					set @alert_type='Reset Alert'
				if exists(select 1 from @current_alerts c, @alerts a where c.alert_name=a.alert_name and c.last_counts>=a.counts and c.servername=@servername)
					and exists(select 1 from alert_state c, @alerts a where c.alert_name=a.alert_name and c.counts>=a.counts and c.servername=@servername)
					set @alert_type='Continuing Alert'
				set @subject='Prod '+@alert_name+'-'+@servername+'-'+@alert_type+'({Alert_info})-'+format(getdate() AT TIME ZONE 'UTC' at time zone 'US Eastern Standard Time','MM-dd HH:mm EST') 
				if @alert_type ='Reset Alert'
					begin
						--send reset email alert
						set @subject=replace(@subject,'{Alert_info}','')
						update s set counts=0 from alert_state s,@alerts a where a.alert_name=s.alert_name and s.servername=@servername
						set @body=@body+'<TABLE border="2" frame="hsides" rules="groups" style="font-size: 10pt;width:80pc;" ><CAPTION><FONT style="font-size: 12pt;COLOR:#0000FF">'+@task_step+'--Scanned on '+@scanned_servers+' servers, triggered by ('+@threshold_desc+')</FONT></CAPTION>
										<TH >Server Name</TH>
										<TH >Instance CPU%</TH>
										<TH >Total Blocks</TH>
										<TH>Total Active Requests</TH>'
						select	@body=@body+'<TR><TD>'+@servername+'</TD><TD style="color:green">All alerts are gone!</TD></TR></TABLE>'		
						exec msdb..sp_send_dbmail @recipients =@recipient,
										@body_format='html',
										@subject =@subject, 
										@body=@body                
						
					end
                 else
				    begin
						insert alert_hist (servername,alert_name,threshold,threshold_counts,actual_counts,inserted_date)
							   select distinct c.servername,c.alert_name,a.threshold,a.counts, c.counts,getdate() 
									from alert_state c, @alerts a where c.alert_name=a.alert_name and c.counts>=a.counts and c.servername=@servername
                        select @Alert_info='CPU:'+@Instance_CPU+'-Blocks:'+@Blocks+'-Requests:'+@active_requests
						set @subject=replace(@subject,'{Alert_info}',@Alert_info)
						update s set dbs=(select count(*) from dblist d where d.servername=@servername and (dbname like '%_prod' or dbname like '%_demo' or dbname like '%_test') and isnull(last_login,getdate()-300)>getdate()-30) from @alert_summary s where s.servername=@servername
						set @body=@body+'<TABLE border="2" frame="hsides" rules="groups" style="font-size: 10pt;width:80pc;" ><CAPTION><FONT style="font-size: 12pt;COLOR:#0000FF">'+@task_step+'--Scanned on '+@scanned_servers+' servers, triggered by ('+@threshold_desc+')</FONT></CAPTION>
								<TH >Server Name</TH>
								<TH >Instance CPU%</TH>
								<TH >Total Blocks</TH>
								<TH>Total Active Requests</TH>'
						select @body=@body+ '<TR><TD>'+a.servername+'<br>(CPU cores='+convert(varchar,isnull(json_value(s.os_property,'$.cpu_count'),0)) +',active dbs='+convert(varchar,a.dbs)+')</TD><TD '+case when Instance_CPU>=@cpu_threshold then ' style="color:red"' else '' end +'>'+convert(varchar,Instance_CPU)+'%' +'</TD><TD '+case when Blocks>=@blocks_minutes then '  style="color:OrangeRed"' else '' end +'>'+convert(varchar,Blocks) +'</TD><TD '+case when active_requests>=@active_request then '  style="color:DarkOrange"' else '' end +'>'+ isnull(CONVERT(varchar,active_requests),'') 
								from @alert_summary a join  serverlist s on s.servername=a.servername where a.servername=@servername
						if exists(select 1 from @alert_summary where Blocks>0 and servername=@servername)
						   begin
						      insert #tmp_alert (servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],runtime_minutes)
						   		select servername,[database_name],[cpu_usage_%],[dd hh:mm:ss.mss],[session_id],login_name,[host_name],left([program_name],50), [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],
									datediff(mi,start_time,collection_time) 
									   from #tmp_whoisactive w where w.servername not in (@@SERVERNAME) and servername=@servername
										and w.session_id in (select a.blocking_session_id from @alert_list a where a.servername=w.servername) order by blocked_session_count desc,[dd hh:mm:ss.mss] desc
								insert #tmp_alert (servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],runtime_minutes)                                
									select servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],
										runtime_minutes from @alert_list where servername=@servername order by case when blocking_session_id>0 then 0 else 1 end, Duration desc,convert(bigint,replace([cpu_usage_%],',','')) desc    
                           end
						else
						   if exists(select 1 from @alert_summary where Instance_CPU>@cpu_threshold and servername=@servername)
						    	insert #tmp_alert (servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],runtime_minutes)                                
									select servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],
														runtime_minutes from @alert_list where servername=@servername order by convert(bigint,replace([cpu_usage_%],',','')) desc, Duration desc    
                           else
						    	insert #tmp_alert (servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],runtime_minutes)                                
									select servername,[database_name],[cpu_usage_%],duration,[session_id],login_name,hostname,appname, [sql_text],[wait_info],[CPU],[CPU_delta],[blocking_session_id],blocked_session_count,[reads],[writes],[physical_reads],[physical_reads_delta],
										runtime_minutes from @alert_list where servername=@servername order by Duration desc    
                        
						select 	@body=@body+'</TABLE>'		 
						set @body=@body+'<TABLE border="2" frame="hsides" rules="groups" style="font-size: 10pt;width:80pc;" ><CAPTION><FONT style="font-size: 12pt;COLOR:#0000FF">Detail Alert Triggered by above Colored Data</FONT></CAPTION>
								<TH >DBName</TH>
								<TH >hh:mm:ss</TH>
								<TH >SPID</TH>
								<TH >Login Name</TH>
								<TH >Blocking SPID</TH>
								<TH >Query CPU</TH>
								<TH >CPU Delta</TH>
								<TH >Wait Info</TH>
								<TH >Reads</TH>
								<TH >Writes</TH>
								<TH>Physical Reads</TH>	
								<TH>Physical Reads Delta</TH>	
								<TH>Host Name</TH>	
								<TH>App Name</TH>	
								<TH>SQL Text</TH>'
						update a set html_content='<TR><TD>'+isnull([database_name],'N/A')+'</TD><TD '+case when runtime_minutes>=@slow_query_minutes then '  style="color:Purple"' else '' end +'>'+substring(Duration,charindex(' ',Duration)+1,8) +'</TD><TD>'+isnull(CONVERT(varchar,session_id),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,login_name),'N/A') +'</TD><TD '+case when isnull(blocking_session_id,0)>0 and runtime_minutes>=@blocks_minutes then '  style="color:OrangeRed"' else '' end +'>'+ isnull(CONVERT(varchar,[blocking_session_id]),'') 
							+'</TD><TD>'+isnull(CONVERT(varchar,[CPU]),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,CPU_delta),'N/A') +'</TD><TD>'+isnull(wait_info,'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,[reads]),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,[writes]),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,[physical_reads]),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,physical_reads_delta),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,hostname),'N/A') +'</TD><TD>'+isnull(CONVERT(varchar,appname),'N/A') +'</TD><TD>'+replace(replace(isnull(left(convert(nvarchar(max),[sql_text]),1000),'N/A'),'<?query --',''),'--?>','') +'</TD></TR>'
								from #tmp_alert a left join dblist d on a.servername=d.servername and isnull(a.database_name,'')=d.dbname 
				                           
                        select @body=@body+html_content from #tmp_alert order by id
						select 	@body=@body+'</TABLE>'		
						exec msdb..sp_send_dbmail @recipients =@recipient,
									@body_format='html',
									@subject =@subject, 
									@body=@body                
                    end
				delete @alert_summary where servername=@servername
				select top 1 @servername=servername,@Instance_CPU=Instance_CPU,@Blocks=Blocks,@active_requests=active_requests from @alert_summary
   end              
 delete [WhoIsActive] where [collection_time]<getdate()-@keep_days


GO
		
update serverlist set ip_or_dns='198.58.248.16' where ip_or_dns='192.168.68.103'
